/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var e={};t.r(e),t.d(e,{YF:()=>$s});var i=Object.freeze({});function n(t){return null==t}function r(t){return null!=t}function s(t){return!0===t}function o(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function a(t){return null!==t&&"object"==typeof t}var c=Object.prototype.toString;function h(t){return"[object Object]"===c.call(t)}function l(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function d(t){return r(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function u(t){return null==t?"":Array.isArray(t)||h(t)&&t.toString===c?JSON.stringify(t,null,2):String(t)}function f(t){var e=parseFloat(t);return isNaN(e)?t:e}function g(t,e){for(var i=Object.create(null),n=t.split(","),r=0;r<n.length;r++)i[n[r]]=!0;return e?function(t){return i[t.toLowerCase()]}:function(t){return i[t]}}g("slot,component",!0);var p=g("key,ref,slot,slot-scope,is");function _(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}var v=Object.prototype.hasOwnProperty;function m(t,e){return v.call(t,e)}function b(t){var e=Object.create(null);return function(i){return e[i]||(e[i]=t(i))}}var y=/-(\w)/g,w=b((function(t){return t.replace(y,(function(t,e){return e?e.toUpperCase():""}))})),x=b((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),C=/\B([A-Z])/g,k=b((function(t){return t.replace(C,"-$1").toLowerCase()})),S=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function i(i){var n=arguments.length;return n?n>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return i._length=t.length,i};function E(t,e){e=e||0;for(var i=t.length-e,n=new Array(i);i--;)n[i]=t[i+e];return n}function B(t,e){for(var i in e)t[i]=e[i];return t}function T(t){for(var e={},i=0;i<t.length;i++)t[i]&&B(e,t[i]);return e}function O(t,e,i){}var M=function(t,e,i){return!1},P=function(t){return t};function L(t,e){if(t===e)return!0;var i=a(t),n=a(e);if(!i||!n)return!i&&!n&&String(t)===String(e);try{var r=Array.isArray(t),s=Array.isArray(e);if(r&&s)return t.length===e.length&&t.every((function(t,i){return L(t,e[i])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(r||s)return!1;var o=Object.keys(t),c=Object.keys(e);return o.length===c.length&&o.every((function(i){return L(t[i],e[i])}))}catch(t){return!1}}function A(t,e){for(var i=0;i<t.length;i++)if(L(t[i],e))return i;return-1}function R(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var I="data-server-rendered",j=["component","directive","filter"],$=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],D={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:M,isReservedAttr:M,isUnknownElement:M,getTagNamespace:O,parsePlatformTagName:P,mustUseProp:M,async:!0,_lifecycleHooks:$};function N(t,e,i,n){Object.defineProperty(t,e,{value:i,enumerable:!!n,writable:!0,configurable:!0})}var V,W=new RegExp("[^"+/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/.source+".$_\\d]"),H="__proto__"in{},F="undefined"!=typeof window,X="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,Y=X&&WXEnvironment.platform.toLowerCase(),q=F&&window.navigator.userAgent.toLowerCase(),z=q&&/msie|trident/.test(q),U=q&&q.indexOf("msie 9.0")>0,G=q&&q.indexOf("edge/")>0,Z=(q&&q.indexOf("android"),q&&/iphone|ipad|ipod|ios/.test(q)||"ios"===Y),J=(q&&/chrome\/\d+/.test(q),q&&/phantomjs/.test(q),q&&q.match(/firefox\/(\d+)/)),K={}.watch,Q=!1;if(F)try{var tt={};Object.defineProperty(tt,"passive",{get:function(){Q=!0}}),window.addEventListener("test-passive",null,tt)}catch(t){}var et=function(){return void 0===V&&(V=!F&&!X&&void 0!==t.g&&t.g.process&&"server"===t.g.process.env.VUE_ENV),V},it=F&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function nt(t){return"function"==typeof t&&/native code/.test(t.toString())}var rt,st="undefined"!=typeof Symbol&&nt(Symbol)&&"undefined"!=typeof Reflect&&nt(Reflect.ownKeys);rt="undefined"!=typeof Set&&nt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var ot=O,at=0,ct=function(){this.id=at++,this.subs=[]};ct.prototype.addSub=function(t){this.subs.push(t)},ct.prototype.removeSub=function(t){_(this.subs,t)},ct.prototype.depend=function(){ct.target&&ct.target.addDep(this)},ct.prototype.notify=function(){for(var t=this.subs.slice(),e=0,i=t.length;e<i;e++)t[e].update()},ct.target=null;var ht=[];function lt(t){ht.push(t),ct.target=t}function dt(){ht.pop(),ct.target=ht[ht.length-1]}var ut=function(t,e,i,n,r,s,o,a){this.tag=t,this.data=e,this.children=i,this.text=n,this.elm=r,this.ns=void 0,this.context=s,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},ft={child:{configurable:!0}};ft.child.get=function(){return this.componentInstance},Object.defineProperties(ut.prototype,ft);var gt=function(t){void 0===t&&(t="");var e=new ut;return e.text=t,e.isComment=!0,e};function pt(t){return new ut(void 0,void 0,void 0,String(t))}function _t(t){var e=new ut(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var vt=Array.prototype,mt=Object.create(vt);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var e=vt[t];N(mt,t,(function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];var r,s=e.apply(this,i),o=this.__ob__;switch(t){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2)}return r&&o.observeArray(r),o.dep.notify(),s}))}));var bt=Object.getOwnPropertyNames(mt),yt=!0;function wt(t){yt=t}var xt=function(t){this.value=t,this.dep=new ct,this.vmCount=0,N(t,"__ob__",this),Array.isArray(t)?(H?function(t,e){t.__proto__=e}(t,mt):function(t,e,i){for(var n=0,r=i.length;n<r;n++){var s=i[n];N(t,s,e[s])}}(t,mt,bt),this.observeArray(t)):this.walk(t)};function Ct(t,e){var i;if(a(t)&&!(t instanceof ut))return m(t,"__ob__")&&t.__ob__ instanceof xt?i=t.__ob__:yt&&!et()&&(Array.isArray(t)||h(t))&&Object.isExtensible(t)&&!t._isVue&&(i=new xt(t)),e&&i&&i.vmCount++,i}function kt(t,e,i,n,r){var s=new ct,o=Object.getOwnPropertyDescriptor(t,e);if(!o||!1!==o.configurable){var a=o&&o.get,c=o&&o.set;a&&!c||2!==arguments.length||(i=t[e]);var h=!r&&Ct(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):i;return ct.target&&(s.depend(),h&&(h.dep.depend(),Array.isArray(e)&&Bt(e))),e},set:function(e){var n=a?a.call(t):i;e===n||e!=e&&n!=n||a&&!c||(c?c.call(t,e):i=e,h=!r&&Ct(e),s.notify())}})}}function St(t,e,i){if(Array.isArray(t)&&l(e))return t.length=Math.max(t.length,e),t.splice(e,1,i),i;if(e in t&&!(e in Object.prototype))return t[e]=i,i;var n=t.__ob__;return t._isVue||n&&n.vmCount?i:n?(kt(n.value,e,i),n.dep.notify(),i):(t[e]=i,i)}function Et(t,e){if(Array.isArray(t)&&l(e))t.splice(e,1);else{var i=t.__ob__;t._isVue||i&&i.vmCount||m(t,e)&&(delete t[e],i&&i.dep.notify())}}function Bt(t){for(var e=void 0,i=0,n=t.length;i<n;i++)(e=t[i])&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Bt(e)}xt.prototype.walk=function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)kt(t,e[i])},xt.prototype.observeArray=function(t){for(var e=0,i=t.length;e<i;e++)Ct(t[e])};var Tt=D.optionMergeStrategies;function Ot(t,e){if(!e)return t;for(var i,n,r,s=st?Reflect.ownKeys(e):Object.keys(e),o=0;o<s.length;o++)"__ob__"!==(i=s[o])&&(n=t[i],r=e[i],m(t,i)?n!==r&&h(n)&&h(r)&&Ot(n,r):St(t,i,r));return t}function Mt(t,e,i){return i?function(){var n="function"==typeof e?e.call(i,i):e,r="function"==typeof t?t.call(i,i):t;return n?Ot(n,r):r}:e?t?function(){return Ot("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function Pt(t,e){var i=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return i?function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}(i):i}function Lt(t,e,i,n){var r=Object.create(t||null);return e?B(r,e):r}Tt.data=function(t,e,i){return i?Mt(t,e,i):e&&"function"!=typeof e?t:Mt(t,e)},$.forEach((function(t){Tt[t]=Pt})),j.forEach((function(t){Tt[t+"s"]=Lt})),Tt.watch=function(t,e,i,n){if(t===K&&(t=void 0),e===K&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var r={};for(var s in B(r,t),e){var o=r[s],a=e[s];o&&!Array.isArray(o)&&(o=[o]),r[s]=o?o.concat(a):Array.isArray(a)?a:[a]}return r},Tt.props=Tt.methods=Tt.inject=Tt.computed=function(t,e,i,n){if(!t)return e;var r=Object.create(null);return B(r,t),e&&B(r,e),r},Tt.provide=Mt;var At=function(t,e){return void 0===e?t:e};function Rt(t,e,i){if("function"==typeof e&&(e=e.options),function(t,e){var i=t.props;if(i){var n,r,s={};if(Array.isArray(i))for(n=i.length;n--;)"string"==typeof(r=i[n])&&(s[w(r)]={type:null});else if(h(i))for(var o in i)r=i[o],s[w(o)]=h(r)?r:{type:r};t.props=s}}(e),function(t,e){var i=t.inject;if(i){var n=t.inject={};if(Array.isArray(i))for(var r=0;r<i.length;r++)n[i[r]]={from:i[r]};else if(h(i))for(var s in i){var o=i[s];n[s]=h(o)?B({from:s},o):{from:o}}}}(e),function(t){var e=t.directives;if(e)for(var i in e){var n=e[i];"function"==typeof n&&(e[i]={bind:n,update:n})}}(e),!e._base&&(e.extends&&(t=Rt(t,e.extends,i)),e.mixins))for(var n=0,r=e.mixins.length;n<r;n++)t=Rt(t,e.mixins[n],i);var s,o={};for(s in t)a(s);for(s in e)m(t,s)||a(s);function a(n){var r=Tt[n]||At;o[n]=r(t[n],e[n],i,n)}return o}function It(t,e,i,n){if("string"==typeof i){var r=t[e];if(m(r,i))return r[i];var s=w(i);if(m(r,s))return r[s];var o=x(s);return m(r,o)?r[o]:r[i]||r[s]||r[o]}}function jt(t,e,i,n){var r=e[t],s=!m(i,t),o=i[t],a=Vt(Boolean,r.type);if(a>-1)if(s&&!m(r,"default"))o=!1;else if(""===o||o===k(t)){var c=Vt(String,r.type);(c<0||a<c)&&(o=!0)}if(void 0===o){o=function(t,e,i){if(m(e,"default")){var n=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[i]&&void 0!==t._props[i]?t._props[i]:"function"==typeof n&&"Function"!==Dt(e.type)?n.call(t):n}}(n,r,t);var h=yt;wt(!0),Ct(o),wt(h)}return o}var $t=/^\s*function (\w+)/;function Dt(t){var e=t&&t.toString().match($t);return e?e[1]:""}function Nt(t,e){return Dt(t)===Dt(e)}function Vt(t,e){if(!Array.isArray(e))return Nt(e,t)?0:-1;for(var i=0,n=e.length;i<n;i++)if(Nt(e[i],t))return i;return-1}function Wt(t,e,i){lt();try{if(e)for(var n=e;n=n.$parent;){var r=n.$options.errorCaptured;if(r)for(var s=0;s<r.length;s++)try{if(!1===r[s].call(n,t,e,i))return}catch(t){Ft(t,n,"errorCaptured hook")}}Ft(t,e,i)}finally{dt()}}function Ht(t,e,i,n,r){var s;try{(s=i?t.apply(e,i):t.call(e))&&!s._isVue&&d(s)&&!s._handled&&(s.catch((function(t){return Wt(t,n,r+" (Promise/async)")})),s._handled=!0)}catch(t){Wt(t,n,r)}return s}function Ft(t,e,i){if(D.errorHandler)try{return D.errorHandler.call(null,t,e,i)}catch(e){e!==t&&Xt(e)}Xt(t)}function Xt(t,e,i){if(!F&&!X||"undefined"==typeof console)throw t;console.error(t)}var Yt,qt=!1,zt=[],Ut=!1;function Gt(){Ut=!1;var t=zt.slice(0);zt.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&nt(Promise)){var Zt=Promise.resolve();Yt=function(){Zt.then(Gt),Z&&setTimeout(O)},qt=!0}else if(z||"undefined"==typeof MutationObserver||!nt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Yt="undefined"!=typeof setImmediate&&nt(setImmediate)?function(){setImmediate(Gt)}:function(){setTimeout(Gt,0)};else{var Jt=1,Kt=new MutationObserver(Gt),Qt=document.createTextNode(String(Jt));Kt.observe(Qt,{characterData:!0}),Yt=function(){Jt=(Jt+1)%2,Qt.data=String(Jt)},qt=!0}function te(t,e){var i;if(zt.push((function(){if(t)try{t.call(e)}catch(t){Wt(t,e,"nextTick")}else i&&i(e)})),Ut||(Ut=!0,Yt()),!t&&"undefined"!=typeof Promise)return new Promise((function(t){i=t}))}var ee=new rt;function ie(t){ne(t,ee),ee.clear()}function ne(t,e){var i,n,r=Array.isArray(t);if(!(!r&&!a(t)||Object.isFrozen(t)||t instanceof ut)){if(t.__ob__){var s=t.__ob__.dep.id;if(e.has(s))return;e.add(s)}if(r)for(i=t.length;i--;)ne(t[i],e);else for(i=(n=Object.keys(t)).length;i--;)ne(t[n[i]],e)}}var re=b((function(t){var e="&"===t.charAt(0),i="~"===(t=e?t.slice(1):t).charAt(0),n="!"===(t=i?t.slice(1):t).charAt(0);return{name:t=n?t.slice(1):t,once:i,capture:n,passive:e}}));function se(t,e){function i(){var t=arguments,n=i.fns;if(!Array.isArray(n))return Ht(n,null,arguments,e,"v-on handler");for(var r=n.slice(),s=0;s<r.length;s++)Ht(r[s],null,t,e,"v-on handler")}return i.fns=t,i}function oe(t,e,i,r,o,a){var c,h,l,d;for(c in t)h=t[c],l=e[c],d=re(c),n(h)||(n(l)?(n(h.fns)&&(h=t[c]=se(h,a)),s(d.once)&&(h=t[c]=o(d.name,h,d.capture)),i(d.name,h,d.capture,d.passive,d.params)):h!==l&&(l.fns=h,t[c]=l));for(c in e)n(t[c])&&r((d=re(c)).name,e[c],d.capture)}function ae(t,e,i){var o;t instanceof ut&&(t=t.data.hook||(t.data.hook={}));var a=t[e];function c(){i.apply(this,arguments),_(o.fns,c)}n(a)?o=se([c]):r(a.fns)&&s(a.merged)?(o=a).fns.push(c):o=se([a,c]),o.merged=!0,t[e]=o}function ce(t,e,i,n,s){if(r(e)){if(m(e,i))return t[i]=e[i],s||delete e[i],!0;if(m(e,n))return t[i]=e[n],s||delete e[n],!0}return!1}function he(t){return o(t)?[pt(t)]:Array.isArray(t)?de(t):void 0}function le(t){return r(t)&&r(t.text)&&!1===t.isComment}function de(t,e){var i,a,c,h,l=[];for(i=0;i<t.length;i++)n(a=t[i])||"boolean"==typeof a||(h=l[c=l.length-1],Array.isArray(a)?a.length>0&&(le((a=de(a,(e||"")+"_"+i))[0])&&le(h)&&(l[c]=pt(h.text+a[0].text),a.shift()),l.push.apply(l,a)):o(a)?le(h)?l[c]=pt(h.text+a):""!==a&&l.push(pt(a)):le(a)&&le(h)?l[c]=pt(h.text+a.text):(s(t._isVList)&&r(a.tag)&&n(a.key)&&r(e)&&(a.key="__vlist"+e+"_"+i+"__"),l.push(a)));return l}function ue(t,e){if(t){for(var i=Object.create(null),n=st?Reflect.ownKeys(t):Object.keys(t),r=0;r<n.length;r++){var s=n[r];if("__ob__"!==s){for(var o=t[s].from,a=e;a;){if(a._provided&&m(a._provided,o)){i[s]=a._provided[o];break}a=a.$parent}if(!a&&"default"in t[s]){var c=t[s].default;i[s]="function"==typeof c?c.call(e):c}}}return i}}function fe(t,e){if(!t||!t.length)return{};for(var i={},n=0,r=t.length;n<r;n++){var s=t[n],o=s.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,s.context!==e&&s.fnContext!==e||!o||null==o.slot)(i.default||(i.default=[])).push(s);else{var a=o.slot,c=i[a]||(i[a]=[]);"template"===s.tag?c.push.apply(c,s.children||[]):c.push(s)}}for(var h in i)i[h].every(ge)&&delete i[h];return i}function ge(t){return t.isComment&&!t.asyncFactory||" "===t.text}function pe(t){return t.isComment&&t.asyncFactory}function _e(t,e,n){var r,s=Object.keys(e).length>0,o=t?!!t.$stable:!s,a=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(o&&n&&n!==i&&a===n.$key&&!s&&!n.$hasNormal)return n;for(var c in r={},t)t[c]&&"$"!==c[0]&&(r[c]=ve(e,c,t[c]))}else r={};for(var h in e)h in r||(r[h]=me(e,h));return t&&Object.isExtensible(t)&&(t._normalized=r),N(r,"$stable",o),N(r,"$key",a),N(r,"$hasNormal",s),r}function ve(t,e,i){var n=function(){var t=arguments.length?i.apply(null,arguments):i({}),e=(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:he(t))&&t[0];return t&&(!e||1===t.length&&e.isComment&&!pe(e))?void 0:t};return i.proxy&&Object.defineProperty(t,e,{get:n,enumerable:!0,configurable:!0}),n}function me(t,e){return function(){return t[e]}}function be(t,e){var i,n,s,o,c;if(Array.isArray(t)||"string"==typeof t)for(i=new Array(t.length),n=0,s=t.length;n<s;n++)i[n]=e(t[n],n);else if("number"==typeof t)for(i=new Array(t),n=0;n<t;n++)i[n]=e(n+1,n);else if(a(t))if(st&&t[Symbol.iterator]){i=[];for(var h=t[Symbol.iterator](),l=h.next();!l.done;)i.push(e(l.value,i.length)),l=h.next()}else for(o=Object.keys(t),i=new Array(o.length),n=0,s=o.length;n<s;n++)c=o[n],i[n]=e(t[c],c,n);return r(i)||(i=[]),i._isVList=!0,i}function ye(t,e,i,n){var r,s=this.$scopedSlots[t];s?(i=i||{},n&&(i=B(B({},n),i)),r=s(i)||("function"==typeof e?e():e)):r=this.$slots[t]||("function"==typeof e?e():e);var o=i&&i.slot;return o?this.$createElement("template",{slot:o},r):r}function we(t){return It(this.$options,"filters",t)||P}function xe(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function Ce(t,e,i,n,r){var s=D.keyCodes[e]||i;return r&&n&&!D.keyCodes[e]?xe(r,n):s?xe(s,t):n?k(n)!==e:void 0===t}function ke(t,e,i,n,r){if(i&&a(i)){var s;Array.isArray(i)&&(i=T(i));var o=function(o){if("class"===o||"style"===o||p(o))s=t;else{var a=t.attrs&&t.attrs.type;s=n||D.mustUseProp(e,a,o)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var c=w(o),h=k(o);c in s||h in s||(s[o]=i[o],r&&((t.on||(t.on={}))["update:"+o]=function(t){i[o]=t}))};for(var c in i)o(c)}return t}function Se(t,e){var i=this._staticTrees||(this._staticTrees=[]),n=i[t];return n&&!e||Be(n=i[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),n}function Ee(t,e,i){return Be(t,"__once__"+e+(i?"_"+i:""),!0),t}function Be(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&"string"!=typeof t[n]&&Te(t[n],e+"_"+n,i);else Te(t,e,i)}function Te(t,e,i){t.isStatic=!0,t.key=e,t.isOnce=i}function Oe(t,e){if(e&&h(e)){var i=t.on=t.on?B({},t.on):{};for(var n in e){var r=i[n],s=e[n];i[n]=r?[].concat(r,s):s}}return t}function Me(t,e,i,n){e=e||{$stable:!i};for(var r=0;r<t.length;r++){var s=t[r];Array.isArray(s)?Me(s,e,i):s&&(s.proxy&&(s.fn.proxy=!0),e[s.key]=s.fn)}return n&&(e.$key=n),e}function Pe(t,e){for(var i=0;i<e.length;i+=2){var n=e[i];"string"==typeof n&&n&&(t[e[i]]=e[i+1])}return t}function Le(t,e){return"string"==typeof t?e+t:t}function Ae(t){t._o=Ee,t._n=f,t._s=u,t._l=be,t._t=ye,t._q=L,t._i=A,t._m=Se,t._f=we,t._k=Ce,t._b=ke,t._v=pt,t._e=gt,t._u=Me,t._g=Oe,t._d=Pe,t._p=Le}function Re(t,e,n,r,o){var a,c=this,h=o.options;m(r,"_uid")?(a=Object.create(r))._original=r:(a=r,r=r._original);var l=s(h._compiled),d=!l;this.data=t,this.props=e,this.children=n,this.parent=r,this.listeners=t.on||i,this.injections=ue(h.inject,r),this.slots=function(){return c.$slots||_e(t.scopedSlots,c.$slots=fe(n,r)),c.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return _e(t.scopedSlots,this.slots())}}),l&&(this.$options=h,this.$slots=this.slots(),this.$scopedSlots=_e(t.scopedSlots,this.$slots)),h._scopeId?this._c=function(t,e,i,n){var s=We(a,t,e,i,n,d);return s&&!Array.isArray(s)&&(s.fnScopeId=h._scopeId,s.fnContext=r),s}:this._c=function(t,e,i,n){return We(a,t,e,i,n,d)}}function Ie(t,e,i,n,r){var s=_t(t);return s.fnContext=i,s.fnOptions=n,e.slot&&((s.data||(s.data={})).slot=e.slot),s}function je(t,e){for(var i in e)t[w(i)]=e[i]}Ae(Re.prototype);var $e={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var i=t;$e.prepatch(i,i)}else(t.componentInstance=function(t,e){var i={_isComponent:!0,_parentVnode:t,parent:e},n=t.data.inlineTemplate;return r(n)&&(i.render=n.render,i.staticRenderFns=n.staticRenderFns),new t.componentOptions.Ctor(i)}(t,Je)).$mount(e?t.elm:void 0,e)},prepatch:function(t,e){var n=e.componentOptions;!function(t,e,n,r,s){var o=r.data.scopedSlots,a=t.$scopedSlots,c=!!(o&&!o.$stable||a!==i&&!a.$stable||o&&t.$scopedSlots.$key!==o.$key||!o&&t.$scopedSlots.$key),h=!!(s||t.$options._renderChildren||c);if(t.$options._parentVnode=r,t.$vnode=r,t._vnode&&(t._vnode.parent=r),t.$options._renderChildren=s,t.$attrs=r.data.attrs||i,t.$listeners=n||i,e&&t.$options.props){wt(!1);for(var l=t._props,d=t.$options._propKeys||[],u=0;u<d.length;u++){var f=d[u],g=t.$options.props;l[f]=jt(f,g,e,t)}wt(!0),t.$options.propsData=e}n=n||i;var p=t.$options._parentListeners;t.$options._parentListeners=n,Ze(t,n,p),h&&(t.$slots=fe(s,r.context),t.$forceUpdate())}(e.componentInstance=t.componentInstance,n.propsData,n.listeners,e,n.children)},insert:function(t){var e,i=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,ii(n,"mounted")),t.data.keepAlive&&(i._isMounted?((e=n)._inactive=!1,ri.push(e)):ti(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?ei(e,!0):e.$destroy())}},De=Object.keys($e);function Ne(t,e,o,c,h){if(!n(t)){var l=o.$options._base;if(a(t)&&(t=l.extend(t)),"function"==typeof t){var u;if(n(t.cid)&&(t=function(t,e){if(s(t.error)&&r(t.errorComp))return t.errorComp;if(r(t.resolved))return t.resolved;var i=Xe;if(i&&r(t.owners)&&-1===t.owners.indexOf(i)&&t.owners.push(i),s(t.loading)&&r(t.loadingComp))return t.loadingComp;if(i&&!r(t.owners)){var o=t.owners=[i],c=!0,h=null,l=null;i.$on("hook:destroyed",(function(){return _(o,i)}));var u=function(t){for(var e=0,i=o.length;e<i;e++)o[e].$forceUpdate();t&&(o.length=0,null!==h&&(clearTimeout(h),h=null),null!==l&&(clearTimeout(l),l=null))},f=R((function(i){t.resolved=Ye(i,e),c?o.length=0:u(!0)})),g=R((function(e){r(t.errorComp)&&(t.error=!0,u(!0))})),p=t(f,g);return a(p)&&(d(p)?n(t.resolved)&&p.then(f,g):d(p.component)&&(p.component.then(f,g),r(p.error)&&(t.errorComp=Ye(p.error,e)),r(p.loading)&&(t.loadingComp=Ye(p.loading,e),0===p.delay?t.loading=!0:h=setTimeout((function(){h=null,n(t.resolved)&&n(t.error)&&(t.loading=!0,u(!1))}),p.delay||200)),r(p.timeout)&&(l=setTimeout((function(){l=null,n(t.resolved)&&g(null)}),p.timeout)))),c=!1,t.loading?t.loadingComp:t.resolved}}(u=t,l),void 0===t))return function(t,e,i,n,r){var s=gt();return s.asyncFactory=t,s.asyncMeta={data:e,context:i,children:n,tag:r},s}(u,e,o,c,h);e=e||{},Ci(t),r(e.model)&&function(t,e){var i=t.model&&t.model.prop||"value",n=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[i]=e.model.value;var s=e.on||(e.on={}),o=s[n],a=e.model.callback;r(o)?(Array.isArray(o)?-1===o.indexOf(a):o!==a)&&(s[n]=[a].concat(o)):s[n]=a}(t.options,e);var f=function(t,e,i){var s=e.options.props;if(!n(s)){var o={},a=t.attrs,c=t.props;if(r(a)||r(c))for(var h in s){var l=k(h);ce(o,c,h,l,!0)||ce(o,a,h,l,!1)}return o}}(e,t);if(s(t.options.functional))return function(t,e,n,s,o){var a=t.options,c={},h=a.props;if(r(h))for(var l in h)c[l]=jt(l,h,e||i);else r(n.attrs)&&je(c,n.attrs),r(n.props)&&je(c,n.props);var d=new Re(n,c,o,s,t),u=a.render.call(null,d._c,d);if(u instanceof ut)return Ie(u,n,d.parent,a);if(Array.isArray(u)){for(var f=he(u)||[],g=new Array(f.length),p=0;p<f.length;p++)g[p]=Ie(f[p],n,d.parent,a);return g}}(t,f,e,o,c);var g=e.on;if(e.on=e.nativeOn,s(t.options.abstract)){var p=e.slot;e={},p&&(e.slot=p)}!function(t){for(var e=t.hook||(t.hook={}),i=0;i<De.length;i++){var n=De[i],r=e[n],s=$e[n];r===s||r&&r._merged||(e[n]=r?Ve(s,r):s)}}(e);var v=t.options.name||h;return new ut("vue-component-"+t.cid+(v?"-"+v:""),e,void 0,void 0,void 0,o,{Ctor:t,propsData:f,listeners:g,tag:h,children:c},u)}}}function Ve(t,e){var i=function(i,n){t(i,n),e(i,n)};return i._merged=!0,i}function We(t,e,i,n,c,h){return(Array.isArray(i)||o(i))&&(c=n,n=i,i=void 0),s(h)&&(c=2),function(t,e,i,n,s){if(r(i)&&r(i.__ob__))return gt();if(r(i)&&r(i.is)&&(e=i.is),!e)return gt();var o,c,h;(Array.isArray(n)&&"function"==typeof n[0]&&((i=i||{}).scopedSlots={default:n[0]},n.length=0),2===s?n=he(n):1===s&&(n=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(n)),"string"==typeof e)?(c=t.$vnode&&t.$vnode.ns||D.getTagNamespace(e),o=D.isReservedTag(e)?new ut(D.parsePlatformTagName(e),i,n,void 0,void 0,t):i&&i.pre||!r(h=It(t.$options,"components",e))?new ut(e,i,n,void 0,void 0,t):Ne(h,i,t,n,e)):o=Ne(e,i,t,n);return Array.isArray(o)?o:r(o)?(r(c)&&He(o,c),r(i)&&function(t){a(t.style)&&ie(t.style),a(t.class)&&ie(t.class)}(i),o):gt()}(t,e,i,n,c)}function He(t,e,i){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,i=!0),r(t.children))for(var o=0,a=t.children.length;o<a;o++){var c=t.children[o];r(c.tag)&&(n(c.ns)||s(i)&&"svg"!==c.tag)&&He(c,e,i)}}var Fe,Xe=null;function Ye(t,e){return(t.__esModule||st&&"Module"===t[Symbol.toStringTag])&&(t=t.default),a(t)?e.extend(t):t}function qe(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];if(r(i)&&(r(i.componentOptions)||pe(i)))return i}}function ze(t,e){Fe.$on(t,e)}function Ue(t,e){Fe.$off(t,e)}function Ge(t,e){var i=Fe;return function n(){var r=e.apply(null,arguments);null!==r&&i.$off(t,n)}}function Ze(t,e,i){Fe=t,oe(e,i||{},ze,Ue,Ge,t),Fe=void 0}var Je=null;function Ke(t){var e=Je;return Je=t,function(){Je=e}}function Qe(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function ti(t,e){if(e){if(t._directInactive=!1,Qe(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var i=0;i<t.$children.length;i++)ti(t.$children[i]);ii(t,"activated")}}function ei(t,e){if(!(e&&(t._directInactive=!0,Qe(t))||t._inactive)){t._inactive=!0;for(var i=0;i<t.$children.length;i++)ei(t.$children[i]);ii(t,"deactivated")}}function ii(t,e){lt();var i=t.$options[e],n=e+" hook";if(i)for(var r=0,s=i.length;r<s;r++)Ht(i[r],t,null,t,n);t._hasHookEvent&&t.$emit("hook:"+e),dt()}var ni=[],ri=[],si={},oi=!1,ai=!1,ci=0,hi=0,li=Date.now;if(F&&!z){var di=window.performance;di&&"function"==typeof di.now&&li()>document.createEvent("Event").timeStamp&&(li=function(){return di.now()})}function ui(){var t,e;for(hi=li(),ai=!0,ni.sort((function(t,e){return t.id-e.id})),ci=0;ci<ni.length;ci++)(t=ni[ci]).before&&t.before(),e=t.id,si[e]=null,t.run();var i=ri.slice(),n=ni.slice();ci=ni.length=ri.length=0,si={},oi=ai=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,ti(t[e],!0)}(i),function(t){for(var e=t.length;e--;){var i=t[e],n=i.vm;n._watcher===i&&n._isMounted&&!n._isDestroyed&&ii(n,"updated")}}(n),it&&D.devtools&&it.emit("flush")}var fi=0,gi=function(t,e,i,n,r){this.vm=t,r&&(t._watcher=this),t._watchers.push(this),n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++fi,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new rt,this.newDepIds=new rt,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!W.test(t)){var e=t.split(".");return function(t){for(var i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}}}(e),this.getter||(this.getter=O)),this.value=this.lazy?void 0:this.get()};gi.prototype.get=function(){var t;lt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;Wt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ie(t),dt(),this.cleanupDeps()}return t},gi.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},gi.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},gi.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==si[e]){if(si[e]=!0,ai){for(var i=ni.length-1;i>ci&&ni[i].id>t.id;)i--;ni.splice(i+1,0,t)}else ni.push(t);oi||(oi=!0,te(ui))}}(this)},gi.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||a(t)||this.deep){var e=this.value;if(this.value=t,this.user){var i='callback for watcher "'+this.expression+'"';Ht(this.cb,this.vm,[t,e],this.vm,i)}else this.cb.call(this.vm,t,e)}}},gi.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},gi.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},gi.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||_(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var pi={enumerable:!0,configurable:!0,get:O,set:O};function _i(t,e,i){pi.get=function(){return this[e][i]},pi.set=function(t){this[e][i]=t},Object.defineProperty(t,i,pi)}var vi={lazy:!0};function mi(t,e,i){var n=!et();"function"==typeof i?(pi.get=n?bi(e):yi(i),pi.set=O):(pi.get=i.get?n&&!1!==i.cache?bi(e):yi(i.get):O,pi.set=i.set||O),Object.defineProperty(t,e,pi)}function bi(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),ct.target&&e.depend(),e.value}}function yi(t){return function(){return t.call(this,this)}}function wi(t,e,i,n){return h(i)&&(n=i,i=i.handler),"string"==typeof i&&(i=t[i]),t.$watch(e,i,n)}var xi=0;function Ci(t){var e=t.options;if(t.super){var i=Ci(t.super);if(i!==t.superOptions){t.superOptions=i;var n=function(t){var e,i=t.options,n=t.sealedOptions;for(var r in i)i[r]!==n[r]&&(e||(e={}),e[r]=i[r]);return e}(t);n&&B(t.extendOptions,n),(e=t.options=Rt(i,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function ki(t){this._init(t)}function Si(t){return t&&(t.Ctor.options.name||t.tag)}function Ei(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:(i=t,!("[object RegExp]"!==c.call(i))&&t.test(e));var i}function Bi(t,e){var i=t.cache,n=t.keys,r=t._vnode;for(var s in i){var o=i[s];if(o){var a=o.name;a&&!e(a)&&Ti(i,s,n,r)}}}function Ti(t,e,i,n){var r=t[e];!r||n&&r.tag===n.tag||r.componentInstance.$destroy(),t[e]=null,_(i,e)}!function(t){t.prototype._init=function(t){var e=this;e._uid=xi++,e._isVue=!0,t&&t._isComponent?function(t,e){var i=t.$options=Object.create(t.constructor.options),n=e._parentVnode;i.parent=e.parent,i._parentVnode=n;var r=n.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,e.render&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns)}(e,t):e.$options=Rt(Ci(e.constructor),t||{},e),e._renderProxy=e,e._self=e,function(t){var e=t.$options,i=e.parent;if(i&&!e.abstract){for(;i.$options.abstract&&i.$parent;)i=i.$parent;i.$children.push(t)}t.$parent=i,t.$root=i?i.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(e),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&Ze(t,e)}(e),function(t){t._vnode=null,t._staticTrees=null;var e=t.$options,n=t.$vnode=e._parentVnode,r=n&&n.context;t.$slots=fe(e._renderChildren,r),t.$scopedSlots=i,t._c=function(e,i,n,r){return We(t,e,i,n,r,!1)},t.$createElement=function(e,i,n,r){return We(t,e,i,n,r,!0)};var s=n&&n.data;kt(t,"$attrs",s&&s.attrs||i,null,!0),kt(t,"$listeners",e._parentListeners||i,null,!0)}(e),ii(e,"beforeCreate"),function(t){var e=ue(t.$options.inject,t);e&&(wt(!1),Object.keys(e).forEach((function(i){kt(t,i,e[i])})),wt(!0))}(e),function(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var i=t.$options.propsData||{},n=t._props={},r=t.$options._propKeys=[];t.$parent&&wt(!1);var s=function(s){r.push(s);var o=jt(s,e,i,t);kt(n,s,o),s in t||_i(t,"_props",s)};for(var o in e)s(o);wt(!0)}(t,e.props),e.methods&&function(t,e){for(var i in t.$options.props,e)t[i]="function"!=typeof e[i]?O:S(e[i],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;h(e=t._data="function"==typeof e?function(t,e){lt();try{return t.call(e,e)}catch(t){return Wt(t,e,"data()"),{}}finally{dt()}}(e,t):e||{})||(e={});for(var i,n=Object.keys(e),r=t.$options.props,s=(t.$options.methods,n.length);s--;){var o=n[s];r&&m(r,o)||(i=void 0,36===(i=(o+"").charCodeAt(0))||95===i)||_i(t,"_data",o)}Ct(e,!0)}(t):Ct(t._data={},!0),e.computed&&function(t,e){var i=t._computedWatchers=Object.create(null),n=et();for(var r in e){var s=e[r],o="function"==typeof s?s:s.get;n||(i[r]=new gi(t,o||O,O,vi)),r in t||mi(t,r,s)}}(t,e.computed),e.watch&&e.watch!==K&&function(t,e){for(var i in e){var n=e[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)wi(t,i,n[r]);else wi(t,i,n)}}(t,e.watch)}(e),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(e),ii(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(ki),function(t){Object.defineProperty(t.prototype,"$data",{get:function(){return this._data}}),Object.defineProperty(t.prototype,"$props",{get:function(){return this._props}}),t.prototype.$set=St,t.prototype.$delete=Et,t.prototype.$watch=function(t,e,i){var n=this;if(h(e))return wi(n,t,e,i);(i=i||{}).user=!0;var r=new gi(n,t,e,i);if(i.immediate){var s='callback for immediate watcher "'+r.expression+'"';lt(),Ht(e,n,[r.value],n,s),dt()}return function(){r.teardown()}}}(ki),function(t){var e=/^hook:/;t.prototype.$on=function(t,i){var n=this;if(Array.isArray(t))for(var r=0,s=t.length;r<s;r++)n.$on(t[r],i);else(n._events[t]||(n._events[t]=[])).push(i),e.test(t)&&(n._hasHookEvent=!0);return n},t.prototype.$once=function(t,e){var i=this;function n(){i.$off(t,n),e.apply(i,arguments)}return n.fn=e,i.$on(t,n),i},t.prototype.$off=function(t,e){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)i.$off(t[n],e);return i}var s,o=i._events[t];if(!o)return i;if(!e)return i._events[t]=null,i;for(var a=o.length;a--;)if((s=o[a])===e||s.fn===e){o.splice(a,1);break}return i},t.prototype.$emit=function(t){var e=this,i=e._events[t];if(i){i=i.length>1?E(i):i;for(var n=E(arguments,1),r='event handler for "'+t+'"',s=0,o=i.length;s<o;s++)Ht(i[s],e,n,e,r)}return e}}(ki),function(t){t.prototype._update=function(t,e){var i=this,n=i.$el,r=i._vnode,s=Ke(i);i._vnode=t,i.$el=r?i.__patch__(r,t):i.__patch__(i.$el,t,e,!1),s(),n&&(n.__vue__=null),i.$el&&(i.$el.__vue__=i),i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode&&(i.$parent.$el=i.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){ii(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||_(e.$children,t),t._watcher&&t._watcher.teardown();for(var i=t._watchers.length;i--;)t._watchers[i].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),ii(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(ki),function(t){Ae(t.prototype),t.prototype.$nextTick=function(t){return te(t,this)},t.prototype._render=function(){var t,e=this,i=e.$options,n=i.render,r=i._parentVnode;r&&(e.$scopedSlots=_e(r.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=r;try{Xe=e,t=n.call(e._renderProxy,e.$createElement)}catch(i){Wt(i,e,"render"),t=e._vnode}finally{Xe=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof ut||(t=gt()),t.parent=r,t}}(ki);var Oi=[String,RegExp,Array],Mi={name:"keep-alive",abstract:!0,props:{include:Oi,exclude:Oi,max:[String,Number]},methods:{cacheVNode:function(){var t=this,e=t.cache,i=t.keys,n=t.vnodeToCache,r=t.keyToCache;if(n){var s=n.tag,o=n.componentInstance,a=n.componentOptions;e[r]={name:Si(a),tag:s,componentInstance:o},i.push(r),this.max&&i.length>parseInt(this.max)&&Ti(e,i[0],i,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Ti(this.cache,t,this.keys)},mounted:function(){var t=this;this.cacheVNode(),this.$watch("include",(function(e){Bi(t,(function(t){return Ei(e,t)}))})),this.$watch("exclude",(function(e){Bi(t,(function(t){return!Ei(e,t)}))}))},updated:function(){this.cacheVNode()},render:function(){var t=this.$slots.default,e=qe(t),i=e&&e.componentOptions;if(i){var n=Si(i),r=this.include,s=this.exclude;if(r&&(!n||!Ei(r,n))||s&&n&&Ei(s,n))return e;var o=this.cache,a=this.keys,c=null==e.key?i.Ctor.cid+(i.tag?"::"+i.tag:""):e.key;o[c]?(e.componentInstance=o[c].componentInstance,_(a,c),a.push(c)):(this.vnodeToCache=e,this.keyToCache=c),e.data.keepAlive=!0}return e||t&&t[0]}},Pi={KeepAlive:Mi};!function(t){var e={get:function(){return D}};Object.defineProperty(t,"config",e),t.util={warn:ot,extend:B,mergeOptions:Rt,defineReactive:kt},t.set=St,t.delete=Et,t.nextTick=te,t.observable=function(t){return Ct(t),t},t.options=Object.create(null),j.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,B(t.options.components,Pi),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var i=E(arguments,1);return i.unshift(this),"function"==typeof t.install?t.install.apply(t,i):"function"==typeof t&&t.apply(null,i),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Rt(this.options,t),this}}(t),function(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var i=this,n=i.cid,r=t._Ctor||(t._Ctor={});if(r[n])return r[n];var s=t.name||i.options.name,o=function(t){this._init(t)};return(o.prototype=Object.create(i.prototype)).constructor=o,o.cid=e++,o.options=Rt(i.options,t),o.super=i,o.options.props&&function(t){var e=t.options.props;for(var i in e)_i(t.prototype,"_props",i)}(o),o.options.computed&&function(t){var e=t.options.computed;for(var i in e)mi(t.prototype,i,e[i])}(o),o.extend=i.extend,o.mixin=i.mixin,o.use=i.use,j.forEach((function(t){o[t]=i[t]})),s&&(o.options.components[s]=o),o.superOptions=i.options,o.extendOptions=t,o.sealedOptions=B({},o.options),r[n]=o,o}}(t),function(t){j.forEach((function(e){t[e]=function(t,i){return i?("component"===e&&h(i)&&(i.name=i.name||t,i=this.options._base.extend(i)),"directive"===e&&"function"==typeof i&&(i={bind:i,update:i}),this.options[e+"s"][t]=i,i):this.options[e+"s"][t]}}))}(t)}(ki),Object.defineProperty(ki.prototype,"$isServer",{get:et}),Object.defineProperty(ki.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(ki,"FunctionalRenderContext",{value:Re}),ki.version="2.6.14";var Li=g("style,class"),Ai=g("input,textarea,option,select,progress"),Ri=g("contenteditable,draggable,spellcheck"),Ii=g("events,caret,typing,plaintext-only"),ji=g("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),$i="http://www.w3.org/1999/xlink",Di=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Ni=function(t){return Di(t)?t.slice(6,t.length):""},Vi=function(t){return null==t||!1===t};function Wi(t,e){return{staticClass:Hi(t.staticClass,e.staticClass),class:r(t.class)?[t.class,e.class]:e.class}}function Hi(t,e){return t?e?t+" "+e:t:e||""}function Fi(t){return Array.isArray(t)?function(t){for(var e,i="",n=0,s=t.length;n<s;n++)r(e=Fi(t[n]))&&""!==e&&(i&&(i+=" "),i+=e);return i}(t):a(t)?function(t){var e="";for(var i in t)t[i]&&(e&&(e+=" "),e+=i);return e}(t):"string"==typeof t?t:""}var Xi={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Yi=g("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),qi=g("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),zi=function(t){return Yi(t)||qi(t)},Ui=Object.create(null),Gi=g("text,number,password,search,email,tel,url"),Zi=Object.freeze({createElement:function(t,e){var i=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i},createElementNS:function(t,e){return document.createElementNS(Xi[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,i){t.insertBefore(e,i)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),Ji={create:function(t,e){Ki(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Ki(t,!0),Ki(e))},destroy:function(t){Ki(t,!0)}};function Ki(t,e){var i=t.data.ref;if(r(i)){var n=t.context,s=t.componentInstance||t.elm,o=n.$refs;e?Array.isArray(o[i])?_(o[i],s):o[i]===s&&(o[i]=void 0):t.data.refInFor?Array.isArray(o[i])?o[i].indexOf(s)<0&&o[i].push(s):o[i]=[s]:o[i]=s}}var Qi=new ut("",{},[]),tn=["create","activate","update","remove","destroy"];function en(t,e){return t.key===e.key&&t.asyncFactory===e.asyncFactory&&(t.tag===e.tag&&t.isComment===e.isComment&&r(t.data)===r(e.data)&&function(t,e){if("input"!==t.tag)return!0;var i,n=r(i=t.data)&&r(i=i.attrs)&&i.type,s=r(i=e.data)&&r(i=i.attrs)&&i.type;return n===s||Gi(n)&&Gi(s)}(t,e)||s(t.isAsyncPlaceholder)&&n(e.asyncFactory.error))}function nn(t,e,i){var n,s,o={};for(n=e;n<=i;++n)r(s=t[n].key)&&(o[s]=n);return o}var rn={create:sn,update:sn,destroy:function(t){sn(t,Qi)}};function sn(t,e){(t.data.directives||e.data.directives)&&function(t,e){var i,n,r,s=t===Qi,o=e===Qi,a=an(t.data.directives,t.context),c=an(e.data.directives,e.context),h=[],l=[];for(i in c)n=a[i],r=c[i],n?(r.oldValue=n.value,r.oldArg=n.arg,hn(r,"update",e,t),r.def&&r.def.componentUpdated&&l.push(r)):(hn(r,"bind",e,t),r.def&&r.def.inserted&&h.push(r));if(h.length){var d=function(){for(var i=0;i<h.length;i++)hn(h[i],"inserted",e,t)};s?ae(e,"insert",d):d()}if(l.length&&ae(e,"postpatch",(function(){for(var i=0;i<l.length;i++)hn(l[i],"componentUpdated",e,t)})),!s)for(i in a)c[i]||hn(a[i],"unbind",t,t,o)}(t,e)}var on=Object.create(null);function an(t,e){var i,n,r=Object.create(null);if(!t)return r;for(i=0;i<t.length;i++)(n=t[i]).modifiers||(n.modifiers=on),r[cn(n)]=n,n.def=It(e.$options,"directives",n.name);return r}function cn(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function hn(t,e,i,n,r){var s=t.def&&t.def[e];if(s)try{s(i.elm,t,i,n,r)}catch(n){Wt(n,i.context,"directive "+t.name+" "+e+" hook")}}var ln=[Ji,rn];function dn(t,e){var i=e.componentOptions;if(!(r(i)&&!1===i.Ctor.options.inheritAttrs||n(t.data.attrs)&&n(e.data.attrs))){var s,o,a=e.elm,c=t.data.attrs||{},h=e.data.attrs||{};for(s in r(h.__ob__)&&(h=e.data.attrs=B({},h)),h)o=h[s],c[s]!==o&&un(a,s,o,e.data.pre);for(s in(z||G)&&h.value!==c.value&&un(a,"value",h.value),c)n(h[s])&&(Di(s)?a.removeAttributeNS($i,Ni(s)):Ri(s)||a.removeAttribute(s))}}function un(t,e,i,n){n||t.tagName.indexOf("-")>-1?fn(t,e,i):ji(e)?Vi(i)?t.removeAttribute(e):(i="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,i)):Ri(e)?t.setAttribute(e,function(t,e){return Vi(e)||"false"===e?"false":"contenteditable"===t&&Ii(e)?e:"true"}(e,i)):Di(e)?Vi(i)?t.removeAttributeNS($i,Ni(e)):t.setAttributeNS($i,e,i):fn(t,e,i)}function fn(t,e,i){if(Vi(i))t.removeAttribute(e);else{if(z&&!U&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==i&&!t.__ieph){var n=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",n)};t.addEventListener("input",n),t.__ieph=!0}t.setAttribute(e,i)}}var gn={create:dn,update:dn};function pn(t,e){var i=e.elm,s=e.data,o=t.data;if(!(n(s.staticClass)&&n(s.class)&&(n(o)||n(o.staticClass)&&n(o.class)))){var a=function(t){for(var e=t.data,i=t,n=t;r(n.componentInstance);)(n=n.componentInstance._vnode)&&n.data&&(e=Wi(n.data,e));for(;r(i=i.parent);)i&&i.data&&(e=Wi(e,i.data));return s=e.staticClass,o=e.class,r(s)||r(o)?Hi(s,Fi(o)):"";var s,o}(e),c=i._transitionClasses;r(c)&&(a=Hi(a,Fi(c))),a!==i._prevClass&&(i.setAttribute("class",a),i._prevClass=a)}}var _n,vn={create:pn,update:pn};function mn(t,e,i){var n=_n;return function r(){var s=e.apply(null,arguments);null!==s&&wn(t,r,i,n)}}var bn=qt&&!(J&&Number(J[1])<=53);function yn(t,e,i,n){if(bn){var r=hi,s=e;e=s._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=r||t.timeStamp<=0||t.target.ownerDocument!==document)return s.apply(this,arguments)}}_n.addEventListener(t,e,Q?{capture:i,passive:n}:i)}function wn(t,e,i,n){(n||_n).removeEventListener(t,e._wrapper||e,i)}function xn(t,e){if(!n(t.data.on)||!n(e.data.on)){var i=e.data.on||{},s=t.data.on||{};_n=e.elm,function(t){if(r(t.__r)){var e=z?"change":"input";t[e]=[].concat(t.__r,t[e]||[]),delete t.__r}r(t.__c)&&(t.change=[].concat(t.__c,t.change||[]),delete t.__c)}(i),oe(i,s,yn,wn,mn,e.context),_n=void 0}}var Cn,kn={create:xn,update:xn};function Sn(t,e){if(!n(t.data.domProps)||!n(e.data.domProps)){var i,s,o=e.elm,a=t.data.domProps||{},c=e.data.domProps||{};for(i in r(c.__ob__)&&(c=e.data.domProps=B({},c)),a)i in c||(o[i]="");for(i in c){if(s=c[i],"textContent"===i||"innerHTML"===i){if(e.children&&(e.children.length=0),s===a[i])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===i&&"PROGRESS"!==o.tagName){o._value=s;var h=n(s)?"":String(s);En(o,h)&&(o.value=h)}else if("innerHTML"===i&&qi(o.tagName)&&n(o.innerHTML)){(Cn=Cn||document.createElement("div")).innerHTML="<svg>"+s+"</svg>";for(var l=Cn.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}else if(s!==a[i])try{o[i]=s}catch(t){}}}}function En(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var i=!0;try{i=document.activeElement!==t}catch(t){}return i&&t.value!==e}(t,e)||function(t,e){var i=t.value,n=t._vModifiers;if(r(n)){if(n.number)return f(i)!==f(e);if(n.trim)return i.trim()!==e.trim()}return i!==e}(t,e))}var Bn={create:Sn,update:Sn},Tn=b((function(t){var e={},i=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach((function(t){if(t){var n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function On(t){var e=Mn(t.style);return t.staticStyle?B(t.staticStyle,e):e}function Mn(t){return Array.isArray(t)?T(t):"string"==typeof t?Tn(t):t}var Pn,Ln=/^--/,An=/\s*!important$/,Rn=function(t,e,i){if(Ln.test(e))t.style.setProperty(e,i);else if(An.test(i))t.style.setProperty(k(e),i.replace(An,""),"important");else{var n=jn(e);if(Array.isArray(i))for(var r=0,s=i.length;r<s;r++)t.style[n]=i[r];else t.style[n]=i}},In=["Webkit","Moz","ms"],jn=b((function(t){if(Pn=Pn||document.createElement("div").style,"filter"!==(t=w(t))&&t in Pn)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<In.length;i++){var n=In[i]+e;if(n in Pn)return n}}));function $n(t,e){var i=e.data,s=t.data;if(!(n(i.staticStyle)&&n(i.style)&&n(s.staticStyle)&&n(s.style))){var o,a,c=e.elm,h=s.staticStyle,l=s.normalizedStyle||s.style||{},d=h||l,u=Mn(e.data.style)||{};e.data.normalizedStyle=r(u.__ob__)?B({},u):u;var f=function(t,e){for(var i,n={},r=t;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(i=On(r.data))&&B(n,i);(i=On(t.data))&&B(n,i);for(var s=t;s=s.parent;)s.data&&(i=On(s.data))&&B(n,i);return n}(e);for(a in d)n(f[a])&&Rn(c,a,"");for(a in f)(o=f[a])!==d[a]&&Rn(c,a,null==o?"":o)}}var Dn={create:$n,update:$n},Nn=/\s+/;function Vn(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Nn).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var i=" "+(t.getAttribute("class")||"")+" ";i.indexOf(" "+e+" ")<0&&t.setAttribute("class",(i+e).trim())}}function Wn(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Nn).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var i=" "+(t.getAttribute("class")||"")+" ",n=" "+e+" ";i.indexOf(n)>=0;)i=i.replace(n," ");(i=i.trim())?t.setAttribute("class",i):t.removeAttribute("class")}}function Hn(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&B(e,Fn(t.name||"v")),B(e,t),e}return"string"==typeof t?Fn(t):void 0}}var Fn=b((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),Xn=F&&!U,Yn="transition",qn="animation",zn="transition",Un="transitionend",Gn="animation",Zn="animationend";Xn&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(zn="WebkitTransition",Un="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Gn="WebkitAnimation",Zn="webkitAnimationEnd"));var Jn=F?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Kn(t){Jn((function(){Jn(t)}))}function Qn(t,e){var i=t._transitionClasses||(t._transitionClasses=[]);i.indexOf(e)<0&&(i.push(e),Vn(t,e))}function tr(t,e){t._transitionClasses&&_(t._transitionClasses,e),Wn(t,e)}function er(t,e,i){var n=nr(t,e),r=n.type,s=n.timeout,o=n.propCount;if(!r)return i();var a=r===Yn?Un:Zn,c=0,h=function(){t.removeEventListener(a,l),i()},l=function(e){e.target===t&&++c>=o&&h()};setTimeout((function(){c<o&&h()}),s+1),t.addEventListener(a,l)}var ir=/\b(transform|all)(,|$)/;function nr(t,e){var i,n=window.getComputedStyle(t),r=(n[zn+"Delay"]||"").split(", "),s=(n[zn+"Duration"]||"").split(", "),o=rr(r,s),a=(n[Gn+"Delay"]||"").split(", "),c=(n[Gn+"Duration"]||"").split(", "),h=rr(a,c),l=0,d=0;return e===Yn?o>0&&(i=Yn,l=o,d=s.length):e===qn?h>0&&(i=qn,l=h,d=c.length):d=(i=(l=Math.max(o,h))>0?o>h?Yn:qn:null)?i===Yn?s.length:c.length:0,{type:i,timeout:l,propCount:d,hasTransform:i===Yn&&ir.test(n[zn+"Property"])}}function rr(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map((function(e,i){return sr(e)+sr(t[i])})))}function sr(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function or(t,e){var i=t.elm;r(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var s=Hn(t.data.transition);if(!n(s)&&!r(i._enterCb)&&1===i.nodeType){for(var o=s.css,c=s.type,h=s.enterClass,l=s.enterToClass,d=s.enterActiveClass,u=s.appearClass,g=s.appearToClass,p=s.appearActiveClass,_=s.beforeEnter,v=s.enter,m=s.afterEnter,b=s.enterCancelled,y=s.beforeAppear,w=s.appear,x=s.afterAppear,C=s.appearCancelled,k=s.duration,S=Je,E=Je.$vnode;E&&E.parent;)S=E.context,E=E.parent;var B=!S._isMounted||!t.isRootInsert;if(!B||w||""===w){var T=B&&u?u:h,O=B&&p?p:d,M=B&&g?g:l,P=B&&y||_,L=B&&"function"==typeof w?w:v,A=B&&x||m,I=B&&C||b,j=f(a(k)?k.enter:k),$=!1!==o&&!U,D=hr(L),N=i._enterCb=R((function(){$&&(tr(i,M),tr(i,O)),N.cancelled?($&&tr(i,T),I&&I(i)):A&&A(i),i._enterCb=null}));t.data.show||ae(t,"insert",(function(){var e=i.parentNode,n=e&&e._pending&&e._pending[t.key];n&&n.tag===t.tag&&n.elm._leaveCb&&n.elm._leaveCb(),L&&L(i,N)})),P&&P(i),$&&(Qn(i,T),Qn(i,O),Kn((function(){tr(i,T),N.cancelled||(Qn(i,M),D||(cr(j)?setTimeout(N,j):er(i,c,N)))}))),t.data.show&&(e&&e(),L&&L(i,N)),$||D||N()}}}function ar(t,e){var i=t.elm;r(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var s=Hn(t.data.transition);if(n(s)||1!==i.nodeType)return e();if(!r(i._leaveCb)){var o=s.css,c=s.type,h=s.leaveClass,l=s.leaveToClass,d=s.leaveActiveClass,u=s.beforeLeave,g=s.leave,p=s.afterLeave,_=s.leaveCancelled,v=s.delayLeave,m=s.duration,b=!1!==o&&!U,y=hr(g),w=f(a(m)?m.leave:m),x=i._leaveCb=R((function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),b&&(tr(i,l),tr(i,d)),x.cancelled?(b&&tr(i,h),_&&_(i)):(e(),p&&p(i)),i._leaveCb=null}));v?v(C):C()}function C(){x.cancelled||(!t.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),u&&u(i),b&&(Qn(i,h),Qn(i,d),Kn((function(){tr(i,h),x.cancelled||(Qn(i,l),y||(cr(w)?setTimeout(x,w):er(i,c,x)))}))),g&&g(i,x),b||y||x())}}function cr(t){return"number"==typeof t&&!isNaN(t)}function hr(t){if(n(t))return!1;var e=t.fns;return r(e)?hr(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function lr(t,e){!0!==e.data.show&&or(e)}var dr=function(t){var e,i,a={},c=t.modules,h=t.nodeOps;for(e=0;e<tn.length;++e)for(a[tn[e]]=[],i=0;i<c.length;++i)r(c[i][tn[e]])&&a[tn[e]].push(c[i][tn[e]]);function l(t){var e=h.parentNode(t);r(e)&&h.removeChild(e,t)}function d(t,e,i,n,o,c,l){if(r(t.elm)&&r(c)&&(t=c[l]=_t(t)),t.isRootInsert=!o,!function(t,e,i,n){var o=t.data;if(r(o)){var c=r(t.componentInstance)&&o.keepAlive;if(r(o=o.hook)&&r(o=o.init)&&o(t,!1),r(t.componentInstance))return u(t,e),f(i,t.elm,n),s(c)&&function(t,e,i,n){for(var s,o=t;o.componentInstance;)if(r(s=(o=o.componentInstance._vnode).data)&&r(s=s.transition)){for(s=0;s<a.activate.length;++s)a.activate[s](Qi,o);e.push(o);break}f(i,t.elm,n)}(t,e,i,n),!0}}(t,e,i,n)){var d=t.data,g=t.children,_=t.tag;r(_)?(t.elm=t.ns?h.createElementNS(t.ns,_):h.createElement(_,t),m(t),p(t,g,e),r(d)&&v(t,e),f(i,t.elm,n)):s(t.isComment)?(t.elm=h.createComment(t.text),f(i,t.elm,n)):(t.elm=h.createTextNode(t.text),f(i,t.elm,n))}}function u(t,e){r(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,_(t)?(v(t,e),m(t)):(Ki(t),e.push(t))}function f(t,e,i){r(t)&&(r(i)?h.parentNode(i)===t&&h.insertBefore(t,e,i):h.appendChild(t,e))}function p(t,e,i){if(Array.isArray(e))for(var n=0;n<e.length;++n)d(e[n],i,t.elm,null,!0,e,n);else o(t.text)&&h.appendChild(t.elm,h.createTextNode(String(t.text)))}function _(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return r(t.tag)}function v(t,i){for(var n=0;n<a.create.length;++n)a.create[n](Qi,t);r(e=t.data.hook)&&(r(e.create)&&e.create(Qi,t),r(e.insert)&&i.push(t))}function m(t){var e;if(r(e=t.fnScopeId))h.setStyleScope(t.elm,e);else for(var i=t;i;)r(e=i.context)&&r(e=e.$options._scopeId)&&h.setStyleScope(t.elm,e),i=i.parent;r(e=Je)&&e!==t.context&&e!==t.fnContext&&r(e=e.$options._scopeId)&&h.setStyleScope(t.elm,e)}function b(t,e,i,n,r,s){for(;n<=r;++n)d(i[n],s,t,e,!1,i,n)}function y(t){var e,i,n=t.data;if(r(n))for(r(e=n.hook)&&r(e=e.destroy)&&e(t),e=0;e<a.destroy.length;++e)a.destroy[e](t);if(r(e=t.children))for(i=0;i<t.children.length;++i)y(t.children[i])}function w(t,e,i){for(;e<=i;++e){var n=t[e];r(n)&&(r(n.tag)?(x(n),y(n)):l(n.elm))}}function x(t,e){if(r(e)||r(t.data)){var i,n=a.remove.length+1;for(r(e)?e.listeners+=n:e=function(t,e){function i(){0==--i.listeners&&l(t)}return i.listeners=e,i}(t.elm,n),r(i=t.componentInstance)&&r(i=i._vnode)&&r(i.data)&&x(i,e),i=0;i<a.remove.length;++i)a.remove[i](t,e);r(i=t.data.hook)&&r(i=i.remove)?i(t,e):e()}else l(t.elm)}function C(t,e,i,n){for(var s=i;s<n;s++){var o=e[s];if(r(o)&&en(t,o))return s}}function k(t,e,i,o,c,l){if(t!==e){r(e.elm)&&r(o)&&(e=o[c]=_t(e));var u=e.elm=t.elm;if(s(t.isAsyncPlaceholder))r(e.asyncFactory.resolved)?B(t.elm,e,i):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(t.isStatic)&&e.key===t.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=t.componentInstance;else{var f,g=e.data;r(g)&&r(f=g.hook)&&r(f=f.prepatch)&&f(t,e);var p=t.children,v=e.children;if(r(g)&&_(e)){for(f=0;f<a.update.length;++f)a.update[f](t,e);r(f=g.hook)&&r(f=f.update)&&f(t,e)}n(e.text)?r(p)&&r(v)?p!==v&&function(t,e,i,s,o){for(var a,c,l,u=0,f=0,g=e.length-1,p=e[0],_=e[g],v=i.length-1,m=i[0],y=i[v],x=!o;u<=g&&f<=v;)n(p)?p=e[++u]:n(_)?_=e[--g]:en(p,m)?(k(p,m,s,i,f),p=e[++u],m=i[++f]):en(_,y)?(k(_,y,s,i,v),_=e[--g],y=i[--v]):en(p,y)?(k(p,y,s,i,v),x&&h.insertBefore(t,p.elm,h.nextSibling(_.elm)),p=e[++u],y=i[--v]):en(_,m)?(k(_,m,s,i,f),x&&h.insertBefore(t,_.elm,p.elm),_=e[--g],m=i[++f]):(n(a)&&(a=nn(e,u,g)),n(c=r(m.key)?a[m.key]:C(m,e,u,g))?d(m,s,t,p.elm,!1,i,f):en(l=e[c],m)?(k(l,m,s,i,f),e[c]=void 0,x&&h.insertBefore(t,l.elm,p.elm)):d(m,s,t,p.elm,!1,i,f),m=i[++f]);u>g?b(t,n(i[v+1])?null:i[v+1].elm,i,f,v,s):f>v&&w(e,u,g)}(u,p,v,i,l):r(v)?(r(t.text)&&h.setTextContent(u,""),b(u,null,v,0,v.length-1,i)):r(p)?w(p,0,p.length-1):r(t.text)&&h.setTextContent(u,""):t.text!==e.text&&h.setTextContent(u,e.text),r(g)&&r(f=g.hook)&&r(f=f.postpatch)&&f(t,e)}}}function S(t,e,i){if(s(i)&&r(t.parent))t.parent.data.pendingInsert=e;else for(var n=0;n<e.length;++n)e[n].data.hook.insert(e[n])}var E=g("attrs,class,staticClass,staticStyle,key");function B(t,e,i,n){var o,a=e.tag,c=e.data,h=e.children;if(n=n||c&&c.pre,e.elm=t,s(e.isComment)&&r(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(r(c)&&(r(o=c.hook)&&r(o=o.init)&&o(e,!0),r(o=e.componentInstance)))return u(e,i),!0;if(r(a)){if(r(h))if(t.hasChildNodes())if(r(o=c)&&r(o=o.domProps)&&r(o=o.innerHTML)){if(o!==t.innerHTML)return!1}else{for(var l=!0,d=t.firstChild,f=0;f<h.length;f++){if(!d||!B(d,h[f],i,n)){l=!1;break}d=d.nextSibling}if(!l||d)return!1}else p(e,h,i);if(r(c)){var g=!1;for(var _ in c)if(!E(_)){g=!0,v(e,i);break}!g&&c.class&&ie(c.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,i,o){if(!n(e)){var c,l=!1,u=[];if(n(t))l=!0,d(e,u);else{var f=r(t.nodeType);if(!f&&en(t,e))k(t,e,u,null,null,o);else{if(f){if(1===t.nodeType&&t.hasAttribute(I)&&(t.removeAttribute(I),i=!0),s(i)&&B(t,e,u))return S(e,u,!0),t;c=t,t=new ut(h.tagName(c).toLowerCase(),{},[],void 0,c)}var g=t.elm,p=h.parentNode(g);if(d(e,u,g._leaveCb?null:p,h.nextSibling(g)),r(e.parent))for(var v=e.parent,m=_(e);v;){for(var b=0;b<a.destroy.length;++b)a.destroy[b](v);if(v.elm=e.elm,m){for(var x=0;x<a.create.length;++x)a.create[x](Qi,v);var C=v.data.hook.insert;if(C.merged)for(var E=1;E<C.fns.length;E++)C.fns[E]()}else Ki(v);v=v.parent}r(p)?w([t],0,0):r(t.tag)&&y(t)}}return S(e,u,l),e.elm}r(t)&&y(t)}}({nodeOps:Zi,modules:[gn,vn,kn,Bn,Dn,F?{create:lr,activate:lr,remove:function(t,e){!0!==t.data.show?ar(t,e):e()}}:{}].concat(ln)});U&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&br(t,"input")}));var ur={inserted:function(t,e,i,n){"select"===i.tag?(n.elm&&!n.elm._vOptions?ae(i,"postpatch",(function(){ur.componentUpdated(t,e,i)})):fr(t,e,i.context),t._vOptions=[].map.call(t.options,_r)):("textarea"===i.tag||Gi(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",vr),t.addEventListener("compositionend",mr),t.addEventListener("change",mr),U&&(t.vmodel=!0)))},componentUpdated:function(t,e,i){if("select"===i.tag){fr(t,e,i.context);var n=t._vOptions,r=t._vOptions=[].map.call(t.options,_r);r.some((function(t,e){return!L(t,n[e])}))&&(t.multiple?e.value.some((function(t){return pr(t,r)})):e.value!==e.oldValue&&pr(e.value,r))&&br(t,"change")}}};function fr(t,e,i){gr(t,e),(z||G)&&setTimeout((function(){gr(t,e)}),0)}function gr(t,e,i){var n=e.value,r=t.multiple;if(!r||Array.isArray(n)){for(var s,o,a=0,c=t.options.length;a<c;a++)if(o=t.options[a],r)s=A(n,_r(o))>-1,o.selected!==s&&(o.selected=s);else if(L(_r(o),n))return void(t.selectedIndex!==a&&(t.selectedIndex=a));r||(t.selectedIndex=-1)}}function pr(t,e){return e.every((function(e){return!L(e,t)}))}function _r(t){return"_value"in t?t._value:t.value}function vr(t){t.target.composing=!0}function mr(t){t.target.composing&&(t.target.composing=!1,br(t.target,"input"))}function br(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)}function yr(t){return!t.componentInstance||t.data&&t.data.transition?t:yr(t.componentInstance._vnode)}var wr={bind:function(t,e,i){var n=e.value,r=(i=yr(i)).data&&i.data.transition,s=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;n&&r?(i.data.show=!0,or(i,(function(){t.style.display=s}))):t.style.display=n?s:"none"},update:function(t,e,i){var n=e.value;!n!=!e.oldValue&&((i=yr(i)).data&&i.data.transition?(i.data.show=!0,n?or(i,(function(){t.style.display=t.__vOriginalDisplay})):ar(i,(function(){t.style.display="none"}))):t.style.display=n?t.__vOriginalDisplay:"none")},unbind:function(t,e,i,n,r){r||(t.style.display=t.__vOriginalDisplay)}},xr={model:ur,show:wr},Cr={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function kr(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?kr(qe(e.children)):t}function Sr(t){var e={},i=t.$options;for(var n in i.propsData)e[n]=t[n];var r=i._parentListeners;for(var s in r)e[w(s)]=r[s];return e}function Er(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var Br=function(t){return t.tag||pe(t)},Tr=function(t){return"show"===t.name},Or={name:"transition",props:Cr,abstract:!0,render:function(t){var e=this,i=this.$slots.default;if(i&&(i=i.filter(Br)).length){var n=this.mode,r=i[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return r;var s=kr(r);if(!s)return r;if(this._leaving)return Er(t,r);var a="__transition-"+this._uid+"-";s.key=null==s.key?s.isComment?a+"comment":a+s.tag:o(s.key)?0===String(s.key).indexOf(a)?s.key:a+s.key:s.key;var c=(s.data||(s.data={})).transition=Sr(this),h=this._vnode,l=kr(h);if(s.data.directives&&s.data.directives.some(Tr)&&(s.data.show=!0),l&&l.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(s,l)&&!pe(l)&&(!l.componentInstance||!l.componentInstance._vnode.isComment)){var d=l.data.transition=B({},c);if("out-in"===n)return this._leaving=!0,ae(d,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Er(t,r);if("in-out"===n){if(pe(s))return h;var u,f=function(){u()};ae(c,"afterEnter",f),ae(c,"enterCancelled",f),ae(d,"delayLeave",(function(t){u=t}))}}return r}}},Mr=B({tag:String,moveClass:String},Cr);function Pr(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function Lr(t){t.data.newPos=t.elm.getBoundingClientRect()}function Ar(t){var e=t.data.pos,i=t.data.newPos,n=e.left-i.left,r=e.top-i.top;if(n||r){t.data.moved=!0;var s=t.elm.style;s.transform=s.WebkitTransform="translate("+n+"px,"+r+"px)",s.transitionDuration="0s"}}delete Mr.mode;var Rr={Transition:Or,TransitionGroup:{props:Mr,beforeMount:function(){var t=this,e=this._update;this._update=function(i,n){var r=Ke(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,r(),e.call(t,i,n)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),n=this.prevChildren=this.children,r=this.$slots.default||[],s=this.children=[],o=Sr(this),a=0;a<r.length;a++){var c=r[a];c.tag&&null!=c.key&&0!==String(c.key).indexOf("__vlist")&&(s.push(c),i[c.key]=c,(c.data||(c.data={})).transition=o)}if(n){for(var h=[],l=[],d=0;d<n.length;d++){var u=n[d];u.data.transition=o,u.data.pos=u.elm.getBoundingClientRect(),i[u.key]?h.push(u):l.push(u)}this.kept=t(e,null,h),this.removed=l}return t(e,null,s)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(Pr),t.forEach(Lr),t.forEach(Ar),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var i=t.elm,n=i.style;Qn(i,e),n.transform=n.WebkitTransform=n.transitionDuration="",i.addEventListener(Un,i._moveCb=function t(n){n&&n.target!==i||n&&!/transform$/.test(n.propertyName)||(i.removeEventListener(Un,t),i._moveCb=null,tr(i,e))})}})))},methods:{hasMove:function(t,e){if(!Xn)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){Wn(i,t)})),Vn(i,e),i.style.display="none",this.$el.appendChild(i);var n=nr(i);return this.$el.removeChild(i),this._hasMove=n.hasTransform}}}};ki.config.mustUseProp=function(t,e,i){return"value"===i&&Ai(t)&&"button"!==e||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},ki.config.isReservedTag=zi,ki.config.isReservedAttr=Li,ki.config.getTagNamespace=function(t){return qi(t)?"svg":"math"===t?"math":void 0},ki.config.isUnknownElement=function(t){if(!F)return!0;if(zi(t))return!1;if(t=t.toLowerCase(),null!=Ui[t])return Ui[t];var e=document.createElement(t);return t.indexOf("-")>-1?Ui[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Ui[t]=/HTMLUnknownElement/.test(e.toString())},B(ki.options.directives,xr),B(ki.options.components,Rr),ki.prototype.__patch__=F?dr:O,ki.prototype.$mount=function(t,e){return function(t,e,i){var n;return t.$el=e,t.$options.render||(t.$options.render=gt),ii(t,"beforeMount"),n=function(){t._update(t._render(),i)},new gi(t,n,O,{before:function(){t._isMounted&&!t._isDestroyed&&ii(t,"beforeUpdate")}},!0),i=!1,null==t.$vnode&&(t._isMounted=!0,ii(t,"mounted")),t}(this,t=t&&F?function(t){return"string"==typeof t?document.querySelector(t)||document.createElement("div"):t}(t):void 0,e)},F&&setTimeout((function(){D.devtools&&it&&it.emit("init",ki)}),0);const Ir=ki;function jr(t){const e=document.createElement("canvas"),i=e.getContext("2d"),{width:n,height:r,left:s,top:o}=t.getBoundingClientRect();e.style.width=n+"px",e.style.height=r+"px",e.style.userSelect="none";const a=window.devicePixelRatio;return e.width=Math.floor(n*a),e.height=Math.floor(r*a),t&&(t.style.position="relative",t.style.overflow="hidden",t.append(e)),{canvas:e,width:n,height:r,raw_width:e.width,raw_height:e.height,left:s,top:o,ctx:i,scale:a}}const $r=document.createElement("canvas");$r.width=1,$r.height=1;const Dr=$r.getContext("2d"),Nr=window.devicePixelRatio;function Vr(t){Dr.clearRect(0,0,5,5),Dr.save(),t(Dr),Dr.restore(),Dr.clearRect(0,0,5,5)}function Wr(t,e){const i=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);function n(){console.log("devicePixelRatio changed: "+window.devicePixelRatio),t(window.devicePixelRatio),Wr(t,e)}e((()=>{console.log("remove devicePixelRatio event handler"),i.removeEventListener("change",n,{once:!0})})),i.addEventListener("change",n,{once:!0})}Dr.scale(Nr,Nr);const{abs:Hr,cos:Fr,sin:Xr,acos:Yr,atan2:qr,sqrt:zr,pow:Ur}=Math;Math.PI,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER;const{abs:Gr,min:Zr,max:Jr,cos:Kr,sin:Qr,acos:ts,sqrt:es}=Math;Math.PI;const is="DEFAULT",ns="LINKING";function rs(t){if(0===t.length)return{width:1,height:1,x:0,y:0};let e=1/0,i=1/0,n=-1/0,r=-1/0;for(let s in t){const o=t[s];o[0]<e&&(e=o[0]),o[0]>n&&(n=o[0]),o[1]<i&&(i=o[1]),o[1]>r&&(r=o[1])}return{width:Math.max(n-e,10),height:Math.max(r-i,10),x:e,y:i}}function ss(t,e){return t[0]!=t[2]&&t[1]!=t[3]&&e[0]!=e[2]&&e[1]!=e[3]&&!(t[2]<=e[0]||t[3]<=e[1]||t[0]>=e[2]||t[1]>=e[3])}const os=Symbol("ishit"),as=Symbol("isInViewBox");class cs extends EventTarget{constructor(t={}){super(),Object.assign(this,t),this.visible=!0,this._belongs=void 0,this[os]=!1,this.borderWidth=t.borderWidth||0,this.borderColor=t.borderColor||"transparent",this.backgroundColor=t.backgroundColor||"transparent",this.shadowColor=t.shadowColor,this.shadowBlur=t.shadowBlur||5,this.shadowOffsetX=t.shadowOffsetX||0,this.shadowOffsetY=t.shadowOffsetY||0,this.opacity=t.opacity||1,this._boundingrect=[0,0,0,0]}get _isTargeting(){return this===(this._jflow._target.instance||this._jflow._target.link)}get _isMoving(){return this===this._jflow._getMovingTarget()&&this._jflow._target.status.movingState}get _isHit(){return this[os]}get _jflow(){return"jflow"===this._belongs.uniqueName?this._belongs:this._belongs._jflow}set _isHit(t){this[os]!==t&&this.dispatchEvent(new CustomEvent(t?"mouseenter":"mouseleave",{detail:{instance:this,jflow:this._jflow}})),this[os]=t}get isInViewBox(){return this[as]}set _isInViewBox(t){t!==this[as]&&(t?this.onEnterViewbox():this.onLeaveViewbox()),this[as]=t}onEnterViewbox(){}onLeaveViewbox(){}setConfig(t){Object.keys(t).forEach((e=>{void 0!==t[e]&&null!==t[e]&&(this[e]=t[e])}))}render(t){throw"require render implement"}isHit(t){throw"require isHit implement"}getBoundingRect(){throw"require getBoundingRect implement"}calculateIntersection(){throw"require calculateIntersection implement"}getIntersectionsInFourDimension(){throw"require getIntersectionsInFourDimension implement"}getCenter(){return this.anchor}getBoundingDimension(){const t=instance.getBoundingRect();let e=1/0,i=-1/0,n=1/0,r=-1/0;return t.forEach((t=>{i=Math.max(i,t[1]),e=Math.min(e,t[1]),r=Math.max(r,t[0]),n=Math.min(n,t[0])})),{height:i-e,width:r-n}}bubbleEvent(t){t.detail.currentTarget=this,this.dispatchEvent(t),t.detail.bubbles&&(this._belongs.bubbleEvent?this._belongs.bubbleEvent(t):this._belongs.dispatchEvent(t))}calculateToRealWorld(t){return this._belongs&&this._belongs.calculateToRealWorld?this._belongs.calculateToRealWorld(t):t}calculateToRealWorldWithScalar(t){return this._jflow.scale*t}recalculateUp(){this.belongs&&this.belongs.recalculateUp()}destroy(){}}const hs=cs,ls=class extends hs{constructor(t={}){super(t),this._rawConfigs=t,this.anchor=t.anchor||[0,0],this.absolutePosition=t.absolutePosition}setConfig(t){Object.keys(t).forEach((e=>{void 0!==t[e]&&null!==t[e]&&(this[e]=t[e],this._rawConfigs[e]=t[e])}))}setAnchorX(t){this.anchor[0]=t}setAnchorY(t){this.anchor[1]=t}setAnchor(t,e){this.anchor[0]=t,this.anchor[1]=e}beforeRender(){return ss(this._belongs._getViewBox(),this.getBoundingRect())}clone(){const t=new(0,this.constructor)(this._rawConfigs);return t.visible=this.visible,t}},ds=class extends ls{constructor(t){super(t)}render(t){}isHit(t){return!1}calculateIntersection(t){return this.anchor}getBoundingRect(){const[t,e]=this.anchor;return[t,e,t,e]}getBoundingDimension(){return{width:0,height:0}}getIntersectionsInFourDimension(){const[t,e]=this.anchor;return{0:[t+1,e],2:[t-1,e],1:[t,e+1],3:[t,e-1]}}};class us{constructor(){this._map=new WeakMap}get(t){return this._map.get(t)}set(t){const e={layoutNode:void 0,jflowNode:void 0,jflowlinks:[],jflowFromLinks:[],jflowToLinks:[]};return this._map.set(t,e),e}has(t){return this._map.has(t)}delete(t){this._map.delete(t)}clear(){this._map.clear()}}const fs={initNodeWeakMap(){this.source_Layout_Render_NodeMap=new us},getRenderNodeBySource(t){const e=this.source_Layout_Render_NodeMap.get(t);if(e)return e.jflowNode},getLayoutNodeBySource(t){const e=this.source_Layout_Render_NodeMap.get(t);if(e)return e.layoutNode},getSourceRenderMeta(t){return this.source_Layout_Render_NodeMap.get(t)},_getMap(t){const e=this.source_Layout_Render_NodeMap;let i;return i=e.has(t)?e.get(t):e.set(t),i},setLayoutNodeBySource(t,e){this._getMap(t).layoutNode=e},setRenderNodeBySource(t,e){this._getMap(t).jflowNode=e},addLinkNodeBySource(t,e,i){let n=this._getMap(t);n.jflowFromLinks.push(i),n=this._getMap(e),n.jflowToLinks.push(i)},removeLinkNodeBySource(t,e,i){let n=this._getMap(t),r=n.jflowFromLinks.findIndex((t=>t===i));-1!==r&&n.jflowFromLinks.splice(r,1),n=this._getMap(e),r=n.jflowToLinks.findIndex((t=>t===i)),-1!==r&&n.jflowToLinks.splice(r,1)}},gs=class extends Array{constructor(){super(),this._currentHit=null}render(t,e){let i;this.forEach((n=>{if(n._isMoving)i=n;else if(n.visible&&(!e||e(n))){if(n.beforeRender&&!n.beforeRender(t))return;t.save(),n.render(t),t.restore()}})),i&&(t.save(),i.render(t),t.restore())}resetHitStatus(){this._currentHit=null,this.forEach((t=>{t._stack&&t._stack.resetHitStatus(),t._isHit=!1}))}checkHit(t,e,i){let n=this.length-1;for(;n>=0;){const r=this[n];if(r.visible&&!r.ignoreHit){if(e&&e(r)){n--;continue}if(i&&!i(r)){n--;continue}const s=r.isHit(t,e);if(s)return this._currentHit!==r&&(this._currentHit&&(this._currentHit._isHit=!1),r._isHit=!0,this._currentHit=r),"boolean"!=typeof s?s:r;r._isHit=!1}n--}return this._currentHit=null,null}getBoundingRectPoints(){const t=[];return this.forEach((e=>{if(e.visible&&!e.absolutePosition){const i=e.getBoundingRect();t.push([i[0],i[1]]),t.push([i[2],i[3]])}})),t}getAnchorRectPoints(){const t=[];return this.forEach((e=>{e.visible&&!e.absolutePosition&&t.push(e.anchor)})),t}},ps={instances:[],links:[],_stack:null,_linkStack:null,initStack({data:t}){this._stack=new gs,this._linkStack=new gs,t&&(this.instances=t.instances,this.links=t.links,this.instances.forEach((t=>{this._stack.push(t),t._belongs=this})),this.links.forEach((t=>{this._linkStack.push(t),t._belongs=this})))},addToStack(t){t._belongs=this,this._stack.push(t)},replaceFromStack(t,e){const i=this._stack.findIndex((e=>e===t));this._stack.splice(i,1,e),t._belongs=null,e._belongs=this},addToLinkStack(t){t._belongs=this,this._linkStack.push(t)},removeFromStack(t){const e=this._stack.findIndex((e=>e===t));-1!==e&&this._stack.splice(e,1)},removeFromLinkStack(t){const e=this._linkStack.findIndex((e=>e===t));-1!==e&&this._linkStack.splice(e,1)},emptyLink(){this._linkStack=new gs},resetChildrenPosition(){this._stack.forEach((t=>{t.anchor=[0,0]}))},addInstanceToLink(t,e){this.addToStack(e);const{from:i,to:n}=t,r=this._linkStack.findIndex((e=>e===t)),s=t.__proto__.constructor,o=new s({from:i,to:e});o._belongs=this;const a=new s({from:e,to:n});a._belongs=this,this._linkStack.splice(r,1,o,a)},interateNodeStack(t){this._stack.forEach((e=>{t(e)}))}},_s=ps,vs={_layout:null,initLayout(t){this._layout=t.layout},recalculateUp(){let t=!0;if(this.getBoundingDimension){const{width:e,height:i}=this.getBoundingDimension();this.resetChildrenPosition&&this.resetChildrenPosition(),this._getBoundingGroupRect&&this._getBoundingGroupRect(),this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect();const{width:n,height:r}=this.getBoundingDimension();t=e!==n||i!==r}else this.reflow();this._belongs&&t&&this._belongs.recalculateUp()},recalculate(){this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect()},staticCheck(t){return!!this._layout&&this._layout.staticCheck(t,this)},reflow(){this._layout&&this._layout.reflow(this)}},ms={_message:null,sendMessage(t){this._message=t},consumeMessage(){const t=this._message;return this._message=null,t},readMessage(){return this._message}},bs={initAnime(){this.anime_queue=[],this.__animeClock__=void 0},requestJFlowAnime(t){const e=this.enqueueAnime(t);return this._runAnime(),e},enqueueAnime(t){const e={start:void 0,callback:t,cancel:()=>{this._cancelAnime(e),this._render()}};return this.anime_queue.push(e),e},_cancelAnime(t){const e=this.anime_queue.findIndex((e=>e===t));~e&&this.anime_queue.splice(e,1)},runAnime(){this._runAnime()},_runAnime(){this.anime_queue.length&&requestAnimationFrame((()=>{this.scheduleRender(),this._runAnime()}))},runAnimeFrame(){this.anime_queue.forEach((t=>{const e=Date.now();t.start||(t.start=e);const i=e-t.start;t.callback(i)}))}},ys={captureMap(t,{padding:e=0,placement:i="normal"}){this._getBoundingGroupRect();const{width:n,height:r,x:s,y:o}=this.bounding_box;if(!this.miniMap){this.miniMap=jr(t);const{width:e,height:i,raw_width:n,raw_height:r}=this.miniMap;this.addEventListener("zoompan",(()=>{this._renderMap&&this._renderMap()}));let s=!1;this.miniMap.canvas.addEventListener("pointerdown",(t=>{let{offsetX:e,offsetY:i,deltaX:n,deltaY:r}=t;s=!0,this._onMoveMap&&this._onMoveMap(e,i)})),this.miniMap.canvas.addEventListener("pointermove",(t=>{let{offsetX:n,offsetY:r,deltaX:o,deltaY:a}=t;s&&this._onMoveMap&&this._onMoveMap(n,r),(r<5||n<5||n>e-5||r>i-5)&&(s=!1)})),this.miniMap.canvas.addEventListener("pointerup",(()=>{s=!1}));const o=document.createElement("canvas");o.width=n,o.height=r,this.cacheMinimapCtx=o.getContext("2d")}const{width:a,height:c,raw_width:h,raw_height:l,left:d,top:u,scale:f,ctx:g}=this.miniMap,p=2*e,_=e,v=(a-p)/n,m=(c-p)/r,b=Math.min(v,m);let y=0,w=0;"center"===i?(w=(c-r*b)/2-o*b,y=(a-n*b)/2-s*b):v<m?(w=(c-r*b)/2-o*b,y=_):(y=(a-n*b)/2-s*b,w=_);const x=this.cacheMinimapCtx;x.setTransform(),x.clearRect(0,0,h,l),x.scale(f,f),x.transform(b,0,0,b,y,w);const C=[0,0,0,0];this.NodeRenderTop?(this._linkStack.render(x,(t=>(t.isInViewBox(C),!0))),this._stack.render(x)):(this._stack.render(x),this._linkStack.render(x,(t=>(t.isInViewBox(C),!0))));const k=x.getImageData(0,0,h,l);this._renderMap=()=>{g.save(),g.setTransform(),g.clearRect(0,0,h,l),g.scale(f,f),g.putImageData(k,0,0),g.transform(b,0,0,b,y,w);const[t,e,i,n]=this._getViewBox();g.beginPath(),g.rect(t,e,i-t,n-e),g.setTransform(),g.rect(0,0,h,l),g.clip("evenodd"),g.fillStyle="rgba(0,0,0,0.4)",g.fillRect(0,0,h,l),g.restore()},this._renderMap(),this._onMoveMap=(t,e)=>{const[i,n,r,s]=this._getViewBox(),o=[((r-i)/2+i)*b+y,((s-n)/2+n)*b+w];this._recalculatePosition((o[0]-t)/b*this.scale,(o[1]-e)/b*this.scale),this._render(),this._renderMap()}}};class ws{constructor(t,e={}){this.anchor=[0,0],this.width=e.barWidth||4,this.height=e.barWidth||4,this.barMarginX=0,this.barMarginY=0,this.dir=t,this.plainColor=e.plainColor||"rgba(0, 0, 0, 0.15)",this.focusColor=e.focusColor||"rgba(0, 0, 0, 0.25)",this.isFocus=!1}render(t){const[e,i]=this.anchor;if(t.save(),t.beginPath(),"x"===this.dir){const n=this.height/2,r=i+n,s=i+this.height,o=e+this.width-2*this.barMarginX-n,a=e+this.barMarginX+n;t.moveTo(a,s),t.arc(a,r,n,Math.PI/2,Math.PI/2*3),t.lineTo(o,i),t.arc(o,r,n,-Math.PI/2,Math.PI/2),t.closePath()}else{const n=this.width/2,r=i+this.barMarginY+n,s=i+this.height-2*this.barMarginY-n,o=e+n,a=e+this.width;t.moveTo(e,r),t.arc(o,r,n,-Math.PI,0),t.lineTo(a,s),t.arc(o,s,n,0,Math.PI),t.closePath()}t.fillStyle=this.isFocus?this.focusColor:this.plainColor,t.fill(),t.restore()}isHit(t){const e=this.anchor,i=this.width,n=this.height;return t[0]>e[0]-5&&t[0]<e[0]+i+5&&t[1]>e[1]-5&&t[1]<e[1]+n+5}}const xs={initScrollBar(t={}){const{barColor:e,barFocusColor:i,barMarginX:n,barMarginY:r,barWidth:s}=t;this._scrollbarEnable=!0,this._scrollbarX=new ws("x",{plainColor:e,focusColor:i,barWidth:s}),this._scrollbarX.barMarginX=n||5,this._scrollbarY=new ws("y",{plainColor:e,focusColor:i,barWidth:s}),this._scrollbarY.barMarginY=r||5,this._scrollBarStatus={dragging:!1,target:null,xscale:void 0,yscale:void 0,barInitX:0,barInitY:0},this.addEventListener("zoompan",(()=>{this.scrollBarOnPanAndZoom()})),this.scrollBarOnPanAndZoom(),this.canvas.addEventListener("pointerdown",(t=>{const{offsetX:e,offsetY:i,clientX:n,clientY:r}=t;this.onScrollbarPressStart(e,i,n,r)}))},checkScrollDragging(){return this._scrollBarStatus&&this._scrollBarStatus.dragging},onScrollbarPressStart(t,e,i,n){this._scrollbarX.isHit([t,e])&&Object.assign(this._scrollBarStatus,{dragging:!0,target:this._scrollbarX,barStartX:this._scrollbarX.anchor[0],barInitX:i}),this._scrollbarY.isHit([t,e])&&Object.assign(this._scrollBarStatus,{dragging:!0,target:this._scrollbarY,barStartY:this._scrollbarY.anchor[1],barInitY:n});const r=(t=>{const{offsetX:e,offsetY:i,clientX:n,clientY:r}=t;this.onDraggingScrollbar(e,i,n,r)}).bind(this);document.addEventListener("pointermove",r);const s=(t=>{Object.assign(this._scrollBarStatus,{dragging:!1,target:null,x:void 0,y:void 0}),document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",s),this.canvas.removeEventListener("pointerup",s)}).bind(this);this.canvas.addEventListener("pointerup",s,{once:!0}),document.addEventListener("pointerup",s,{once:!0})},onDraggingScrollbar(t,e,i,n){if(this._scrollbarEnable&&this._scrollBarStatus.dragging){const{target:t,barInitX:e,barStartX:r,barInitY:s,barStartY:o,xscale:a,yscale:c,scollbarHeight:h,scollbarWidth:l,realR:d,realL:u,realT:f,realB:g}=this._scrollBarStatus,{actual_width:p,actual_height:_}=this.canvasMeta,{x:v,y:m}=this.bounding_box;if("x"===t.dir){const n=r+(i-e),s=(v-((d-u)*((t.anchor[0]=Math.max(Math.min(n,p-l),0))/p)+u))*this.scale;Object.assign(this.position,{offsetX:s-v*this.scale,x:s})}if("y"===t.dir){const e=o+(n-s),i=(m-((g-f)*((t.anchor[1]=Math.max(Math.min(e,_-h),0))/_)+f))*this.scale;Object.assign(this.position,{offsetY:i-m*this.scale,y:i})}return this.scheduleRender(),!0}return!1},checkScrollBarHover(t,e){if(this._scrollbarEnable){if(this._scrollbarX.isHit([t,e]))return this._scrollbarX.isFocus||(this._scrollbarX.isFocus=!0,this.scheduleRender()),this.canvas.style.cursor="default",!0;if(this._scrollbarY.isHit([t,e]))return this._scrollbarY.isFocus||(this._scrollbarY.isFocus=!0,this.scheduleRender()),this.canvas.style.cursor="default",!0}return!1},resetScrollBarHover(){this._scrollbarEnable&&(this._scrollbarY.isFocus||this._scrollbarX.isFocus)&&(this._scrollbarY.isFocus=!1,this._scrollbarX.isFocus=!1,this.scheduleRender())},_getScrollViewBoundingbox(){const{width:t,height:e,x:i,y:n}=this.bounding_box;return{width:t+240,height:e+240,x:i-120,y:n-120}},scrollBarOnPanAndZoom(){if(!this._scrollbarEnable||this._scrollBarStatus.dragging)return;const{width:t,height:e,x:i,y:n}=this._getScrollViewBoundingbox();let[r,s,o,a]=this._getViewBox();const c=Math.max(o,i+t),h=Math.min(r,i),l=Math.min(s,n),d=Math.max(a,n+e),u=o-r,f=a-s,{actual_width:g,actual_height:p}=this.canvasMeta,_=u/(c-h);if(_<1){const t=g*_,e=(r-h)*_*this.scale;this._scrollbarX.anchor=[e,p-10],this._scrollbarX.width=t,this._scrollBarStatus.scollbarWidth=t}const v=f/(d-l);if(v<1){const t=p*v,e=(s-l)*v*this.scale;this._scrollbarY.anchor=[g-10,e],this._scrollbarY.height=t,this._scrollBarStatus.scollbarHeight=t}Object.assign(this._scrollBarStatus,{yscale:v,xscale:_,realR:c,realL:h,realT:l,realB:d})},resetScollBarStatus(){this._scrollbarEnable&&Object.assign(this._scrollBarStatus,{dragging:!1,target:null,x:void 0,y:void 0})},renderScrollBar(t){if(this._scrollbarEnable){t.setTransform(),t.scale(this.dpr,this.dpr);const{xscale:e,yscale:i}=this._scrollBarStatus;e<1&&this._scrollbarX.render(t),i<1&&this._scrollbarY.render(t)}}},Cs={initSchedule(){this.__clock__=void 0},scheduleRender(t){requestAnimationFrame((e=>{this.__clock__!==e&&this.__render(),t&&t(e),this.__clock__=e}))}};class ks extends CustomEvent{constructor(t,e={}){super(t,{detail:{...e,originEvent:e.event,target:e.target,jflow:e.jflow,bubbles:e.bubbles||!1}})}}const Ss=ks,Es={..._s,...vs,_setPadding(t){this.padding={top:t.paddingTop||t.padding||0,right:t.paddingRight||t.padding||0,bottom:t.paddingBottom||t.padding||0,left:t.paddingLeft||t.padding||0}},_setMargin(t){this.margin={top:t.marginTop||t.margin||0,right:t.marginRight||t.margin||0,bottom:t.marginBottom||t.margin||0,left:t.marginLeft||t.margin||0}},_getCenter(){const t=this.anchor,e=this.padding,i=this.margin,n=(i.left-i.right)/2,r=(i.top-i.bottom)/2,s=(e.left-e.right)/2+n,o=(e.top-e.bottom)/2+r;return this._shape.anchor=[t[0]+n,t[1]+r],[t[0]+s,t[1]+o]},setAnchorX(t){this.anchor[0]=t,this._getCenter()},setAnchorY(t){this.anchor[1]=t,this._getCenter()},setAnchor(t,e){this.anchor[0]=t,this.anchor[1]=e,this._getCenter()},_calculatePointBack(t){const[e,i]=t,[n,r]=this._getCenter();return[e-n,i-r]},_calculatePointBackWithPoint(t,e,i,n,r){const s=this.anchor,o=this.padding,a=this.margin;i[n]=t-(s[0]+(o.left-o.right)/2+(a.left-a.right)/2),i[r]=e-(s[1]+(o.top-o.bottom)/2+(a.top-a.bottom)/2)},calculateToCoordination(t){const[e,i]=t,[n,r]=this._getCenter(),s=[e+n,i+r];return this._belongs&&this._belongs.calculateToCoordination?this._belongs.calculateToCoordination(s):s},calculateToRealWorld(t){const[e,i]=t,[n,r]=this._getCenter(),s=[e+n,i+r];if(this._belongs&&this._belongs.calculateToRealWorld)return this._belongs.calculateToRealWorld(s)},clone(){const t=new(0,this.constructor)(Object.assign({},this._rawConfigs,{layout:this._layout&&this._layout.clone()}));return this.interateNodeStack((e=>{t.addToStack(e.clone())})),t.recalculate(),t.visible=this.visible,t},getBoundingDimension(){return{width:this.width,height:this.height}},getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a},getIntersectionsInFourDimension(){let t=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(t=this._belongs.calculateToCoordination(t));const[e,i]=t,n=this.width/2,r=this.height/2;return{0:[e+n,i],2:[e-n,i],1:[e,i+r],3:[e,i-r],100:[e+.618*n,i+.618*r]}},calculateIntersection(t){const[e,i]=t,[n,r]=this.anchor,s=this.width/2,o=this.height/2,a=n-e,c=r-i,h=o/s,l=Math.abs(c/a),d=e>n,u=i>r;let f,g;return l<h?(f=n+(d?s:-s),g=s*(u?l:-l)+r):(g=r+(u?o:-o),f=o/(d?l:-l)+n),[f,g]},onEnterViewbox(){this.interateNodeStack((t=>{t.onEnterViewbox()}))},onLeaveViewbox(){this.interateNodeStack((t=>{t.onLeaveViewbox()}))},destroy(){this._shape.destroy(),this.interateNodeStack((t=>{t.destroy()}))}};function Bs(t,e){return[t,e]}const Ts=function(t,e={}){const i="function"==typeof e.shapeShift?e.shapeShift:Bs;class n extends ls{constructor(e){super(e),this.initStack(e),this.initLayout(e),this._shape=new t(e),this._shape.anchor=[0,0],this._shape._belongs=this,this._setPadding(e),this._setMargin(e),this.definedWidth=e.width,this.minWidth=e.minWidth,this.definedHeight=e.height,this.lock=e.lock??!0,this.display=e.display||"default",this.transparent=e.transparent??!1,this._getBoundingGroupRect(),this.reflow(),this._getBoundingGroupRect(),this._cacheViewBox=[]}}return Object.assign(n.prototype,Es),Object.assign(n.prototype,{reflow(){Es.reflow.call(this);const t=this.margin,[e,n]=i(this.width-t.left-t.right,this.height-t.top-t.bottom,this._shape);this._shape.width=e,this._shape.height=n},setConfig(t){this._shape.setConfig(t),this._setPadding(t),this._setMargin(t),"opacity"in t&&(this.opacity=t.opacity),t.layout&&this._layout!==t.layout&&(this._layout=t.layout)},_getBoundingGroupRect(){const t=rs(this._stack.getBoundingRectPoints()),e=this.padding,n=this.minWidth,r=this.definedWidth,s=t.width+e.left+e.right,o=t.height+e.top+e.bottom,a=n?Math.max(n,s):r||s,c=this.definedHeight||o;this._paddingWidth=a,this._paddingHeight=c;const[h,l]=i(a,c,this._shape);this._shape.width=h,this._shape.height=l;const d=this.margin;this.width=h+d.left+d.right,this.height=l+d.top+d.bottom},_getViewBox(){const t=this._belongs.getCacheViewBox(),e=this._cacheViewBox;return this._calculatePointBackWithPoint(t[0],t[1],e,0,1),this._calculatePointBackWithPoint(t[2],t[3],e,2,3),this._cacheViewBox},getCacheViewBox(){return this._cacheViewBox},render(t){t.save(),this._isMoving?t.globalAlpha=.6:1!==this.opacity&&(t.globalAlpha=this.opacity);const[e,i]=this._getCenter();this._shape.render(t),t.translate(e,i),this._stack.render(t),t.translate(-e,-i),t.restore()},isHit(t,e){const i=this._calculatePointBack(t);this._currentp=i;return this._stack.checkHit(i,e)||!this.transparent&&this._shape.isHit(t)}}),n},Os=class extends ls{constructor(t={}){super(t),this.type="Rectangle",this.width=t.width||10,this.height=t.height||10,this.borderRadius=t.borderRadius||0,this._setBorder(t)}_setBorder(t){this.border={top:{color:t.border?.top?.borderColor||t.borderColor||"transparent",width:t.border?.top?.borderWidth||t.borderWidth||0,enable:t.border?.top?.borderWidth},right:{color:t.border?.right?.borderColor||t.borderColor||"transparent",width:t.border?.right?.borderWidth||t.borderWidth||0,enable:t.border?.right?.borderWidth},bottom:{color:t.border?.bottom?.borderColor||t.borderColor||"transparent",width:t.border?.bottom?.borderWidth||t.borderWidth||0,enable:t.border?.bottom?.borderWidth},left:{color:t.border?.left?.borderColor||t.borderColor||"transparent",width:t.border?.left?.borderWidth||t.borderWidth||0,enable:t.border?.left?.borderWidth}},this.borderColor=t.borderColor||"transparent",this.borderWidth=t.borderWidth||0}setConfig(t){Object.keys(t).forEach((e=>{void 0!==t[e]&&null!==t[e]&&(this[e]=t[e],this._rawConfigs[e]=t[e])})),this._setBorder(t)}render(t){t.save(),this._isMoving&&(t.globalAlpha=.6);const{borderRadius:e,anchor:i,width:n,height:r}=this,s=this.anchor[0]-this.width/2,o=this.anchor[1]-this.height/2,a=this.anchor[0]+this.width/2,c=this.anchor[1]+this.height/2;if(this.borderRadius?(t.beginPath(),t.moveTo(s+e,o),t.lineTo(s+n-e,o),t.quadraticCurveTo(s+n,o,s+n,o+e),t.lineTo(s+n,o+r-e),t.quadraticCurveTo(s+n,o+r,s+n-e,o+r),t.lineTo(s+e,o+r),t.quadraticCurveTo(s,o+r,s,o+r-e),t.lineTo(s,o+e),t.quadraticCurveTo(s,o,s+e,o),t.closePath()):(t.beginPath(),t.rect(this.anchor[0]-this.width/2,this.anchor[1]-this.height/2,this.width,this.height)),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor),this.shadowColor&&"transparent"!==this.shadowColor){t.shadowColor=this.shadowColor;const i=this._jflow.scale;t.shadowBlur=this.shadowBlur*i,t.shadowOffsetX=this.shadowOffsetX*i,t.shadowOffsetY=this.shadowOffsetY*i;let a=new Path2D;this.borderRadius?(a.moveTo(s+e,o),a.lineTo(s+n-e,o),a.quadraticCurveTo(s+n,o,s+n,o+e),a.lineTo(s+n,o+r-e),a.quadraticCurveTo(s+n,o+r,s+n-e,o+r),a.lineTo(s+e,o+r),a.quadraticCurveTo(s,o+r,s,o+r-e),a.lineTo(s,o+e),a.quadraticCurveTo(s,o,s+e,o),a.closePath()):a.rect(this.anchor[0]-this.width/2,this.anchor[1]-this.height/2,this.width,this.height),a.rect(s-10,o-10,this.width+20,this.height+20),t.save(),t.clip(a,"evenodd"),t.stroke(),t.restore()}if(t.fillStyle=this.backgroundColor,t.fill(),this.borderRadius&&this.borderWidth&&(t.shadowColor="transparent",t.stroke()),this.borderRadius){if(this.border.top.enable){const i=o-this.border.top.width/2;t.beginPath();let r=new Path2D;r.moveTo(s,i+e),r.quadraticCurveTo(s,i,s+e,i),r.lineTo(s+n-e,i),r.quadraticCurveTo(s+n,i,s+n,i+e),r.closePath(),t.clip(r),t.save(),t.shadowColor="transparent",t.fillStyle=this.border.top.color,t.rect(s,i,this.width,this.border.top.width),t.fill(),t.restore()}}else this.border.top.width&&(t.beginPath(),t.moveTo(s,o),t.lineTo(a,o),t.strokeStyle=this.border.top.color,t.lineWidth=this.border.top.width,t.stroke()),this.border.right.width&&(t.beginPath(),t.moveTo(a,o),t.lineTo(a,c),t.strokeStyle=this.border.right.color,t.lineWidth=this.border.right.width,t.stroke()),this.border.bottom.width&&(t.beginPath(),t.moveTo(a,c),t.lineTo(s,c),t.strokeStyle=this.border.bottom.color,t.lineWidth=this.border.bottom.width,t.stroke()),this.border.left.width&&(t.beginPath(),t.moveTo(s,c),t.lineTo(s,o),t.strokeStyle=this.border.left.color,t.lineWidth=this.border.left.width,t.stroke());t.restore()}isHit(t){const e=this.anchor,i=this.width/2,n=this.height/2;return t[0]>e[0]-i&&t[0]<e[0]+i&&t[1]>e[1]-n&&t[1]<e[1]+n}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}getBoundingDimension(){return{height:this.height,width:this.width}}calculateIntersection(t){const[e,i]=t,[n,r]=this.anchor,s=this.width/2,o=this.height/2,a=n-e,c=r-i,h=o/s,l=Math.abs(c/a),d=e>n,u=i>r;let f,g;return l<h?(f=n+(d?s:-s),g=s*(u?l:-l)+r):(g=r+(u?o:-o),f=o/(d?l:-l)+n),[f,g]}getIntersectionsInFourDimension(){let t=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(t=this._belongs.calculateToCoordination(t));const[e,i]=t,n=this.width/2,r=this.height/2;return{0:[e+n,i],2:[e-n,i],1:[e,i+r],3:[e,i-r]}}calculateIntersectionInFourDimension(t,e){const[i,n]=t;let r=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(r=this._belongs.calculateToCoordination(r));const[s,o]=r,a=this.width/2,c=this.height/2,h={0:[s+a,o],2:[s-a,o],1:[s,o+c],3:[s,o-c]},l=s-i,d=o-n,u=c/a;let f=Math.abs(d/l)>u?n>o?1:3:i>s?0:2;return{p:h[f],dir:f}}},Ms=class extends ls{constructor(t={}){super(t),this.type="Capsule",this.width=t.width||20,this.height=t.height||10}render(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();const[e,i]=this.anchor,n=this.width/2,r=this.height/2,s=e-n+r,o=e+n-r,a=i-r,c=i+r;t.moveTo(s,a),t.lineTo(o,a),t.arc(o,i,r,-Math.PI/2,Math.PI/2),t.lineTo(s,c),t.arc(s,i,r,Math.PI/2,Math.PI/2*3),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}isHit(t){const e=this.anchor,i=this.width/2,n=this.height/2,r=Math.abs(i-n),s=e[0]-i+n,o=e[0]+i-n,a=n*n;return t[0]>e[0]-r&&t[0]<e[0]+r&&t[1]>e[1]-n&&t[1]<e[1]+n||Math.pow(t[0]-s,2)+Math.pow(t[1]-e[1],2)<a||Math.pow(t[0]-o,2)+Math.pow(t[1]-e[1],2)<a}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}getBoundingDimension(){return{height:this.height,width:this.width}}getIntersectionsInFourDimension(){let t=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(t=this._belongs.calculateToCoordination(t));const[e,i]=t,n=this.width/2,r=this.height/2;return{0:[e+n,i],2:[e-n,i],1:[e,i+r],3:[e,i-r]}}},Ps=class extends ls{constructor(t={}){super(t),this.type="Diamond",this.width=t.width||20,this.height=t.height||10,this.side=t.side||6,this._doCache()}setConfig(t){Object.keys(t).forEach((e=>{void 0!==t[e]&&null!==t[e]&&(this[e]=t[e],this._rawConfigs[e]=t[e])})),this._doCache()}_doCache(){this.sinSIDE=Math.sin(Math.PI/3)*this.side,this.cosSIDE=Math.cos(Math.PI/3)*this.side}render(t){const[e,i]=this.anchor,n=this.width/2,r=this.height/2,s=r/1.732,o=e-n+s,a=e+n-s,c=e+n,h=e-n,l=i-r,d=i+r;this._cachePoints=[[a,l],[c,i],[a,d],[o,d],[h,i],[o,l]],t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();const{side:u,sinSIDE:f,cosSIDE:g}=this;t.moveTo(e,l),t.lineTo(a-u,l),t.quadraticCurveTo(a,l,a+g,l+f),t.lineTo(c-g,i-f),t.quadraticCurveTo(c,i,c-g,i+f),t.lineTo(a+g,d-f),t.quadraticCurveTo(a,d,a-u,d),t.lineTo(o+u,d),t.quadraticCurveTo(o,d,o-g,d-f),t.lineTo(h+g,i+f),t.quadraticCurveTo(h,i,h+g,i-f),t.lineTo(o-g,l+f),t.quadraticCurveTo(o,l,o+u,l),t.closePath(),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}isHit(t){if(!this._cachePoints)return!1;const e=this._cachePoints;let i=!1;for(let n=0,r=e.length-1;n<e.length;n++)e[n][1]>t[1]!=e[r][1]>t[1]&&t[0]<(e[r][0]-e[n][0])*(t[1]-e[n][1])/(e[r][1]-e[n][1])+e[n][0]&&(i=!i),r=n;return i}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}getBoundingDimension(){return{height:this.height,width:this.width}}getIntersectionsInFourDimension(){let t=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(t=this._belongs.calculateToCoordination(t));const[e,i]=t,n=this.width/2,r=this.height/2;return{0:[e+n,i],2:[e-n,i],1:[e,i+r],3:[e,i-r]}}};Math.sqrt(3);const Ls=Symbol("ishit");class As extends ws{constructor(t,e={}){super(t,e),this.visible=!1}render(t){this.visible&&super.render(t)}setHit(t){this[Ls]!==t&&(this.isFocus=t,this.onHit()),this[Ls]=t}}class Rs extends ls{constructor(t){super(t),this.type="ScrollGroup",this.initStack(t),this.initLayout(t),this.initScrollBar(t),this._shape=new Os(t),this._shape.anchor=[0,0],this._shape._belongs=this,this.maxWidth=t.maxWidth||1/0,this.definedWidth=t.definedWidth,this.maxHeight=t.maxHeight||1/0,this.definedHeight=t.definedHeight,this.lock=t.lock??!0,this._offset=[0,0],this._getBoundingGroupRect(),this.reflow(),this._getBoundingGroupRect(),this._resetOffset(),this._cacheViewBox=[]}initScrollBar(t){const{barColor:e,barFocusColor:i,barMarginX:n,barMarginY:r,barWidth:s}=t;this._scrollbarX=new As("x",{plainColor:e,focusColor:i,barWidth:s}),this._scrollbarY=new As("y",{plainColor:e,focusColor:i,barWidth:s}),this._scrollbarX.barMarginX=n||1,this._scrollbarY.barMarginY=r||1;const o=()=>{this._jflow.scheduleRender()};this._scrollbarX.onHit=o,this._scrollbarY.onHit=o,this._scrollBarStatus={dragging:!1,target:null,barInitX:0,barInitY:0,barStartX:0,barStartY:0,hitScrollX:!1,hitScrollY:!1},this.addEventListener("instancePressStart",(t=>{if(this._scrollBarStatus.hitScrollX){t.detail.preventDefault(),t.detail.bubbles=!1;const e=t.detail.event.clientX;Object.assign(this._scrollBarStatus,{dragging:!0,target:this._scrollbarX,barStartX:this._scrollbarX.anchor[0],barInitX:e}),this.onScrollbarPressStart()}if(this._scrollBarStatus.hitScrollY){t.detail.preventDefault(),t.detail.bubbles=!1;const e=t.detail.event.clientY;Object.assign(this._scrollBarStatus,{dragging:!0,target:this._scrollbarY,barStartY:this._scrollbarY.anchor[1],barInitY:e}),this.onScrollbarPressStart()}}))}onScrollbarPressStart(){const t=this._jflow.canvas,e=(t=>{const{clientX:e,clientY:i}=t;this.onDraggingScrollbar(e,i)}).bind(this);document.addEventListener("pointermove",e);const i=(n=>{Object.assign(this._scrollBarStatus,{dragging:!1,target:null,barInitX:0,barInitY:0,barStartX:0,barStartY:0,hitScrollX:!1,hitScrollY:!1}),document.removeEventListener("pointermove",e),document.removeEventListener("pointerup",i),t.removeEventListener("pointerup",i)}).bind(this);t.addEventListener("pointerup",i,{once:!0}),document.addEventListener("pointerup",i,{once:!0})}onDraggingScrollbar(t,e){if(this._scrollbarX.visible&&this._scrollBarStatus.dragging){const i=this._jflow,n=i.scale,{target:r,barInitX:s,barStartX:o,barInitY:a,barStartY:c}=this._scrollBarStatus;if("x"===r.dir){const e=this._scrollbarX.width,a=this._outerWidth,c=o+(t-s)/n,h=(r.anchor[0]=Math.max(Math.min(c,a-e),0))/(a-e),l=(this._innerWidth-a)/2;this._offset[0]=l-(this._innerWidth-a)*h,i.scheduleRender()}if("y"===r.dir){const t=this._scrollbarY.height,s=this._outerHeight,o=c+(e-a)/n,h=(r.anchor[1]=Math.max(Math.min(o,s-t),0))/(s-t),l=(this._innerHeight-s)/2;this._offset[1]=l-(this._innerHeight-s)*h,i.scheduleRender()}}}setConfig(t){this._shape.setConfig(t)}_getBoundingGroupRect(){const t=rs(this._stack.getBoundingRectPoints()),e=t.width,i=t.height,n=this.definedWidth||Math.min(e,this.maxWidth),r=this.definedHeight||Math.min(i,this.maxHeight);this._innerWidth=e,this._outerWidth=n,this._innerHeight=i,this._outerHeight=r,this._shape.width=n,this._shape.height=r,this.width=n,this.height=r}_calculatePointBack(t){const[e,i]=t,[n,r]=this._offset,[s,o]=this.anchor;return[e-s-n,i-o-r]}_calculatePointBackWithPoint(t,e,i,n,r){const s=this.anchor,o=this._offset;i[n]=t-s[0]-o[0],i[r]=e-s[1]-o[1]}calculateToCoordination(t){const[e,i]=t,[n,r]=this.anchor,[s,o]=this._offset,a=[e+n-s,i+r-o];return this._belongs&&this._belongs.calculateToCoordination?this._belongs.calculateToCoordination(a):a}calculateToRealWorld(t){const[e,i]=t,[n,r]=this.anchor,[s,o]=this._offset,a=[e+n-s,i+r-o];if(this._belongs&&this._belongs.calculateToRealWorld)return this._belongs.calculateToRealWorld(a)}_getViewBox(){const t=this._cacheViewBox;return this._calculatePointBackWithPoint(0,0,t,0,1),this._calculatePointBackWithPoint(this.width,this.height,t,2,3),t}getCacheViewBox(){return this._cacheViewBox}_resetOffset(){this._offset=[Math.max((this._innerWidth-this._outerWidth)/2,0),Math.max((this._innerHeight-this._outerHeight)/2,0)],this._innerWidth>this._outerWidth?(this._scrollbarX.visible=!0,this._scrollbarX.width=this._outerWidth*this._outerWidth/this._innerWidth,this._scrollbarX.anchor=[0,this._outerHeight-4]):this._scrollbarX.visible=!1,this._innerHeight>this._outerHeight?(this._scrollbarY.visible=!0,this._scrollbarY.height=this._outerHeight*this._outerHeight/this._innerHeight,this._scrollbarY.anchor=[this._outerWidth-4,0]):this._scrollbarY.visible=!1}render(t){this._isMoving?t.globalAlpha=.6:1!==this.opacity&&(t.globalAlpha=this.opacity);const[e,i]=this.anchor,n=this.width,r=this.height,s=n/2,o=r/2,[a,c]=this._offset;t.translate(e,i),this._shape.render(t),t.translate(-s,-o),this._scrollbarX.visible&&this._scrollbarX.render(t),this._scrollbarY.visible&&this._scrollbarY.render(t),t.translate(s,o),t.save(),t.beginPath(),t.rect(-s,-o,n,r),t.clip(),t.translate(a,c),this._stack.render(t),this._linkStack.render(t),t.translate(-e-a,-i-c),t.restore()}isHit(t,e){const[i,n]=t,[r,s]=this.anchor,o=[i-r+this.width/2,n-s+this.height/2];if(this._scrollBarStatus.hitScrollX=!1,this._scrollBarStatus.hitScrollY=!1,this._scrollbarX.visible&&this._scrollbarX.isHit(o))return this._scrollBarStatus.hitScrollX=!0,this._scrollbarX.setHit(!0),!0;if(this._scrollbarX.setHit(!1),this._scrollbarY.visible&&this._scrollbarY.isHit(o))return this._scrollBarStatus.hitScrollY=!0,this._scrollbarY.setHit(!0),!0;if(this._scrollbarY.setHit(!1),this._shape.isHit([i-r,n-s])){const[t,o]=this._offset,a=[i-r-t,n-s-o];this._currentp=a;const c=this._stack.checkHit(a,e);if(c)return c}else this._stack.resetHitStatus();return!1}getBoundingDimension(){return{width:this.width,height:this.height}}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}getIntersectionsInFourDimension(){let t=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(t=this._belongs.calculateToCoordination(t));const[e,i]=t,n=this.width/2,r=this.height/2;return{0:[e+n,i],2:[e-n,i],1:[e,i+r],3:[e,i-r],100:[e+.618*n,i+.618*r]}}onEnterViewbox(){this.interateNodeStack((t=>{t.onEnterViewbox()}))}onLeaveViewbox(){this.interateNodeStack((t=>{t.onLeaveViewbox()}))}destroy(){this._shape.destroy(),this.interateNodeStack((t=>{t.destroy()}))}clone(){const t=new(0,this.constructor)(Object.assign({},this._rawConfigs,{layout:this._layout&&this._layout.clone()}));return this.interateNodeStack((e=>{t.addToStack(e.clone())})),t.recalculate(),t.visible=this.visible,t}}Object.assign(Rs.prototype,_s),Object.assign(Rs.prototype,vs),Object.assign(Rs.prototype,{recalculateUp(){let t=!0;if(this.getBoundingDimension){const e=this._innerWidth,i=this._innerHeight;this.resetChildrenPosition&&this.resetChildrenPosition(),this._getBoundingGroupRect&&this._getBoundingGroupRect(),this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect();const n=this._innerWidth,r=this._innerHeight;t=e!==n||i!==r}else this.reflow();this._belongs&&t&&(this._resetOffset(),this._belongs.recalculateUp())},recalculate(){const{width:t,height:e}=this.getBoundingDimension();this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect();const{width:i,height:n}=this.getBoundingDimension();t===i&&e===n||this._resetOffset()}});const Is=class extends ls{constructor(t){super(t),this.width=t.width,this.height=t.height,this.imageBuffer=document.createElement("canvas"),this.imageBuffer.width=this.width+2,this.imageBuffer.height=this.height+2,t.cache(this.imageBuffer.getContext("2d"))}render(t){const[e,i]=this.anchor;t.save(),t.translate(e,i),t.beginPath(),t.drawImage(this.imageBuffer,-this.width/2,-this.height/2),t.translate(-e,-i),t.restore()}getBoundingDimension(){return{height:this.height,width:this.width}}recalculate(){}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}};Math.PI,Math.PI;class js{constructor(t={}){this.direction=t.direction||"vertical",this.gap=t.gap??5,this.alignment=t.alignment||"center",this.justify=t.justify||"center",this._rawConfigs=t}reflow(t){const e=t._stack.filter((t=>t.visible&&!t.absolutePosition)),i=t._stack.filter((t=>t.visible&&t.absolutePosition)),n=t.width-t.padding.left-t.padding.right;if("vertical"===this.direction){let r=0,s=0,o=0,a=0;const c=e.concat(i);c.forEach(((t,e)=>{"block"===t.display&&(t.width=0,t.resetChildrenPosition(),t.reflow(),t._getBoundingGroupRect())})),e.forEach(((t,e)=>{const{width:i,height:n}=t.getBoundingDimension(),c=e>0?this.gap:0;"outstretch"!==t.display&&(o=Math.max(i,o)),a+=n+c,r+=n/2+c+s,s=n/2,t.anchor=[0,r]})),c.forEach(((e,i)=>{if("block"===e.display)e.resetChildrenPosition(),e.width=o,e.reflow();else if("outstretch"===e.display){const i=t._belongs.width-t._belongs.padding.left-t._belongs.padding.right;e.resetChildrenPosition(),e.width=Math.max(i,o),e.reflow()}})),o=Math.max(n,o),a/=2,"start"===this.alignment&&e.forEach(((t,e)=>{const{width:i}=t.getBoundingDimension();t.anchor[0]=-(o-i)/2,t.anchor[1]-=a})),"end"===this.alignment&&e.forEach(((t,e)=>{const{width:i}=t.getBoundingDimension();t.anchor[0]=(o-i)/2,t.anchor[1]-=a})),"center"===this.alignment&&e.forEach(((t,e)=>{const{width:i}=t.getBoundingDimension();t.anchor[1]-=a}))}if("horizontal"===this.direction){let t=0,i=0,r=0,s=0,o=0;if(e.forEach(((e,n)=>{const{width:a,height:c}=e.getBoundingDimension(),h=n>0?this.gap:0;r=Math.max(c,r),s+=a+h,o+=a,t+=a/2+h+i,i=a/2,e.anchor=[t,0]})),"start"===this.justify){const t=n/2;e.forEach(((e,i)=>{e.anchor[0]-=t}))}if("end"===this.justify){const t=n/2-s;e.forEach(((e,i)=>{e.anchor[0]+=t}))}if("center"===this.justify){const t=s/2;e.forEach(((e,i)=>{e.anchor[0]-=t}))}if("space-between"===this.justify&&e.length>1){const t=Math.max(n,s),i=(t-s)/(e.length-1),r=t/2;e.forEach(((t,e)=>{t.anchor[0]+=i*e-r}))}"start"===this.alignment&&e.forEach(((t,e)=>{const{height:i}=t.getBoundingDimension();t.anchor[1]=-(r-i)/2})),"end"===this.alignment&&e.forEach(((t,e)=>{const{height:i}=t.getBoundingDimension();t.anchor[1]=(r-i)/2}))}if(i.length){"block"===t.display?t.getBoundingDimension():t._getBoundingGroupRect();const e=t.width/2,n=t.height/2,r=(t.padding.top-t.padding.bottom)/2,s=(t.padding.left-t.padding.right)/2;i.forEach((t=>{t.anchor=this._resolveAbsoluteAnchor(t.absolutePosition,t,e,n,s,r)}))}}_resolveAbsoluteAnchor(t,e,i,n,r,s){const{top:o,right:a,bottom:c,left:h,centerX:l,centerY:d}=t,{width:u,height:f}=e.getBoundingDimension(),g=u/2,p=f/2;let _=0,v=0;return"number"==typeof o&&(_=o+p-n-s),"number"==typeof a&&(v=i-a-g-r),"number"==typeof c&&(_=n-c-p-s),"number"==typeof h&&(v=h+g-i-r),"number"==typeof l&&(v=l),"number"==typeof d&&(_=d),[v,_]}clone(){return new js(this._rawConfigs)}}const $s=js,Ds="input",Ns="control",Vs="input",Ws="compositionstart",Hs="compositionupdate",Fs="compositionend",Xs="enter",Ys="delete",qs="backspace",zs="arrowLeft",Us="arrowRight",Gs="arrowUp",Zs="arrowDown",Js="undo",Ks="redo",Qs="shift_down",to="shift_up",eo="ctrla",io="startedit",no="editclick",ro="shiftonclick",so="doubleclick";class oo extends EventTarget{_inputElement=null;constructor(t){super(),this._inputElement=function(t){const e=document.createElement("input");e.setAttribute("style","\n        width: 100px;\n        position: absolute;\n        left: 0;\n        top: 0;\n        border:none;\n        opacity: 0;\n        z-index: -1;\n        contain: strict;"),e.setAttribute("tabindex",-1),e.setAttribute("aria-hidden",!0),e.setAttribute("spellcheck",!1),e.setAttribute("autocorrect","off");let i=!1,n={ctrlOn:!1,shiftOn:!1};return e.addEventListener("beforeinput",(e=>{e.preventDefault(),e.data&&(i||t(Vs,e.data))})),e.addEventListener("compositionstart",(e=>{t(Ws),i=!0})),e.addEventListener("compositionupdate",(e=>{t(Hs,e.data)})),e.addEventListener("compositionend",(n=>{t(Fs,n.data),e.value="",i=!1})),e.addEventListener("keyup",(e=>{if(!i)switch(e.key){case"Shift":t(to),n.shiftOn=!1;break;case"Meta":case"Control":n.ctrlOn=!1}})),e.addEventListener("keydown",(e=>{if(!i){switch(e.code){case"Enter":t(Xs);break;case"Backspace":t(qs);break;case"Delete":t(Ys);break;case"ArrowLeft":t(zs);break;case"ArrowRight":t(Us);break;case"ArrowDown":t(Zs);break;case"ArrowUp":t(Gs)}switch(e.key){case"Shift":t(Qs),n.shiftOn=!0;break;case"Meta":case"Control":n.ctrlOn=!0;break;case"a":n.ctrlOn&&t(eo);break;case"c":n.ctrlOn&&t("ctrlc");break;case"v":n.ctrlOn&&t("ctrlv");break;case"x":n.ctrlOn&&t("ctrlx");break;case"y":n.ctrlOn&&(e.preventDefault(),t(Ks));break;case"z":n.ctrlOn&&n.shiftOn?t(Ks):n.ctrlOn&&t(Js)}}})),e}(this.controlCallback.bind(this)),t.append(this._inputElement),this._inputElement.focus()}controlCallback(t,e){switch(t){case Vs:case Ws:case Hs:case Fs:case Xs:case qs:case Ys:this.dispatchEvent(new CustomEvent(Ds,{detail:{kind:t,data:e}}));break;case zs:case Us:case Gs:case Zs:case eo:case Qs:case to:case Js:case Ks:this.dispatchEvent(new CustomEvent(Ns,{detail:{kind:t}}))}}focus(){this._inputElement.focus({preventScroll:!0})}syncPosition(t,e){this._inputElement.style.transform=`translate(${t}px, ${e}px)`}destroy(){this._inputElement.remove()}}const ao=oo;class co{_lines=[];get(t){return this._lines[t]}getLineAbove(t){let e=0;const i=this._lines;for(;e<i.length&&!(i[e].reduceHeight>t);)e++;return Math.min(e,i.length-1)}truncate(t){const e=ho.create(t);return this._lines=[e],e}push(t){this._lines.push(t)}forEach(t){this._lines.forEach(t)}length(){return this._lines.length}}class ho{width=0;anchorY=0;height=0;reduceHeight=0;_elements=[];static create(t){return new ho(t)}constructor(t={}){Object.assign(this,t)}_elements=[];get(t){return this._elements[t]}length(){return this._elements.length}insert(t,e){this._elements.splice(t,0,e)}push(t){this._elements.push(t)}tail(){return this._elements[this._elements.length-1]}copy(){return this._elements.slice()}getColumnNearest(t,e,i,n){const r=this._elements;if(t>=this.width){const t=r.length-1,e=r[t];let i=0;return"text"===e.type&&(i=e.source.length),[t,i]}{let s=0,o=0,a=0,c=null;for(;s<r.length-1;){o=a;const i=r[s];if("text"!==i.type){const t=c&&"text"===c.type?2*e:e;a+=i.width+t}else a+=i.width;if(a>t){c=i;break}c=i,s++}a<=t&&(o=a);const h=r[s];if("text"===h.type){const e=function(t,e,i,n){const r=e.source,s=r.length-1;if(0===e.width)return 0;const o=e.width;let a=Math.floor(t/o*s);return Vr((e=>{let c,h,l;e.font=`${i} ${n}`;let d=r.substring(0,a),u=r.substring(a-1,a),f=r.substring(a,a+1),g=e.measureText(d).width,p=e.measureText(u).width,_=e.measureText(f).width;c=g-p/2,h=g+_/2;do{if(c<=t&&h>=t)break;if(c>t){const i=h-t;l=a,a-=i<100?1:Math.floor(i/h*l),d=r.substring(a,l),g-=e.measureText(d).width}else if(h<t){const i=t-c;l=a,a+=i<100?1:Math.floor(i/(o-c)*(s-l)),d=r.substring(l,a),g+=e.measureText(d).width}u=r.substring(a-1,a),f=r.substring(a,a+1),p=e.measureText(u).width,_=e.measureText(f).width,c=g-p/2,h=g+_/2}while(a>=0&&a<=s)})),a}(t-o,h,i,n);return[s,e]}return t-o>c.width/2?[s+1,0]:[s,0]}}forEach(t){this._elements.forEach(t)}}class lo{static create(t){const e=new lo;return e.from(t),e}_textElements=[];_records=[];_caretRecord=null;insertBefore(t,e){const i=this.findIndex(t);this.inersetAt(i,e)}insertAfter(t,e){const i=this.findIndex(t);this.get(i+1)&&e.setNeedWrap(t.needWrap||t.isTail),this.inersetAt(i+1,e)}findIndex(t){return this._textElements.findIndex((e=>e===t))}get(t){return this._textElements[t]}from(t){this._textElements=t}inersetAt(t,e){this.splice(t,0,e)}push(t){this.splice(this.length(),0,t)}remove(t){this.splice(t,1)}splice(){const t=this._textElements.splice(...arguments);this._records.push({op:"splice",args:arguments,removed:t})}copy(){return this._textElements.slice()}isEmpty(){return 1===this._textElements.length&&""===this._textElements[0].source}forEach(t){this._textElements.forEach(t)}tail(){return this._textElements[this._textElements.length-1]}filter(t){return this._textElements.filter(t)}length(){return this._textElements.length}startRecord(){return this._caretRecord={before:null,after:null},this._records=[],this._records}getRecord(){return this._records}recordBeforeCaret(t){this._caretRecord.before=t.toRange()}recordAfterCaret(t){this._caretRecord.after=t.toRange()}getCaretRecord(){return this._caretRecord}collectRecords(){return this._records}}class uo{needWrap=!1;width=0;reduceWidth=0;height=0;anchorX=0;anchorY=0;dirty=!0;isTail=!1;constructor(t,e){this.type=t,this.source=e}setSource(t,e){const i=this.source;this.source=t,this.dirty=!0,e&&e.push({op:"setSource",args:[this,t,i]})}setNeedWrap(t,e){const i=this.needWrap;this.needWrap=t,i!==t&&e&&e.push({op:"setNeedWrap",args:[this,t,i]})}shift(t,e){if("text"===this.type){const i=this.source.length,n=t+e;return n<0?"prev":n>i?"next":"self"}return e>0?"next":e<0?"prev":void 0}tailOffset(){return"text"===this.type?this.needWrap||this.isTail?this.source.length:Math.max(0,this.source.length-1):0}headOffset(){return 0}}function fo(t){return 1===t.length&&"setSource"===t[0].op}class go{static length=50;_undo=[];_redo=[];_editor=null;write(t,e){if(0===t.length)return;if(fo(t)){const i=t[0],n=this.getLastUndo();if(n&&fo(n._batch)){const t=n._batch[0];if(t.args[0]===i.args[0])return t.args[1]=i.args[1],void(n._caretMetaTo=e.after)}}const i=new po(t);i._caretMetaFrom=e.before,i._caretMetaTo=e.after,this._undo.push(i),this._undo.length>go.length&&this._undo.splice(0,1),this._redo.length&&(this._redo=[])}getLastUndo(){return this._undo[this._undo.length-1]}undo(){const t=this._undo.pop();return t&&(t.undo(this._editor),this._redo.push(t)),t}redo(){let t=this._redo.pop();for(;t&&t.SKIP_REDO;)t=this._redo.pop();return t&&(t.redo(this._editor),this._undo.push(t)),t}}class po{_batch=[];_caretMetaFrom=null;_caretMetaTo=null;constructor(t){this._batch=t}updateCaretMetaTo(t){this._caretMetaTo=t}undo(t){this._batch.slice().reverse().forEach((e=>{switch(e.op){case"range":const[i,n]=e.args,r=t._range;r.setInitialRange(i),r.setRange(n),r.enable();break;case"setSource":const[s,o,a]=e.args;s.source=a,s.dirty=!0;break;case"setNeedWrap":const[c,h,l]=e.args;c.needWrap=l,c.dirty=!0;break;case"splice":const d=t._flattenTxtElem,[u,f,...g]=e.args,p=e.removed;let _=0;g&&(_=g.length),d.splice(u,_,...p)}})),t._caret.fromRange(this._caretMetaFrom)}redo(t){this._batch.forEach((e=>{switch(e.op){case"setSource":const[i,n,r]=e.args;i.source=n,i.dirty=!0;break;case"setNeedWrap":const[s,o,a]=e.args;s.needWrap=o,s.dirty=!0;break;case"splice":t._flattenTxtElem.splice(...e.args)}})),t._caret.fromRange(this._caretMetaTo)}}const _o=class{static create(t){return new this(t)}constructor(t){this._editor=t}exec(){}};class vo extends _o{static name=zs;exec(){const t=this._editor;t._range.disable();const e=t._flattenTxtElem,i=t._caret,n=i.getRow(),r=i.getColumn(),[s,o]=r,a=t._area.get(n),c=a.get(s),h=e.findIndex(c);switch(c.shift(o,-1)){case"prev":if(s>0){const t=a.get(s-1);i.setColumn([s-1,t.tailOffset()])}else if(h>0){const r=n-1,s=t._area.get(r).length()-1,o=e.get(h-1).tailOffset();i.setRow(r),i.setColumn([s,o])}break;case"self":i.setColumn(1,o-1)}i.refresh(),t.syncShadowInputPosition(),t._jflow._render()}}class mo extends _o{static name=Us;exec(){const t=this._editor;t._range.disable();const e=t._flattenTxtElem,i=t._caret,n=i.getRow(),r=i.getColumn(),[s,o]=r,a=t._area.get(n),c=a.get(s),h=e.findIndex(c);switch(c.shift(o,1,h===e.length()-1)){case"next":if(s<a.length()-1){const t=a.get(s+1);"text"===c.type&&"text"!==t.type?i.setColumn([s+2,t.headOffset()]):i.setColumn([s+1,t.headOffset()])}else if(h<e.length()-1){const t=n+1,r=e.get(h+1).headOffset();i.setRow(t),i.setColumn([0,r])}break;case"self":i.setColumn(1,o+1)}i.refresh(),t.syncShadowInputPosition(),t._jflow._render()}}class bo extends _o{static name=Gs;exec(){this._editor._range.disable();const t=this._editor._caret.getRow()-1;t>-1&&this._handler(t)}}class yo extends _o{static name=Zs;exec(){this._editor._range.disable();const t=this._editor._caret.getRow()+1;t<this._editor._area.length()&&this._handler(t)}}const wo={_handler(t){const e=this._editor,i=e._caret,n=i.getRow(),r=i.getColumn(),[s,o]=r,a=e._area;let c=a.get(n).get(s),h=c.reduceWidth;o>0&&(h+=e.measureTextWidth(c.source.substring(0,o)));const l=a.get(t).getColumnNearest(h,e.elementSpace,e.fontSize,e.fontFamily);i.setRow(t),i.setColumn(l),i.refresh(),e.syncShadowInputPosition(),e._jflow._render()}};function xo(t,e,i,n){if(!t)return[i,!1];if("text"===t.type&&"text"===e.type){const i=t.source.length;return t.setSource(t.source+e.source,n),t.setNeedWrap(e.needWrap,n),[i,!0]}return[i,!1]}Object.assign(bo.prototype,wo),Object.assign(yo.prototype,wo);class Co extends _o{static name=Ds;cacheIdx=null;exec(t,e){const i=this._editor,n=i._range,r=i._caret,s=i._flattenTxtElem,o=i._undoredo,a=s.startRecord();if(s.recordBeforeCaret(r),n.isEnable()&&(n.delete(i,a),t===qs||t===Ys))return s.collectRecords(),s.recordAfterCaret(r),this._editor.refresh(),void o.write(a,s.getCaretRecord());const c=r.getRow();let[h,l]=r.getColumn();const d=i._area,u=d.get(c);let f=u.get(h),g=u.get(h-1),p="";if("text"===f.type)p=f.source;else if("text"===g?.type)p=g.source,f=g,l=p.length,r.setColumn([h-1,p.length]);else{const t=new uo("text","");s.insertBefore(f,t),f=t}let _,v=p.substring(0,l);switch(_=this.cacheIdx?p.substring(this.cacheIdx[1]):p.substring(l),t){case Vs:if(/\r?\n/.test(e)){let t=e.split(/\r?\n/);t=t.replace(/\t/,"");let i=s.findIndex(f),n=t.shift();f.setSource(v+n,a);let o=c+1;for(i++;t.length>1;){const e=new uo("text",t.shift());e.setNeedWrap(!0,a),o++,s.inersetAt(i,e),i++}n=t.shift();const h=s.get(i);if(h&&"text"===h.type)h.setSource(n+h.source,a);else{const t=new uo("text",n);s.inersetAt(i,t)}r.setRow(o),r.setColumn([0,n.length])}else v+=e,r.setColumn(1,r.getColumn(1)+e.length),f.setSource(v+_,a);break;case Ws:this.cacheIdx=[v.length,v.length];break;case Hs:v=v.substring(0,this.cacheIdx[0]),v+=e,f.setSource(v+_,a);const t=this.cacheIdx[0]+e.length;r.setColumn(1,t),this.cacheIdx[1]=t;break;case Fs:v=v.substring(0,this.cacheIdx[0]),r.setColumn(1,this.cacheIdx[0]+e.length),this.cacheIdx=null,v+=e,f.setSource(v+_,a);break;case Xs:f.setSource(v,a),f.setNeedWrap(!0,a);const i=new uo("text",_);s.insertAfter(f,i),r.setRow(c+1),r.setColumn([0,0]);break;case qs:switch(f.shift(l,-1)){case"prev":let t=s.findIndex(f);if(h>0){s.splice(t-1,1),t-=1;const[e,i]=xo(s.get(t-1),f,0,a);i&&s.remove(t),r.setColumn([h-(e>0?2:1),e])}else if(t>0){const e=c-1,i=d.get(e).length()-1,[n,o]=xo(s.get(t-1),f,0,a);o&&s.remove(t),r.setRow(e),r.setColumn([i,n])}break;case"self":v=v.substring(0,v.length-1),r.setColumn(1,r.getColumn(1)-1),f.setSource(v+_,a)}break;case Ys:switch(f.shift(l,1)){case"next":let t=s.findIndex(f);if(h<u.length()-1){s.splice(t+1,1);const e=s.get(t+1),[i,n]=xo(f,e,f.source.length,a);n&&s.remove(t+1),r.setColumn([h,i])}else if(t<s.length()-1){const e=s.get(t+1),[i,n]=xo(f,e,f.source.length,a);n&&s.remove(t+1),r.setColumn([h,i])}break;case"self":_=_.substring(1),f.setSource(v+_,a)}}s.collectRecords(),s.recordAfterCaret(r),o.write(a,s.getCaretRecord()),this._editor.refresh()}}class ko extends _o{static name=io;exec(){const t=this._editor;if(!this._startEdit())return;const e=t._jflow;t.moveCaretByHitPoint(),t.createShadowInput(),t._caret.animate(e),t.syncShadowInputPosition()}_startEdit(){let t=!0;const e=this._editor;return e.dispatchEvent(new Ss("edit",{target:e,preventDefault(){t=!1}})),t}}class So extends _o{static name=no;exec(){const t=this._editor;t.moveCaretByHitPoint(),t._caret.refresh(),t.syncShadowInputPosition(),t._range.disable()}}class Eo extends _o{static name=so;exec(){const t=this._editor;t.moveCaretByHitPoint();const e=t._caret,i=t._range,n=t._area,r=e.getRow(),s=n.get(r),o=s.length()-1;i.setInitialRange([r,0,0]),i.setRange([r,o,s.tail().tailOffset()]),i.handleCaret(e),i.enable(),t.syncShadowInputPosition()}}class Bo extends _o{static name=to;exec(){this._editor._range.setInitialRange(null),this._editor.toggleShift(!1)}}class To extends _o{static name=Qs;exec(){const t=this._editor._range,e=this._editor._caret;t.setInitialRange(e.toRange()),this._editor.toggleShift(!0)}}class Oo extends _o{static name=ro;exec(){const t=this._editor;t.moveCaretByHitPoint();const e=this._editor._caret,i=this._editor._range;i.setRange(e.toRange()),i.enable(),i.handleCaret(e),e.refresh(),t.syncShadowInputPosition()}}class Mo extends _o{static name=eo;exec(){const t=this._editor,e=t._caret,i=t._range,n=t._area,r=n.length()-1,s=n.get(r),o=s.length()-1;i.setInitialRange([0,0,0]),i.setRange([r,o,s.tail().tailOffset()]),i.handleCaret(e),i.enable(),t.syncShadowInputPosition()}}class Po extends _o{static name=Js;exec(){this._editor._range.disable(),this._editor._undoredo.undo(),this._editor.refresh()}}class Lo extends _o{static name=Ks;exec(){this._editor._range.disable(),this._editor._undoredo.redo(),this._editor.refresh()}}class Ao extends ls{get currentLineHeight(){return this.lineHeight||parseInt(this.fontSize)}constructor(t){super(t),this.initStack(t),this.initLayout(t),this._undoredo=new go,this._undoredo._editor=this,this._caret=new class{_row=0;_column=[0,0];_status={show:!0,anime:null,lastElapsed:0,refreshElapsed:!1};setRow(t){this._row=t}setColumn(t,e){void 0!==e?this._column[t]=e:this._column=t}getRow(){return this._row}getColumn(t){return void 0!==t?this._column[t]:this._column}animate(t){this._status.anime=t.requestJFlowAnime((t=>{const e=this._status.lastElapsed;this._status.refreshElapsed&&(this._status.lastElapsed=t,this._status.refreshElapsed=!1),t-e>500&&(this._status.show=!this._status.show,this._status.lastElapsed=t)}))}cancelAnimate(){this._status.anime.cancel(),Object.assign(this._status,{show:!0,anime:null,lastElapsed:0})}isShow(){return this._status.show}refresh(){Object.assign(this._status,{show:!0,refreshElapsed:!0})}toRange(){return[this._row,...this._column]}fromRange(t){this._row=t[0],this._column=t.slice(1)}},this._range=new class{_enable=!1;_rangeFrom=null;_rangeTo=null;_initialRange=null;setInitialRange(t){this._initialRange=t}getRangeFrom(){return this._rangeFrom}getRangeTo(){return this._rangeTo}isEnable(){return this._enable}enable(){this._enable=!0}disable(){this._enable=!1}handleCaret(t){const[e,i,n]=this._rangeTo;t.setRow(e),t.setColumn([i,n])}setRange(t){const e=this._initialRange;this._compareRange(e,t)?(this._rangeFrom=e,this._rangeTo=t):(this._rangeFrom=t,this._rangeTo=e)}_compareRange(t,e){return!(t[0]>e[0]||t[0]===e[0]&&t[1]>e[1]||t[0]===e[0]&&t[1]===e[1]&&t[2]>e[2])}delete(t,e){if(this._enable){const i=t._area,n=t._caret,r=this._rangeFrom,s=this._rangeTo,o=i.get(r[0]).get(r[1]),a=i.get(s[0]).get(s[1]);let[c,h,l]=r;if(e.push({op:"range",args:[r.slice(),s.slice()]}),o===a){const t=o.source;o.setSource(t.substring(0,r[2])+t.substring(s[2]),e),o.dirty=!0}else{const i=t._flattenTxtElem;let n,d,u="",f="";const g=i.findIndex(o),p=i.findIndex(a);let _=!1;if("text"===o.type?u=o.source.substring(0,r[2]):n=i.get(g-1),"text"===a.type?(f=a.source.substring(s[2]),_=a.needWrap):d=i.get(p-1),n)if(i.splice(g,p-g+1),"text"===n.type)n.needWrap?c-=1:h-=1,l=n.source.length,n.setSource(n.source+f,e),n.dirty=!0,n.setNeedWrap(_,e);else{const t=new uo("text",u+f);t.setNeedWrap(_,e),i.splice(g,0,t)}else if(i.splice(g,p-g),d){const t=new uo("text",u);i.splice(g,0,t)}else a.setSource(u+f,e),a.dirty=!0;0===i.length()&&i.push(new uo("text",""))}this.disable(),n.setRow(c),n.setColumn([h,l])}}},this._shadowInput=void 0,this.textColor=t.textColor||"transparent",this.fontFamily=t.fontFamily||"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",this.fontSize=t.fontSize||"28px",this.fontWeight=t.fontWeight||"",this.elementSpace=t.elementSpace||5,this.lineSpace=t.lineSpace||5,this.placeholder=t.placeholder||"请输入",this.placeholderColor=t.placeholderColor||"#eee",this.cursorColor=t.cursorColor||"#60CFC4",this.textRangeColor=t.textRangeColor||"#4E75EC1A",this.minWidth=t.minWidth||0,this.resolver=()=>{const e=t.resolver();return 0!==e.length&&"text"===e[e.length-1].type||e.push(new uo("text","")),e},this._area=new co,this._flattenTxtElem=lo.create(this.resolver()),this._status={editing:!1,dragover:!1},this.commands=new Map,this.registCommand(ko),this.registCommand(So),this.registCommand(Bo),this.registCommand(To),this.registCommand(Oo),this.registCommand(Co),this.registCommand(vo),this.registCommand(mo),this.registCommand(bo),this.registCommand(yo),this.registCommand(Mo),this.registCommand(Eo),this.registCommand(Po),this.registCommand(Lo),this._makeFunctional(),this._cacheViewBox=[]}registCommand(t){this.commands.has(t.name)||this.commands.set(t.name,t.create(this))}_makeFunctional(){this.addEventListener("dblclick",(t=>{t.currentTarget===this&&(t.detail.bubbles=!1,this._status.editing&&this.execCommand(so))})),this.addEventListener("click",(t=>{if(t.currentTarget!==this)return;let e;t.detail.bubbles=!1,e=this._status.editing?this._status.shiftOn?ro:no:io,this.execCommand(e)})),this.addEventListener("blur",(t=>{this._status.editing=!1,this._shadowInput&&this._shadowInput.destroy(),this._belongs&&this._jflow._render(),this.dispatchEvent(new Ss("change",{target:this,textElements:this._flattenTxtElem.copy()})),this._range.disable(),this._caret.cancelAnimate()})),this.addEventListener("instancePressStart",(t=>{if(this._status.editing&&!this._status.shiftOn){t.detail.bubbles=!1,t.detail.preventDefault();const e=this._currentp,i=this._positionToCursorOffset(e),n=this._range;n.setInitialRange([i.row,...i.column]);const r=t.detail.jflow;let s=!1;const o=(t=>{this._status.editing=!1,s=!0;const{offsetX:e,offsetY:i}=t,o=r._calculatePointBack([e,i]);r._stack.checkHit(o);const a=this._currentp,c=this._positionToCursorOffset(a);n.setRange([c.row,...c.column]),n.enable()}).bind(this);document.addEventListener("pointermove",o),document.addEventListener("pointerup",(t=>{document.removeEventListener("pointermove",o),n.setInitialRange(null),s&&(n.handleCaret(this._caret),this._status.editing=!0,this._shadowInput.focus())}),{once:!0})}})),this.addEventListener("dragenter",(()=>{this.moveCaretByHitPoint(),this._status.dragover=!0})),this.addEventListener("dragover",(()=>{this.moveCaretByHitPoint()})),this.addEventListener("dragleave",(()=>{this._status.dragover=!1}));const t=(t=>{if(!this._status.dragover)return;t.detail.bubbles=!1,this._status.dragover=!1;const e=this._caret,i=e.getRow(),n=e.getColumn(),r=this._area.get(i);let[s,o]=n;const a=r.get(s),c=r.get(s-1);let h=this._flattenTxtElem,l=h.findIndex(a);"text"!==a.type&&"text"===c?.type&&(o=c.source.length,l=h.findIndex(c));const d=h.length();this.dispatchEvent(new Ss("insert",{...t.detail,type:t.type,textElements:h.copy(),idx:l,offset:o})),h=this._flattenTxtElem,this._status.editing&&(h.length()>d&&e.setColumn([s+h.length()-d,0]),this._shadowInput.focus()),this._status.editing&&this._caret.refresh(),this.syncShadowInputPosition(),this._range.disable()}).bind(this);this.addEventListener("pressEnd",t),this.addEventListener("drop",t)}toggleShift(t){this._status.shiftOn=t}execCommand(t){this.commands.get(t).exec()}createShadowInput(){const t=this._jflow;this._shadowInput=new ao(t.DOMwrapper),this._shadowInput.addEventListener(Ns,(t=>{const e=t.detail.kind;this.execCommand(e)})),this._shadowInput.addEventListener(Ds,(t=>{const e=t.detail.kind,i=t.detail.data;this.commands.get(Ds).exec(e,i)})),this._status.editing=!0,t.setFocusInstance(this)}moveCaretByHitPoint(){const t=this._currentp,e=this._caret,{row:i,column:n}=this._positionToCursorOffset(t);e.setRow(i),e.setColumn(n)}refresh(){this.recalculateUp(),this.syncShadowInputPosition(),this._jflow._render()}refreshTextElements(){this._flattenTxtElem=lo.create(this.resolver())}_positionToCursorOffset(t){const[e,i]=t,n=this._area,r=e+this.width/2,s=i+this.height/2,o=n.getLineAbove(s);return{row:o,column:n.get(o).getColumnNearest(r,this.elementSpace,this.fontSize,this.fontFamily)}}_caretToPosition(){const t=this._caret.getRow(),e=this._caret.getColumn(),i=this._area.get(t),[n,r]=e,s=i.get(n),o=this._flattenTxtElem.findIndex(s),a=this._flattenTxtElem.get(o-1);let c,h=this.currentLineHeight/2;if("text"===s.type){const t=s.source.substring(0,r);Vr((e=>{e.beginPath(),e.font=`${this.fontSize} ${this.fontFamily}`,c=s.anchorX-s.width/2+e.measureText(t).width}))}else c=s.anchorX-s.width/2,h=Math.max(h,s.height/2);return 0===r&&a&&"text"!==a.type&&(h=Math.max(h,a.height/2)),[c,h,i.anchorY,a,s]}syncShadowInputPosition(){if(this._status.editing){const[t,e,i]=this._caretToPosition(),n=this.calculateToRealWorld([t,i+e]),r=this._jflow.canvasMeta,s=Math.min(r.actual_width-120,n[0]);this._shadowInput.syncPosition(s,n[1]),this._shadowInput.focus()}}render(t){t.save(),this._isMoving?t.globalAlpha=.6:1!==this.opacity&&(t.globalAlpha=this.opacity);const[e,i]=this.anchor,n=this._jflow,r=this._area;t.translate(e,i);const s=this._flattenTxtElem;if(s.isEmpty())return t.beginPath(),t.font=`${this.fontWeight} ${this.fontSize} ${this.fontFamily}`,t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.placeholderColor,t.fillText(this.placeholder,0,0),this._randerCursor(t),t.translate(-e,-i),void t.restore();t.beginPath(),t.font=`${this.fontWeight} ${this.fontSize} ${this.fontFamily}`,t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.textColor,r.forEach((e=>{e.forEach((e=>{"text"===e.type&&t.fillText(e.source,e.anchorX,e.anchorY)}))})),s.forEach((e=>{if("text"!==e.type){const i=n.getRenderNodeBySource(e.source);i.visible&&(t.save(),i.render(t),t.restore())}})),this._randerCursor(t),this._renderRange(t),t.translate(-e,-i),t.restore()}_randerCursor(t){if(this._caret.isShow()&&(this._status.editing||this._status.dragover)){const[e,i,n]=this._caretToPosition();t.beginPath(),t.moveTo(e,n-i),t.lineTo(e,n+i),t.lineWidth=2,t.strokeStyle=this.cursorColor,t.stroke()}}_renderRange(t){const e=this._range;if(e.isEnable()){const i=this._area,n=this.textRangeColor,r=this.height,s=this.width,o=this.lineSpace,[a,c,h]=e.getRangeFrom(),[l,d,u]=e.getRangeTo();if(a===l){if(c===d&&h==u)return;const e=i.get(a);let s=a===i.length()-1?0:o;const l=e.reduceHeight-s-e.height-r/2,f=e.height,g=this._measureElementOffsetX(e.get(c),h,t),p=this._measureElementOffsetX(e.get(d),u,t);t.beginPath(),t.rect(g,l,p-g,f),t.fillStyle=n,t.fill()}else{let e=a,f=!0;for(;e<=l;){const a=i.get(e);let g=e===i.length()-1?0:o;const p=a.reduceHeight-g-a.height-r/2,_=a.height;if(f){const e=a.get(c),i=this._measureElementOffsetX(e,h,t),r=a.tail(),s=r.anchorX+r.width/2;t.beginPath(),t.rect(i,p,s-i,_),t.fillStyle=n,t.fill()}else if(e===l){const e=a.get(d),i=this._measureElementOffsetX(e,u,t);t.beginPath(),t.rect(-s/2,p,e.reduceWidth+(i-e.anchorX+e.width/2),_),t.fillStyle=n,t.fill()}else t.beginPath(),t.rect(-s/2,p,a.width,_),t.fillStyle=n,t.fill();f=!1,e++}}}}_measureElementOffsetX(t,e,i){return"text"!==t.type||0===e?t.anchorX-t.width/2:t.anchorX-t.width/2+i.measureText(t.source.substring(0,e)).width}measureTextWidth(t){let e;return Vr((i=>{i.font=`${this.fontSize} ${this.fontFamily}`,e=i.measureText(t).width})),e}getBoundingDimension(){return{width:this.width,height:this.height}}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}_getViewBox(){const t=this._belongs.getCacheViewBox(),e=this._cacheViewBox;return this._calculatePointBackWithPoint(t[0],t[1],e,0,1),this._calculatePointBackWithPoint(t[2],t[3],e,2,3),this._cacheViewBox}getCacheViewBox(){return this._cacheViewBox}calculateToCoordination(t){const[e,i]=t,[n,r]=this.anchor,s=[e+n,i+r];return this._belongs&&this._belongs.calculateToCoordination?this._belongs.calculateToCoordination(s):s}calculateToRealWorld(t){const[e,i]=t,[n,r]=this.anchor,s=[e+n,i+r];if(this._belongs&&this._belongs.calculateToRealWorld)return this._belongs.calculateToRealWorld(s)}_calculatePointBack(t){const[e,i]=t,[n,r]=this.anchor;return[e-n,i-r]}_calculatePointBackWithPoint(t,e,i,n,r){i[n]=t-this.anchor[0],i[r]=e-this.anchor[1]}isHit(t,e){const i=this._calculatePointBack(t),n=this._jflow;this._currentp=i;let r=[];this._flattenTxtElem.forEach((t=>{if("text"!==t.type){const e=n.getRenderNodeBySource(t.source);e.visible&&r.push(e)}}));const s=this._stack.checkHit(i,e,(t=>r.includes(t)));if(s)return s;const o=this.anchor,a=this.width/2,c=this.height/2;return t[0]>o[0]-a&&t[0]<o[0]+a&&t[1]>o[1]-c&&t[1]<o[1]+c}clone(){return new Is({width:this.width,height:this.height,cache:t=>{const[e,i]=this.anchor;t.translate(-e+this.width/2,-i+this.height/2),this.render(t)}})}destroy(){this._jflow._focus.instance===this&&this._jflow.blur()}}Object.assign(Ao.prototype,_s),Object.assign(Ao.prototype,vs),Object.assign(Ao.prototype,{_getBoundingGroupRect(){},resetChildrenPosition(){},reflow(){let t=this.currentLineHeight;const e=this._flattenTxtElem,i=this._area;if(e.isEmpty()){let n=0;const r=e.get(0);return Vr((t=>{t.font=`${this.fontSize} ${this.fontFamily}`,n=t.measureText(this.placeholder).width})),i.truncate({height:t,reduceHeight:t}).insert(0,r),Object.assign(r,{anchorX:-n/2,height:t,isTail:!0}),this.width=n,void(this.height=t)}const n=this._jflow;Vr((t=>{t.font=`${this.fontSize} ${this.fontFamily}`,e.forEach((e=>{"text"===e.type&&e.dirty&&(e.width=t.measureText(e.source).width,e.dirty=!1)}))}));const r=new co;r.truncate({height:t});let s=r.get(0),o=0,a=0,c=null;const h=this.lineSpace,l=this.elementSpace;e.forEach((e=>{if(s.push(e),e.reduceWidth=s.width,"text"===e.type)e.height=t,s.width+=e.width,e.needWrap&&(o+=s.height+h,s.reduceHeight=o,a=Math.max(s.width,a),s=ho.create({height:t}),r.push(s));else{const t=n.getRenderNodeBySource(e.source);e.height=t.height,s.height=Math.max(s.height,t.height);const i=c&&"text"!==c.type?l:2*l;s.width+=t.width+i}c=e})),e.tail().isTail=!0,o+=s.height,s.reduceHeight=o,a=Math.max(this.minWidth,Math.max(s.width,a));const d=a/2;let u=-o/2,f=0;r.forEach((t=>{const{height:e,reduceHeight:i}=t,r=u+f+e/2;t.anchorY=r;let s=-d,o=null;t.forEach((t=>{if("text"===t.type)t.anchorY=r,t.anchorX=s+t.width/2,s+=t.width;else{const e=n.getRenderNodeBySource(t.source),i=!o||"text"===o.type,a=i?2*l:l;t.width=e.width,t.anchorY=r,t.anchorX=s+t.width/2+(i?a/2:0),e.anchor=[t.anchorX,t.anchorY],s+=t.width+a}o=t})),f=i})),this._area=r,this.width=a,this.height=o}}),Ts(Os),Ts(Ms),Ts(class extends ls{constructor(t={}){super(t),this.type="Rhombus",this.height=t.diagonalsV||10,this.width=t.diagonalsH||20}render(t){t.save(),this._isMoving&&(t.globalAlpha=.6);const e=this.width/2,i=this.height/2,n=this.anchor;if(t.translate(n[0],n[1]),t.beginPath(),t.moveTo(0,-i),t.lineTo(e,0),t.lineTo(0,i),t.lineTo(-e,0),t.closePath(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor),this.shadowColor){t.shadowColor=this.shadowColor;const n=this._jflow.scale;t.shadowBlur=this.shadowBlur*n,t.shadowOffsetX=this.shadowOffsetX*n,t.shadowOffsetY=this.shadowOffsetY*n;let r=new Path2D;r.moveTo(0,-i),r.lineTo(e,0),r.lineTo(0,i),r.lineTo(-e,0),r.closePath(),r.rect(-e-10,-i-10,this.width+20,this.height+20),t.save(),t.clip(r,"evenodd"),t.stroke(),t.restore()}t.fillStyle=this.backgroundColor,t.fill(),this.borderWidth&&(t.shadowColor="transparent",t.stroke()),t.translate(-n[0],-n[1]),t.restore()}isHit(t){const e=this.height/2,i=this.width/2,n=this.anchor;return Math.abs(t[0]-n[0])/i+Math.abs(t[1]-n[1])/e<=1}getBoundingRect(){const t=this.anchor,e=this.width/2,i=this.height/2,n=t[0]-e,r=t[1]-i,s=t[0]+e,o=t[1]+i,a=this._boundingrect;return a[0]=n,a[1]=r,a[2]=s,a[3]=o,a}getBoundingDimension(){return{height:this.height,width:this.width}}getIntersectionsInFourDimension(){let t=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(t=this._belongs.calculateToCoordination(t));const[e,i]=t,n=this.width/2,r=this.height/2;return{0:[e+n,i],2:[e-n,i],1:[e,i+r],3:[e,i-r],100:[e+.618*n,i+.618*r]}}}),Ts(Ps,{shapeShift:(t,e)=>[t+.28865*e,e]}),Ts(class extends Ps{constructor(t){super(t)}render(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();const[e,i]=this.anchor,n=this.width/2,r=this.height/2,s=n/1.732,o=i-r,a=i+r,c=i-r+s,h=i+r-s,l=e-n,d=e+n;t.moveTo(e,o),t.lineTo(d,c),t.lineTo(d,h),t.lineTo(e,a),t.lineTo(l,h),t.lineTo(l,c),t.closePath(),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore(),this._cachePoints=[[e,o],[d,c],[d,h],[e,a],[l,h],[l,c]]}},{shapeShift:(t,e)=>[t,e+.5773*t]}),Ts(class extends Ms{render(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();const[e,i]=this.anchor,n=this.width/2,r=this.height/2,s=i-r+n,o=i+r-n,a=e-n,c=e+n;t.moveTo(a,s),t.arc(e,s,n,-Math.PI,0),t.lineTo(c,o),t.arc(e,o,n,0,Math.PI),t.closePath(),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}isHit(t,e){const[i,n]=this.anchor,r=this.width/2,s=this.height/2,o=Math.abs(s-r),a=n-s+r,c=n+s-r,h=r*r;return t[0]>i-r&&t[0]<i+r&&t[1]>n-o&&t[1]<n+o||Math.pow(t[0]-i,2)+Math.pow(t[1]-a,2)<h||Math.pow(t[0]-i,2)+Math.pow(t[1]-c,2)<h}}),Ts(class extends ls{constructor(t){super(t),this.type="Point",this.radius=t.radius||10,this._doCache()}setConfig(t){Object.keys(t).forEach((e=>{void 0!==t[e]&&null!==t[e]&&(this[e]=t[e],this._rawConfigs[e]=t[e])})),this._doCache()}_doCache(){this.width=2*this.radius,this.height=2*this.radius}render(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath(),t.arc(this.anchor[0],this.anchor[1],this.radius,0,2*Math.PI),t.fillStyle=this.backgroundColor,t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}isHit(t){const e=this.anchor;return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)<this.radius*this.radius}getBoundingRect(){const t=this.anchor,e=this.radius,i=t[0]-e,n=t[1]-e,r=t[0]+e,s=t[1]+e,o=this._boundingrect;return o[0]=i,o[1]=n,o[2]=r,o[3]=s,o}calculateIntersection(t){const[e,i]=t,[n,r]=this.anchor,s=n-e,o=r-i,a=Math.sqrt(s*s+o*o),c=this.radius/a;return[n-c*s,r-c*o]}getIntersectionsInFourDimension(){const[t,e]=this.anchor,i=this.radius;return{0:[t+i,e],2:[t-i,e],1:[t,e+i],3:[t,e-i]}}calculateIntersectionInFourDimension(t,e){const[i,n]=t,[r,s]=this.anchor,o=this.radius,a=r-i,c=s-n,h={0:[r+o,s],2:[r-o,s],1:[r,s+o],3:[r,s-o]};let l=Math.abs(c)>Math.abs(a)?c<0?1:3:a<0?0:2;return{p:h[l],dir:l}}getBoundingDimension(){return{width:this.width,height:this.height}}},{shapeShift(t,e,i){const n=Math.ceil(Math.sqrt(t*t+e*e)/2);i.radius=n;const r=2*n;return[r,r]}});class Ro extends EventTarget{constructor(t){super(),this.uniqueName="jflow",this.eventAdapter=new class{constructor(t={}){this.plugin=function(){let t={pointerDown:!1,dirty:!1};return{canvas:{wheel:function(t,e){t.preventDefault();let{offsetX:i,offsetY:n,deltaX:r,deltaY:s}=t;t.ctrlKey?(s=-s,e.zoomHandler(i,n,r,s,t)):e.panHandler(-r,-s,t)},pointerdown:function(e,i){const{offsetX:n,offsetY:r,deltaY:s,button:o}=e;0===o&&(t.pointerDown=!0,i.pressStartHandler(n,r,e))},pointermove:function(e,i){const{offsetX:n,offsetY:r}=e;t.pointerDown&&(t.dirty=!0),i.pressMoveHandler(n,r,e)},pointerup:function(e,i){e.preventDefault();const{offsetX:n,offsetY:r,button:s}=e;0===s&&t.pointerDown&&t.dirty&&(t.pointerDown=!1,t.dirty=!1,i.pressUpHanlder(!1,e))},contextmenu:function(t,e){t.preventDefault(),t.stopPropagation();const{offsetX:i,offsetY:n}=t;e.contextMenuHanlder(i,n,t)},dblclick:function(t,e){t.preventDefault(),t.stopPropagation();const{offsetX:i,offsetY:n}=t;e.dblclickHandler(i,n,t)},click:function(e,i){e.preventDefault(),e.stopPropagation();const{offsetX:n,offsetY:r}=e;t.dirty||(t.pointerDown=!1,t.dirty=!1,i.clickHanlder(n,r,e))}},document:{pointerup:function(t,e){e.pressUpHanlder(!0,t)}}}}(),this.use(t),this.canvasHandlers=[],this.documentHandlers=[]}use(t={}){const{canvas:e,document:i}=t;if(e)for(let t in e)e.hasOwnProperty(t)&&(this.plugin.canvas[t]=e[t]);if(i)for(let t in i)i.hasOwnProperty(t)&&(this.plugin.document[t]=i[t])}apply(t){const{canvas:e,document:i}=this.plugin,n=t.canvas;for(let i in e){const r=e[i];function s(e){r(e,t)}n.addEventListener(i,s),this.canvasHandlers.push({eventName:i,handlerWrapperd:s})}for(let e in i){let n,r={};function s(e){n(e,t)}"function"==typeof i[e]?n=i[e]:(n=i[e].handler,Object.assign(r,i[e].options)),document.addEventListener(e,s,r),this.documentHandlers.push({eventName:e,handlerWrapperd:s,options:r})}}unload(t){const e=t.canvas;this.canvasHandlers.forEach((({eventName:t,handlerWrapperd:i})=>{e.removeEventListener(t,i)})),this.documentHandlers.forEach((({eventName:t,handlerWrapperd:e,options:i})=>{console.log("unload",t),document.removeEventListener(t,e,i)}))}}(t.eventAdapter),this.initNodeWeakMap(),this.initAnime(),this.initStack(t),this.initLayout(t),this.ctx=null,this.canvas=null,this.dpr=1,this.padding=20,this.position=null,this.scale=null,this.initialZoom=t.initialZoom,this.initialPosition=t.setInitialPosition,this.maxZoom=t.maxZoom||3,this.minZoom=t.minZoom||.5,this.NodeRenderTop=!!t.NodeRenderTop,this.worldMargin=t.worldMargin,this.draggingbehavior=Object.assign({panInBorder:{enable:!0,padding:20,deltamovement:8,allowMovingTargetInPan:!0}},t.draggingbehavior||{}),this.scrollBarBehavior=Object.assign({enable:!0},t.scrollBarBehavior||{}),this.offeset=null,this._lastState={x:null,y:null,dragging:!1,processing:!1},this._lastDragState={target:null,targetLink:null,processing:!1},this._target={instance:null,link:null,moving:null,isInstanceDirty:!1,isLinkDirty:!1,cache:{stack:null,belongs:null,point:null},meta:{x:void 0,y:void 0,initialX:void 0,initialY:void 0},status:{dragovering:!1,dragging:!1,processing:!1,movingState:!1}},this._focus={instance:null},this._dragOverTarget=null,this.allowDrop=t.allowDrop,this._tempNode=null,this._tempLink=null,this.mode=is,this._allowMovingTarget=!0,this.canvasMeta={},this._cacheViewBox=[]}setMovingTargets(t){Object.assign(this._target,{moving:t})}setTempDraggingInstance(t){t._belongs=this,this._tempNode=t,Object.assign(this._target,{moving:[this._tempNode],dragging:!0})}removeTempDraggingInstance(){if(this._tempNode){const t=this._tempNode.anchor;return this._tempNode=null,t}}preventDefaultDragging(){this._allowMovingTarget=!1}allowDefaultDragging(){this._allowMovingTarget=!0}$mount(t){const{canvas:e,ctx:i,scale:n,width:r,height:s,raw_width:o,raw_height:a,left:c,top:h}=jr(t);this.reflow(),this.ctx=i,this.DOMwrapper=t,this.canvas=e,this.canvas.setAttribute("data-jflow",!0),this.canvas.$jflow=this,this.canvasMeta={width:o,height:a,actual_width:r,actual_height:s},this.dpr=n,this._getBoundingGroupRect();const l=this.padding,{width:d,height:u,x:f,y:g}=this.bounding_box,p={x:l,y:l,width:r-2*l,height:s-2*l},_={x:0,y:0,offsetX:0,offsetY:0},v=p.width/d,m=p.height/u,b=v<=m?"x":"y";let y;y=this.initialZoom?this.initialZoom:Math.min(v,m),this.scale=y,y>this.maxZoom&&(this.maxZoom=y),y<this.minZoom&&(this.minZoom=y);const w=f*y,x=g*y,C=p.width,k=p.height;if(this.initialPosition){const{x:t,y:e}=this.initialPosition(w,x,C,k,p.x,p.y,r,s,f,g,d,u);_.x=t,_.y=e}else _.x="x"===b?p.x:(C-d*y)/2+l,_.y="y"===b?p.y:(k-u*y)/2+l;_.offsetX=_.x-w,_.offsetY=_.y-x,this.position=_,this._readyToRender=!0,this.scrollBarBehavior.enable&&this.initScrollBar(this.scrollBarBehavior),this.__render(),this._createEventHandler(),Wr((t=>{this.dpr=t,this.resizeCanvas(),this.scheduleRender()}),(t=>{this.destroyDprListener=t}))}setLinkingMode(t,e,i){const n=this.getRenderNodeBySource(t);this._tempNode=new ds,this._tempLink=e(i?{from:this._tempNode,to:n}:{from:n,to:this._tempNode}),this.sendMessage({instance:t}),this.mode=ns}isInLinkingMode(){return this.mode===ns}setLinkingLink(t){this.mode===ns&&this._tempLink.setConfig(t)}resetLinkingLink(){this.mode===ns&&this._tempLink.setConfig({to:this._tempNode})}clearTemp(){this._tempNode&&(this._tempNode.destroy(),this._tempNode=null),this._tempLink&&(this._tempLink.destroy(),this._tempLink=null),this._render()}preventClearTemp(){this._preventClearTemp=!0}resizeCanvas(){if(this.canvas&&this.DOMwrapper){const{width:t,height:e,raw_width:i,raw_height:n}=function(t,e){const{width:i,height:n,left:r,top:s}=e.getBoundingClientRect();t.style.width=i+"px",t.style.height=n+"px";const o=window.devicePixelRatio;return t.width=Math.floor(i*o),t.height=Math.floor(n*o),{width:i,height:n,raw_width:t.width,raw_height:t.height}}(this.canvas,this.DOMwrapper);this.canvasMeta={width:i,height:n,actual_width:t,actual_height:e}}}setFocusInstance(t){this._focus.instance=t}focusOn(t){const e=this._calculatePointBack([this.canvasMeta.actual_width/2,this.canvasMeta.actual_height/2]);let i=t.anchor;t._belongs.calculateToCoordination&&(i=t._belongs.calculateToCoordination(i));const n=(e[0]-i[0])*this.scale,r=(e[1]-i[1])*this.scale;this._recalculatePosition(n,r),this._render()}_getBoundingGroupRect(){const t=this._stack.getBoundingRectPoints();if(this.bounding_box){this.bounding_box=rs(t);const{x:e,y:i}=this.bounding_box,n=this.scale;this.position.x=this.position.offsetX+e*n,this.position.y=this.position.offsetY+i*n}else this.bounding_box=rs(t)}_createEventHandler(){const t=this.canvas;let e;this.eventAdapter.apply(this);const i=()=>{this.eventAdapter.unload(this),this.destroyDprListener()};if(e=i,this.allowDrop){const n=this._onDragover.bind(this),r=this._onDrop.bind(this),s=this._onDragLeave.bind(this);t.addEventListener("dragstart",(t=>{t.preventDefault()})),t.addEventListener("dragover",n),t.addEventListener("drop",r),t.addEventListener("dragleave",s),e=()=>{i(),t.removeEventListener("dragover",n),t.removeEventListener("drop",r),t.removeEventListener("dragleave",s)}}this.destroy=e}_targetLockOn(t,e){let i=this._calculatePointBack(t);const n=i;this._currentp=i;let r=this._stack;const s=this._getViewBox(),o=r.checkHit(i,(t=>this._target.status.dragging&&t===this._getMovingTarget()),(t=>ss(s,t.getBoundingRect())));let a,c=this._linkStack;if(o&&o._belongs!==this||(a=c.checkHit(i,(t=>{if(!this._target.status.dragging)return!1;const e=this._getMovingTarget();return t.from===e||t.to===e}))),a||(a=c.checkHit(i,(t=>!t.ON_TOP))),Object.assign(this._target,{instance:o,link:a,isInstanceDirty:o===this._target.instance,isLinkDirty:a===this._target.link}),Object.assign(this._target.cache,{stack:r,belongs:this,point:i,topLayerPoint:n}),Object.assign(this._target.meta,{x:t[0],y:t[1]}),"pressStart"===e&&!this._target.status.dragging&&!this._target.status.dragovering){let t=o;for(;t&&t._belongs.lock&&t!==this;)t=t._belongs;this.setMovingTargets(t&&[t]),t&&o.bubbleEvent(new Ss("afterResolveMovingTarget",{event:e,target:t,jflow:this,bubbles:!0}))}return["pressStart","click","dblclick","contextclick"].includes(e)&&this._focus.instance&&this._focus.instance!==o&&(this._focus.instance.dispatchEvent(new Ss("blur",{relatedTarget:o})),this._focus.instance=null),this._target}blur(){this._focus.instance&&(this._focus.instance.dispatchEvent(new Ss("blur",{relatedTarget:null})),this._focus.instance=null)}_getMovingTarget(){return this._target.moving&&this._target.moving[0]}_processDragOver(t,e){if(this._dragOverTarget!==t){const i=this.readMessage()?.instance;this._dragCurrentData=i;const{point:n}=this._target.cache;if(this._dragOverTarget){const t=this._dragOverTarget;t.dispatchEvent(new Ss("dragleave",{event:e,instance:t,target:i,jflow:this,point:n}))}t&&t.dispatchEvent(new Ss("dragenter",{event:e,instance:t,target:i,jflow:this,point:n})),this._dragOverTarget=t}else this._dragOverTarget&&this._dragOverTarget.dispatchEvent(new Ss("dragover",{event:e,instance:t,jflow:this,target:this._dragCurrentData}));this._processPanInBorder()}_processPanInBorder(){if(this.draggingbehavior?.panInBorder?.enable&&(this.draggingbehavior.panInBorder.timer||(this.draggingbehavior.panInBorder.timer=Date.now()),Date.now()-this.draggingbehavior.panInBorder.timer>500)){const[t,e,i,n]=this._cacheViewBox,[r,s]=this._currentp,{padding:o,deltamovement:a}=this.draggingbehavior.panInBorder;let c=0,h=0;r<t+o&&(c=a),r>i-o&&(c=-a),s<e+o&&(h=a),s>n-o&&(h=-a),this.__processOverAnime&&this.__processOverAnime.cancel(),c||h?this.__processOverAnime=this.requestJFlowAnime((()=>{this.panHandler(c,h)})):this.draggingbehavior.panInBorder.timer=null}}_onDragover(t){if(t.preventDefault(),t.stopPropagation(),this._lastDragState.processing)return;this._lastDragState.processing=!0;const{offsetX:e,offsetY:i}=t;Object.assign(this._target.status,{dragovering:!0}),this._targetLockOn([e,i]);const n=this._target.instance||this._target.link;this._processDragOver(n,t),this._target.isLinkDirty||this._target.isInstanceDirty?Promise.resolve().then((()=>{this._render(),this._target.isLinkDirty=!1,this._target.isInstanceDirty=!1,this._lastDragState.processing=!1})):this._lastDragState.processing=!1}_cancelPanInBorder(){this.__processOverAnime&&this.__processOverAnime.cancel(),this.draggingbehavior?.panInBorder&&(this.draggingbehavior.panInBorder.timer=null)}_onDragLeave(){this._cancelPanInBorder()}_onDrop(t){this._cancelPanInBorder();const e=this.consumeMessage()?.instance;if(this._dragOverTarget){const e=this._dragOverTarget;e.dispatchEvent(new Ss("dragoverend",{event:t,instance:e})),this._dragOverTarget=null}const{link:i,instance:n}=this._target,{point:r,belongs:s}=this._target.cache;i?i.dispatchEvent(new Ss("drop",{event:t,instance:e,link:i,jflow:this,belongs:s,point:r})):n?n.bubbleEvent(new Ss("drop",{event:t,instance:e,jflow:this,target:n,point:r,bubbles:!0})):this.dispatchEvent(new Ss("drop",{event:t,instance:e,jflow:this,target:n,point:r})),requestAnimationFrame((()=>{this.cancelDrop()}))}cancelDrop(){this._target.instance=null,this._target.link=null,Object.assign(this._target.status,{dragovering:!1})}zoomHandler(t,e,i,n,r){if(this._zooming)return;this._zooming=!0;const{width:s,height:o,x:a,y:c}=this.bounding_box,{actual_width:h,actual_height:l}=this.canvasMeta;let d=this.minZoom;if(this.worldMargin){const t=this.worldMargin,e=s+2*t,i=o+2*t;d=Math.max(d,Math.max(h/e,l/i))}let u=this.scale;u*=n>0?1.05:1/1.05,u=Math.min(this.maxZoom,Math.max(d,u));var f=u-this.scale,g=s*this.scale,p=o*this.scale,_=s*f,v=o*f,m=-(t-this.position.x)/g,b=-(e-this.position.y)/p;this.scale=u,this._recalculatePosition(m*_,b*v),this.dispatchEvent(new Ss("zoompan",{deltaX:0,deltaY:0})),this.scheduleRender((()=>{this._zooming=!1}))}panHandler(t,e,i){if(this._panning)return;this._panning=!0;const{dragging:n}=this._target.status;if(n){const i=this._target.moving;i&&this.draggingbehavior.panInBorder.allowMovingTargetInPan&&i.forEach((i=>{i.anchor[0]+=-t/this.scale,i.anchor[1]+=-e/this.scale}))}this._recalculatePosition(t,e),this.dispatchEvent(new Ss("zoompan",{deltaX:t,deltaY:e})),this.scheduleRender((()=>{this._panning=!1}))}pressStartHandler(t,e,i){if(this.checkScrollDragging())return;Object.assign(this._target.meta,{initialX:t,initialY:e});const{link:n,instance:r}=this._targetLockOn([t,e],"pressStart");if(this.mode===ns)return;if(Object.assign(this._target.status,{dragging:!0,processing:!1}),this._target.moving){const t=this._getMovingTarget();t.dispatchEvent(new Ss("pressStart",{event:i,instance:t,jflow:this}))}const s=this._resolveLockOnTarget(n,r);s&&s.bubbleEvent(new Ss("instancePressStart",{event:i,target:s,jflow:this,bubbles:!0,preventDefault:()=>{this._preventPressSequeence=!0,this._clearTarget(),document.addEventListener("pointerup",(t=>{t.preventDefault(),t.stopPropagation(),this._preventPressSequeence=!1}),{once:!0})}})),this._preventPressSequeence||this.dispatchEvent(new Ss("jflowPressStart",{event:i,jflow:this}))}pressMoveHandler(t,e,i){if(this._preventPressSequeence)return;if(this.checkScrollDragging())return;const{dragging:n,processing:r}=this._target.status,{x:s,y:o}=this._target.meta;if(!n){if(this.checkScrollBarHover(t,e))return;this.resetScrollBarHover()}if(!n&&!r){const{link:n,instance:r}=this._targetLockOn([t,e]),s=this._resolveLockOnTarget(n,r);if(s?s.bubbleEvent(new Ss("instancemousemove",{event:i,instance:s,jflow:this,bubbles:!0})):this.dispatchEvent(new Ss("instancemousemove",{event:i,instance:null,jflow:this})),this.mode===ns)return this._tempNode.anchor=this._currentp,this.scheduleRender((()=>{this._target.isLinkDirty=!1,this._target.isInstanceDirty=!1,this._target.status.processing=!1})),void this._processPanInBorder()}if(this.dispatchEvent(new Ss("canvasmousemove",{event:i,jflow:this})),!n)return;if(r)return;const a=this._target.moving;this._target.status.movingState=!0,this._target.status.processing=!0;const c=t-s,h=e-o;a?this._allowMovingTarget&&a.forEach((t=>{t.anchor[0]+=c/this.scale,t.anchor[1]+=h/this.scale})):(this._recalculatePosition(c,h),this.dispatchEvent(new Ss("zoompan",{deltaX:c,deltaY:h})));const{instance:l,link:d}=this._targetLockOn([t,e]);this._processDragOver(l||d,i),this.scheduleRender((()=>{this._target.isLinkDirty=!1,this._target.isInstanceDirty=!1,this._target.status.processing=!1}))}pressUpHanlder(t,e){if(!this._preventPressSequeence){if(this.__processOverAnime&&this.__processOverAnime.cancel(),this._cancelPanInBorder(),this._target.meta,this.mode===ns){const t=this._target.instance,i=this.consumeMessage();let n=!1;const r=()=>{n=!0};if(t)t.bubbleEvent(new Ss("link",{event:e,target:t,jflow:this,payload:i,bubbles:!0,link:this._tempLink,preventDefault:r}));else{const{offsetX:t,offsetY:n}=e;this.dispatchEvent(new Ss("link",{event:e,jflow:this,payload:i,anchor:this._calculatePointBack([t,n]),link:this._tempLink,preventDefault:r}))}if(n)return;return this._clearTarget(),this._preventClearTemp||(this._tempNode&&(this._tempNode.destroy(),this._tempNode=null),this._tempLink&&(this._tempLink.destroy(),this._tempLink=null)),this._preventClearTemp=!1,this.mode=is,void this._render()}if(this._target.moving){let t=!1;if(this._layout.static&&(t=this.staticCheck(this._getMovingTarget())),!t&&this._target.link){const{point:t,belongs:i}=this._target.cache,n=this._target.link,r=this._getMovingTarget();n.dispatchEvent(new Ss("drop",{event:e,instance:r,link:n,jflow:this,belongs:i})),this._target.link=null,this._target.instance=null}this._target.moving&&(this._target.instance?this._target.instance.bubbleEvent(new Ss("pressEnd",{event:e,instance:this._getMovingTarget(),jflow:this,target:this._target.instance,bubbles:!0})):this.dispatchEvent(new Ss("pressEnd",{event:e,instance:this._getMovingTarget(),jflow:this}))),this._target.moving=null,this.removeTempDraggingInstance(),this._render()}this._clearTarget()}}clickHanlder(t,e,i){const{link:n,instance:r,meta:s}=this._targetLockOn([t,e],"click");if(Math.abs(s.initialX-s.x)<1&&Math.abs(s.initialY-s.y)<1){if(i.target!==this.canvas)return this._clearTarget(),void Object.assign(this._target.meta,{initialX:void 0,initialY:void 0});const{topLayerPoint:t}=this._target.cache,e=this._resolveLockOnTarget(n,r);if(e){const n=e;n.bubbleEvent(new Ss("click",{event:i,jflow:this,target:n,topLayerPoint:t,bubbles:!0}))}else this.dispatchEvent(new Ss("click",{event:i,jflow:this,topLayerPoint:t}));this._clearTarget(),Object.assign(this._target.meta,{initialX:void 0,initialY:void 0})}}contextMenuHanlder(t,e,i){const{link:n,instance:r}=this._targetLockOn([t,e],"contextclick"),{topLayerPoint:s}=this._target.cache,o=this._resolveLockOnTarget(n,r);if(o){const t=o;t.bubbleEvent(new Ss("contextclick",{event:i,jflow:this,target:t,topLayerPoint:s,bubbles:!0}))}else this.dispatchEvent(new Ss("contextclick",{event:i,jflow:this,topLayerPoint:s}))}dblclickHandler(t,e,i){const{link:n,instance:r}=this._targetLockOn([t,e],"dblclick"),{topLayerPoint:s}=this._target.cache,o=this._resolveLockOnTarget(n,r);if(o){const t=o;t.bubbleEvent(new Ss("dblclick",{event:i,jflow:this,target:t,topLayerPoint:s,bubbles:!0}))}else this.dispatchEvent(new Ss("dblclick",{event:i,jflow:this,topLayerPoint:s}))}_resolveLockOnTarget(t,e){return t?.ON_TOP?t:e||t}_clearTarget(){Object.assign(this._target.meta,{x:void 0,y:void 0}),Object.assign(this._target.status,{dragging:!1,processing:!1,movingState:!1}),Object.assign(this._target,{instance:null,link:null,moving:null})}_recalculatePosition(t,e,i){const{x:n,y:r,width:s,height:o}=this.bounding_box,{actual_width:a,actual_height:c}=this.canvasMeta;if(void 0===i&&(i=this.scale),this.worldMargin){const h=this.worldMargin,l=(n+s+h)*i-a,d=(n-h)*i,u=n*i,f=this.position.x+t-u;this.position.offsetX=Math.min(Math.max(-l,f),-d),this.position.x=this.position.offsetX+u;const g=(r+o+h)*i-c,p=(r-h)*i,_=r*i,v=this.position.y+e-_;this.position.offsetY=Math.min(Math.max(-g,v),-p),this.position.y=this.position.offsetY+_}else this.position.x+=t,this.position.y+=e,this.position.offsetX=this.position.x-n*i,this.position.offsetY=this.position.y-r*i}calculateToRealWorld(t){const e=this.scale,i=this.position;return[t[0]*e+i.offsetX,t[1]*e+i.offsetY]}_calculatePointBack(t){const e=this.scale,i=this.position;return[(t[0]-i.offsetX)/e,(t[1]-i.offsetY)/e]}_calculatePointBackWithPoint(t,e,i,n,r){const s=this.scale,o=this.position;i[n]=(t-o.offsetX)/s,i[r]=(e-o.offsetY)/s}_calculateDistance(t){return this.scale*t}_resetTransform(){const{width:t,height:e}=this.canvasMeta,i=this.position,n=this.scale,r=this.ctx;r.setTransform(),r.clearRect(0,0,t,e),r.scale(this.dpr,this.dpr),r.transform(n,0,0,n,i.offsetX,i.offsetY)}resetTransform(t){const e=this.position,i=this.scale;t.setTransform(),t.scale(this.dpr,this.dpr),t.transform(i,0,0,i,e.offsetX,e.offsetY)}_getViewBox(){const t=this._cacheViewBox;return this._calculatePointBackWithPoint(0,0,t,0,1),this._calculatePointBackWithPoint(this.canvasMeta.actual_width,this.canvasMeta.actual_height,t,2,3),t}setNodeToTopLayer(t){const e=this._stack.findIndex((e=>e===t));if(-1!==e){const[t]=this._stack.splice(e,1);this._stack.push(t)}}getCacheViewBox(){return this._cacheViewBox}_render(){this.scheduleRender()}__render(){if(!this._readyToRender)return;this.runAnimeFrame(),this._resetTransform();const t=this.ctx;this.dispatchEvent(new Ss("beforeJflowRender",{ctx:t}));const e=this._getViewBox();this.NodeRenderTop?(this._linkStack.render(t,(t=>!t.ON_TOP&&t.isInViewBox(e))),this._stack.render(t,(t=>{const i=ss(e,t.getBoundingRect());return t._isInViewBox=i,i})),this._linkStack.render(t,(t=>t.ON_TOP&&t.isInViewBox(e)))):(this._stack.render(t,(t=>{const i=ss(e,t.getBoundingRect());return t._isInViewBox=i,i})),this._linkStack.render(t,(t=>t.isInViewBox(e)))),this._tempNode&&(t.save(),this._tempNode.render(t),t.restore()),this._tempLink&&(t.save(),this._tempLink.isInViewBox(e),this._tempLink.render(t),t.restore()),this.dispatchEvent(new Ss("afterJflowRender",{ctx:t})),this.renderScrollBar(t)}}function Io(t,e,i,n,r,s,o,a){var c,h="function"==typeof t?t.options:t;if(e&&(h.render=e,h.staticRenderFns=i,h._compiled=!0),n&&(h.functional=!0),s&&(h._scopeId="data-v-"+s),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},h._ssrRegister=c):r&&(c=a?function(){r.call(this,(h.functional?this.parent:this).$root.$options.shadowRoot)}:r),c)if(h.functional){h._injectStyles=c;var l=h.render;h.render=function(t,e){return c.call(e),l(t,e)}}else{var d=h.beforeCreate;h.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:h}}Object.assign(Ro.prototype,ms),Object.assign(Ro.prototype,_s),Object.assign(Ro.prototype,vs),Object.assign(Ro.prototype,fs),Object.assign(Ro.prototype,bs),Object.assign(Ro.prototype,ys),Object.assign(Ro.prototype,Cs),Object.assign(Ro.prototype,xs),window.$jflow_version="0.1.0";var jo=Io({props:{node:Object,odd:Boolean},computed:{groupConfig:()=>({layout:new $s({direction:"horizontal",gap:5}),paddingTop:4,paddingBottom:4,margin:2,paddingLeft:10,backgroundColor:"transparent",borderWidth:0})}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("j-group",t._g({attrs:{source:t.node,configs:t.groupConfig}},t.$listeners),[i("j-text",{attrs:{configs:{fontSize:"12px",minWidth:110,textAlign:"left",textColor:"#1C1E21",content:t.node.name+"<"+("string"==typeof t.node.ref?t.node.ref:t.node.ref.name)+">"}}})],1)}),[],!1,null,null,null);const $o=Io({components:{"er-property":jo.exports},props:{node:Object},data(){return console.log(this.node),{folded:!1,configs:{layout:new $s({direction:"vertical",gap:0}),borderColor:"#A3BF69",backgroundColor:"#ECF2E1",borderWidth:2,borderRadius:0},bodyConfigs:{layout:new $s({direction:"vertical",gap:0,alignment:"start"}),display:"block",backgroundColor:"#fff",borderRadius:0,borderColor:"#A3BF69",borderWidth:2},headerConfigs:{layout:new $s({direction:"horizontal",gap:0,alignment:"center"}),paddingTop:2,paddingBottom:2,paddingLeft:15,paddingRight:15},propertyConfig:{layout:new $s({direction:"vertical",gap:0,alignment:"start"}),border:{bottom:{borderColor:"#A3BF69",borderWidth:2}}}}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("j-group",t._g({attrs:{source:t.node,configs:t.configs}},t.$listeners),[i("j-group",{attrs:{configs:t.headerConfigs}},[i("j-text",{attrs:{configs:{fontSize:"16px",fontWeight:"bold",textColor:"#1C1E21",textAlign:"center",content:t.node.name}}})],1),t._v(" "),i("j-group",{attrs:{configs:t.bodyConfigs}},[i("j-group",{attrs:{configs:t.propertyConfig}},[t.node.properties&&t.node.properties.length?t._l(t.node.properties,(function(t){return i("er-property",{key:t.name,attrs:{node:t}})})):t._e(),t._v(" "),t.node.param&&t.node.param.length?[i("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#1C1E21",textAlign:"left",content:"params:"}}}),t._v(" "),t._l(t.node.param,(function(t){return i("er-property",{key:t.name,attrs:{node:t}})}))]:t._e(),t._v(" "),t.node.return&&t.node.return.length?[i("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#1C1E21",textAlign:"left",content:"returns:"}}}),t._v(" "),t._l(t.node.return,(function(t){return i("er-property",{key:t.name,attrs:{node:t}})}))]:t._e()],2)],1)],1)}),[],!1,null,null,null).exports,Do=Io({props:{node:Object},data(){let t,e;return"entity"===this.node.concept&&(t="#37371F",e="#fff"),(this.node.isStructure||"structure"===this.node.concept)&&(t="#EA9010",e="#fff"),"logic"===this.node.concept&&(t="#90BE6D",e="#000"),"viewlogic"===this.node.concept&&(t="#C9E3AC",e="#000"),"view"===this.node.concept&&(t="#EAEFBD",e="#000"),{folded:!1,textColor:e,configs:{layout:new $s({direction:"vertical",gap:0}),borderColor:"#A3BF69",backgroundColor:t,borderWidth:2,borderRadius:0,padding:20}}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("j-group",t._g({attrs:{source:t.node,configs:t.configs}},t.$listeners),[i("j-text",{attrs:{configs:{fontSize:"16px",fontWeight:"bold",textColor:t.textColor,textAlign:"center",content:t.node.name}}})],1)}),[],!1,null,null,null).exports;class No{constructor(t){this.type="Property",this.source=t,this.name=t.name,this.refName=t.ref.name}}class Vo{constructor(t,e){this.type=e,this.source=t,this.name=t.name,this.properties=(t.properties||[]).map((t=>new No(t)))}}let Wo=0;function Ho(t,e){return t.find((t=>{for(const i of e)if(i===t)return!0;return!1}))}function Fo(t,e){return 0===e.length?[]:t.filter((t=>e.includes(t.source)))}let Xo=0,Yo=[],qo=[],zo=[],Uo=[],Go=[];function Zo(t){const e={id:Xo++,concept:"view",source:t,name:t.name,logics:[]};t.logics.map((i=>{return n=`${t.name}/${i.name}`,r=i,s=e,void Go.push({id:Xo++,concept:"viewlogic",name:n,param:r.param.slice(),return:r.return.slice(),refByLogic:[],refByView:[s],refByViewLogic:[]});var n,r,s})),zo.push(e)}function Jo(t){Uo.push({level:0,id:Xo++,concept:"logic",source:t,name:t.name,param:t.param.slice(),return:t.return.slice(),refByLogic:[],refByView:[],refByViewLogic:[]})}function Ko(t){let e=qo.find((e=>e.name===t));return e||(e={id:Xo++,concept:"entity",isStructure:t.includes(".structures."),name:t},qo.push(e),e)}function Qo(t){return{id:Xo++,concept:"property",ref:Ko(t.ref),name:t.name}}function ta(t){Yo.push({id:Xo++,concept:"structure",source:t,name:t.structure,properties:t.properties.map(Qo),refByLogic:[],refByView:[],refByViewLogic:[]})}function ea(t){const e="logic"===t.concept,i=t.source,n=t.refByViewLogic,r=t.refByView,s=t.refByLogic;i.refByViewLogic.forEach((({view:t,logic:e})=>{const i=`${t}/${e}`,r=Go.find((t=>t.name===i));r&&n.push(r)})),i.refByView.forEach((t=>{const e=zo.find((e=>e.name===t));e&&r.push(e)})),i.refByLogic.forEach((t=>{const i=Uo.find((e=>e.name===t));i&&(e&&i.level++,s.push(i))}))}var ia=Io({name:"jflow-er-diagram",components:{"j-er-node-comp":$o,"j-plain-node":Do},data:()=>({jflowloading:!1,configs:{allowDrop:!0,layout:{},initialZoom:1,minZoom:1e-4,NodeRenderTop:!0},filterContent:"",showProperty:!1,curData:null,currJSON:""}),computed:{statistics(){return this.curData?`entities: ${this.curData.entities.length}, structures: ${this.curData.structures.length}, logics: ${this.curData.logics.length}, views: ${this.curData.views.length}`:""}},methods:{genVueComponentKey:t=>t.id,rerender(){this.configs.layout.reOrder(this.curData),this.$refs.jflow.reflow()},toggleView(){this.configs.layout.toggleView(),this.rerender()},toggleLogic(){this.configs.layout.toggleLogic(),this.rerender()},toggleStructure(){this.configs.layout.toggleStructure(),this.rerender()},toggleLcap(){this.configs.layout.toggleLcap(),this.rerender()},toggleFilterMultiRef(){this.configs.layout.toggleFilterMultiRef(),this.rerender()},togglePrimary(){this.configs.layout.togglePrimaryFilter(),this.rerender()},toggleFilterMultiRefLogic(){this.configs.layout.toggleMultiLogicRefFilter(),this.rerender()},doFilter(t){this.configs.layout.doFilter(this.filterContent,t),this.rerender()},toggleProperty(){this.showProperty=!this.showProperty,this.configs.layout.toggleProperty(this.showProperty),this.rerender()},importData(){this.$refs.datamodal.showModal()},importJSON(){const t=Object.freeze((e=JSON.parse(this.currJSON),Xo=0,qo=[],Yo=[],zo=[],Uo=[],Go=[],e.views.map(Zo),e.logics.map(Jo),e.structures.map(ta),Uo.forEach((t=>{ea(t)})),Yo.forEach((t=>{ea(t)})),{structures:Yo.slice(),views:zo.slice(),viewLogics:Go.slice(),logics:Uo.slice(),entities:qo.slice()}));var e;this.curData=t,this.$refs.jflow?this.rerender():this.configs.layout=new class{constructor(t){this.static=!1,this.flowStack=[],this.flowLinkStack=[],this.erNodes=[],this.viewVisible=!0,this.logicVisible=!0,this.structureVisible=!0,this.LCAPvisible=!1,this.multiRefFilter=!1,this.multiLogicRefFilter=!1,this.primaryFilter=!1,this.filterContent="",this.filterPart="",this.showProperty=!1,this.reOrder(t)}reOrder(t){this.flowStack=[],this.flowLinkStack=[],this.source=t;const{structures:e,views:i,viewLogics:n,logics:r,entities:s}=t;let o=new Set,a=new Set,c=new Set,h=new Set,l=new Set;const d=this.filterContent.toLocaleLowerCase(),u=t=>e=>{if(this.filterPart===t)return e.name.toLowerCase().includes(d)};let f=s.map((t=>new Vo(t,"Entity"))),g=e.map((t=>new Vo(t,"Structure"))),p=r.map((t=>new Vo(t,"Logic"))),_=n.map((t=>new Vo(t,"ViewLogic"))),v=i.map((t=>new Vo(t,"View")));d&&"View"===this.filterPart&&(v.filter(u("View")).forEach((t=>{c.add(t.source)})),_.forEach((t=>{Ho(t.source.refByView,c)&&h.add(t.source)})),p.forEach((t=>{(Ho(t.source.refByViewLogic,h)||Ho(t.source.refByView,c))&&a.add(t.source)})),g.forEach((t=>{(Ho(t.source.refByViewLogic,h)||Ho(t.source.refByLogic,a)||Ho(t.source.refByView,c))&&(t.source.properties.forEach((t=>{l.add(t.ref)})),o.add(t.source))}))),d&&"ViewLogic"===this.filterPart&&(_.filter(u("ViewLogic")).forEach((t=>{h.add(t.source),t.source.refByView.forEach((t=>{c.add(t)}))})),p.forEach((t=>{Ho(t.source.refByViewLogic,h)&&a.add(t.source)})),g.forEach((t=>{(Ho(t.source.refByViewLogic,h)||Ho(t.source.refByLogic,a)||Ho(t.source.refByView,c))&&(t.source.properties.forEach((t=>{l.add(t.ref)})),o.add(t.source))}))),d&&"Logic"===this.filterPart&&(p.filter(u("Logic")).forEach((t=>{a.add(t.source),t.source.refByViewLogic.forEach((t=>{h.add(t),t.refByView.forEach((t=>{c.add(t)}))}))})),g.forEach((t=>{(Ho(t.source.refByViewLogic,h)||Ho(t.source.refByLogic,a)||Ho(t.source.refByView,c))&&(t.source.properties.forEach((t=>{l.add(t.ref)})),o.add(t.source))}))),d&&"Structure"===this.filterPart&&g.filter(u("Structure")).forEach((t=>{o.add(t.source),t.source.properties.forEach((t=>{l.add(t.ref)})),t.source.refByLogic.forEach((t=>{a.add(t),t.refByViewLogic.forEach((t=>{h.add(t),t.refByView.forEach((t=>{c.add(t)}))}))})),t.source.refByViewLogic.forEach((t=>{h.add(t),t.refByView.forEach((t=>{c.add(t)}))}))})),d&&(f=Fo(f,Array.from(l)),g=Fo(g,Array.from(o)),p=Fo(p,Array.from(a)),_=Fo(_,Array.from(h)),v=Fo(v,Array.from(c))),this.viewVisible||(v=[],_=[]),this.logicVisible||(p=[]),this.structureVisible||(g=[],f=[]),[...f,...g,...p,..._,...v].forEach((t=>{this.flowStack.push({type:t.type,source:t.source,layoutNode:t})}));const m=t=>{const e="logic"===t.source.concept,i=t.source;i.refByLogic.forEach((i=>{const n=p.find((t=>t.name===i.name));n&&(e?this.flowLinkStack.push({from:t,to:n,fromDir:2,toDir:0,part:Wo++}):this.flowLinkStack.push({from:t,to:n,fromDir:0,toDir:2,part:Wo++}))})),i.refByViewLogic.forEach((e=>{const i=_.find((t=>t.name===e.name));i&&this.flowLinkStack.push({from:t,to:i,fromDir:0,toDir:2,part:Wo++})})),i.refByView.forEach((e=>{const i=v.find((t=>t.name===e.name));i&&this.flowLinkStack.push({from:t,to:i,fromDir:0,toDir:2,part:Wo++})}))};g.forEach((t=>{t.source.properties.forEach((e=>{const i=f.find((t=>t.name===e.ref.name));i&&this.flowLinkStack.push({from:i,to:t,fromDir:0,toDir:2,part:Wo++})})),m(t)})),p.forEach((t=>{m(t)})),_.forEach((t=>{const e=t.source.refByView[0],i=v.find((t=>t.name===e.name));i&&this.flowLinkStack.push({from:t,to:i,fromDir:0,toDir:2,part:Wo++})}));let b=Array.from(p.reduce(((t,e)=>{const i=e.source.level;return t.has(i)||t.set(i,{level:i,nodes:[]}),t.get(i).nodes.push(e),t}),new Map).values()).sort(((t,e)=>e.level-t.level));Object.assign(this,{entityNodes:f,structNodes:g,logicNodes:p,viewLogicsNodes:_,viewNodes:v,logicLevelNodes:b})}staticCheck(t,e){return!1}reflow(t){const{entityNodes:e,structNodes:i,logicNodes:n,viewLogicsNodes:r,viewNodes:s,logicLevelNodes:o}=this;function a(e,i=0,n){let r=0,s=0;return e.forEach(((e,i)=>{const o=t.getRenderNodeBySource(e.source),{width:a,height:c}=o.getBoundingDimension();s=Math.max(a,s);const h=c/2;i>0&&(r+=h),o.anchor[1]=r,n&&n(e,r),r+=h+20})),i+=s/2,e.forEach((e=>{t.getRenderNodeBySource(e.source).anchor[0]=i})),i+=s/2}let c=[e,i,o].reduce(((t,e)=>0===e.length?t:e[0].nodes?e.reduce(((t,e)=>a(e.nodes,t)+200),t):a(e,t)+200),0),h=null,l=0;c=a(r,c,((e,i)=>{const n=e.source.refByView[0].name;if(n!==h){const r=e.source.refByView[0],s=t.getRenderNodeBySource(r),{width:o}=s.getBoundingDimension();l=Math.max(o,l),s.anchor[1]=i,h=n}}))+200,c+=l/2,s.forEach((e=>{t.getRenderNodeBySource(e.source).anchor[0]=c}))}toggleView(){this.viewVisible=!this.viewVisible}toggleLogic(){this.logicVisible=!this.logicVisible}toggleStructure(){this.structureVisible=!this.structureVisible}toggleLcap(){this.LCAPvisible=!this.LCAPvisible}toggleFilterMultiRef(){this.multiRefFilter=!this.multiRefFilter}togglePrimaryFilter(){this.primaryFilter=!this.primaryFilter}toggleMultiLogicRefFilter(){this.multiLogicRefFilter=!this.multiLogicRefFilter}doFilter(t,e){this.filterPart=e,this.filterContent=t}toggleProperty(t){this.showProperty=t}}(t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"block",width:"100vw",height:"90vh",border:"1px solid #000",overflow:"visible",position:"relative"}},[t._m(0),t._v(" "),i("div",{staticStyle:{display:"block",width:"100%",height:"100%"}},[t.curData?i("j-jflow",{ref:"jflow",staticStyle:{width:"100%",height:"100%"},attrs:{configs:t.configs,"gen-vue-component-key":t.genVueComponentKey},scopedSlots:t._u([{key:"Structure",fn:function(e){var n=e.source;return[t.showProperty?i("j-er-node-comp",{attrs:{node:n}}):i("j-plain-node",{attrs:{node:n}})]}},{key:"ViewLogic",fn:function(e){var n=e.source;return[t.showProperty?i("j-er-node-comp",{attrs:{node:n}}):i("j-plain-node",{attrs:{node:n}})]}},{key:"Logic",fn:function(e){var n=e.source;return[t.showProperty?i("j-er-node-comp",{attrs:{node:n}}):i("j-plain-node",{attrs:{node:n}})]}},{key:"View",fn:function(t){var e=t.source;return[i("j-plain-node",{attrs:{node:e}})]}},{key:"Entity",fn:function(t){var e=t.source;return[i("j-plain-node",{attrs:{node:e}})]}},{key:"plainlink",fn:function(t){var e=t.configs;return[i("jBezierLink",{attrs:{configs:e,from:e.from.source,to:e.to.source}})]}}],null,!1,149633744)}):t._e()],1),t._v(" "),i("div",[i("button",{on:{click:function(e){return t.$refs.scriptdialog.showModal()}}},[t._v("get script")]),t._v(" "),i("button",{on:{click:t.importData}},[t._v("import data")]),t._v(" "),i("span",[t._v(t._s(t.statistics))]),t._v(" "),i("br"),t._v(" "),i("button",{on:{click:t.toggleView}},[t._v("toggle View ("+t._s(t.configs.layout.viewVisible)+")")]),t._v(" "),i("button",{on:{click:t.toggleLogic}},[t._v("toggle Logic ("+t._s(t.configs.layout.logicVisible)+")")]),t._v(" "),i("button",{on:{click:t.toggleStructure}},[t._v("toggle Sturcture ("+t._s(t.configs.layout.structureVisible)+")")]),t._v(" "),i("br"),t._v(" "),i("label",[t._v("\n                filterBy: "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.filterContent,expression:"filterContent"}],domProps:{value:t.filterContent},on:{input:function(e){e.target.composing||(t.filterContent=e.target.value)}}}),t._v(" "),i("button",{on:{click:function(e){return t.doFilter("Structure")}}},[t._v("Struture")]),t._v(" "),i("button",{on:{click:function(e){return t.doFilter("Logic")}}},[t._v("Logic")]),t._v(" "),i("button",{on:{click:function(e){return t.doFilter("ViewLogic")}}},[t._v("ViewLogic")]),t._v(" "),i("button",{on:{click:function(e){return t.doFilter("View")}}},[t._v("View")])]),t._v(" "),i("button",{on:{click:t.toggleProperty}},[t._v("toggle property ("+t._s(t.showProperty)+")")])]),t._v(" "),i("dialog",{ref:"datamodal"},[i("form",{attrs:{method:"dialog"}},[i("p",[i("label",[i("span",{staticStyle:{"vertical-align":"top"}},[t._v("json: ")]),t._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currJSON,expression:"currJSON"}],staticStyle:{"white-space":"pre",width:"600px",height:"400px"},domProps:{value:t.currJSON},on:{input:function(e){e.target.composing||(t.currJSON=e.target.value)}}})])]),t._v(" "),i("div",[i("button",{attrs:{value:"cancel"}},[t._v("close")]),t._v(" "),i("button",{attrs:{id:"confirmBtn",value:"default"},on:{click:t.importJSON}},[t._v("confirm")])])])]),t._v(" "),i("dialog",{ref:"scriptdialog"},[t._m(1)])])}),[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{position:"absolute",left:"20px",top:"10px"}},[i("span",{staticClass:"legend entity"},[t._v("Entity")]),t._v(" "),i("span",{staticClass:"legend structure"},[t._v("Structure")]),t._v(" "),i("span",{staticClass:"legend globallogic"},[t._v("GlobalLogic")]),t._v(" "),i("span",{staticClass:"legend viewlogic"},[t._v("ViewLogic")]),t._v(" "),i("span",{staticClass:"legend view"},[t._v("View")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{attrs:{method:"dialog"}},[i("textarea",{staticStyle:{"white-space":"pre",width:"600px",height:"400px"}},[t._v("function figureOutRefs(result) {\n    const refByLogic = [];\n    const refByView = [];\n    const refByViewLogic = [];\n    const refByOther = [];\n    for (const entry of result) {\n        const n = entry[0];\n        \n        switch(n.concept) {\n            case 'Logic': \n                refByLogic.push(entry[0].name);\n                break;\n            case 'View':\n                let v = entry[1];\n                function iterate(node, lastName) {\n                    node.children.forEach(c => {\n                        if(c.node.concept === 'View') {\n                            iterate(c, `${lastName}/${c.node.name}`);\n                        } else {\n                            if(c.node.concept === 'Logic') {\n                                refByViewLogic.push({\n                                    view: lastName,\n                                    logic: c.node.name,\n                                })\n                            } else if(lastName) {\n                                refByView.push(lastName)\n                            }\n                        }\n                    })\n                }\n                iterate(v, v.node.name);\n                break;\n            default: \n                refByOther.push(entry[0].name);\n        }\n    }\n    return {\n        refByLogic,\n        refByView,\n        refByOther,\n        refByViewLogic,\n    }\n}\nPromise.all([\n    Promise.all($data.app.logics.map(async s => { \n        const result = await window.globalData.naslServer.findReferences(s);\n        const {\n            refByLogic,\n            refByView,\n            refByOther,\n            refByViewLogic\n        } = figureOutRefs(result);\n\n        return {\n            name: s.name,\n            param: s.params.map(p => ({\n                ref: p.typeAnnotation.typeKey,\n                name: p.name,\n            })),\n            return: s.returns.map(p => ({\n                ref: p.typeAnnotation.typeKey,\n                name: p.name,\n            })),\n            refByLogic:  Array.from(new Set(refByLogic)),\n            refByView: Array.from(new Set(refByView)),\n            refByViewLogic,\n            refByOther\n        }\n    })).then(res => {\n        return res\n    }),\n    Promise.all($data.app.structures.map(async s => { \n        const result = await window.globalData.naslServer.findReferences(s);\n        const {\n            refByLogic,\n            refByView,\n            refByViewLogic,\n            refByOther,\n        } = figureOutRefs(result);\n        \n        return {\n            structure: s.name,\n            properties: s.properties.map(p => {\n                return {\n                    ref: p.typeAnnotation.typeKey,\n                    name: p.name\n                }\n            }),\n            refByLogic,\n            refByView: Array.from(new Set(refByView)),\n            refByViewLogic,\n            refByOther\n        }\n    })).then(res => {\n        return res\n    }),\n    Promise.resolve($data.app.views.map(v => {\n        const viewNames = [];\n        function iterate(viewNode, lastName) {\n            viewNames.push({\n                name: lastName,\n                logics: viewNode.logics.map(l => ({\n                    name: l.name,\n                    param: l.params.map(p => ({\n                        ref: p.typeAnnotation.typeKey,\n                        name: p.name,\n                    })),\n                    return: l.returns.map(p => ({\n                        ref: p.typeAnnotation.typeKey,\n                        name: p.name,\n                    }))\n                })),   \n            });\n            viewNode.children.forEach(c => {\n                iterate(c, `${lastName}/${c.name}`);\n            })\n        }\n        iterate(v, v.name);\n        return viewNames;\n    }).reduce((accu, curr) => accu.concat(curr), []))\n]).then(([logics, structures, views]) => {\n    console.log(JSON.stringify({ logics, structures, views }, null, '\\t'));\n})\n            ")]),t._v(" "),i("button",{attrs:{value:"cancel"}},[t._v("close")])])}],!1,null,null,null);const na=ia.exports;Ir.config.productionTip=!1,Ir.use(e.JFlowVuePlugin),new Ir({render:t=>t(na)}).$mount("#app")})();